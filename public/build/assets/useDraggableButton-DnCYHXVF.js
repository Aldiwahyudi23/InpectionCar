import{x as Be,r as x,g as $e,q as Z,E as Me,G as de,c as n,o,d as e,b as h,k as ie,z as ve,A as be,n as G,t as T,u as oe,e as Pe,F as re,m as ue,f as ae,y as ke,w as xe,L as we,a as Ue,j as Ie,l as Te,T as De,D as Ae,W as Re,J as Ve,B as Fe}from"./vendor-CV8_PVEu.js";import{l as Se}from"./lodash-BRlxIpe8.js";import{_ as qe}from"./PrimaryButton-Dgy-kueV.js";import{_ as ze}from"./ActionMessage-Dm4wSOXc.js";import{_ as pe}from"./app-BqF7l3Ee.js";import{_ as Ee}from"./InputNumber-BcABGAJA.js";const He={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Oe={key:0,class:"p-4 space-y-2"},We={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ze={class:"flex items-center space-x-2"},Ke={key:0,class:"text-xs text-red-500 font-normal ml-2"},Ge={key:1,class:"text-xs text-red-500 font-normal ml-2"},Xe={key:2,class:"text-xs text-green-500 font-normal ml-2"},Ye={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Je={class:"relative"},Qe={key:0,class:"absolute right-3 top-3"},et={key:1,class:"text-xs text-red-500 font-normal ml-2"},tt={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},at={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},st={key:0},ot=["onMousedown"],nt={class:"font-medium text-gray-900"},lt={class:"text-sm text-gray-500"},it={key:1,class:"p-4 text-sm text-gray-500 text-center"},rt={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ut={key:0,class:"mb-4"},dt=["innerHTML"],ct={key:1},mt={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},vt=["onClick"],gt=["src","alt"],pt={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},ht={class:"text-white text-xs text-center"},ft={key:2,class:"text-center py-4 text-gray-500 text-sm"},bt={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},wt=["src","alt"],xt={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},yt={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},kt={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},$t={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges"],setup(a,{emit:F}){var me,he,fe,ye,_e,Ne;const t=a,m=F,r=Be({plate_number:((me=t.inspection)==null?void 0:me.plate_number)||"",car_id:((he=t.inspection)==null?void 0:he.car_id)||null,car_name:((fe=t.inspection)==null?void 0:fe.car_name)||""}),d=x(((ye=t.inspection)==null?void 0:ye.plate_number)||""),g=x(((_e=t.inspection)==null?void 0:_e.car_id)||null),i=x(((Ne=t.inspection)==null?void 0:Ne.car_name)||""),s=x(""),y=x(""),f=x(""),v=x(!1),M=x(""),D=x(""),L=x(r.car_name),b=x(!1),N=x(!1),z=x([]),I=x(null),A=x([]),P=x(!1),u=x(0);$e(()=>{var k,p,K,B,J;if(_((k=t.inspection)==null?void 0:k.plate_number),(p=t.inspection)!=null&&p.car_id&&((K=t.CarDetail)==null?void 0:K.length)>0){const te=t.CarDetail.find(se=>se.id===t.inspection.car_id);te&&c(te)}else!((B=t.inspection)!=null&&B.car_id)&&((J=t.inspection)!=null&&J.car_name)&&(L.value=t.inspection.car_name,r.car_id=null);window.addEventListener("keydown",O),m("update:hasUnsavedChanges",le.value),m("update:validation",Q.value)}),Me(()=>{window.removeEventListener("keydown",O)});const _=k=>{if(!k){s.value="",y.value="",f.value="";return}const p=k.toUpperCase().trim(),K=p.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(K)s.value=K[1]||"",y.value=K[2]||"",f.value=K[3]||"";else{let B="area",J="",te="",se="";for(const ee of p)B==="area"&&/[A-Z]/.test(ee)?J+=ee:B==="area"&&/[0-9]/.test(ee)?(B="number",te+=ee):B==="number"&&/[0-9]/.test(ee)?te+=ee:B==="number"&&/[A-Z]/.test(ee)?(B="suffix",se+=ee):B==="suffix"&&/[A-Z]/.test(ee)&&(se+=ee);s.value=J,y.value=te,f.value=se}R()},R=()=>{const k=`${s.value}${y.value}${f.value}`;r.plate_number=k,W()},X=k=>{k==="area"?s.value=s.value.toUpperCase().replace(/[^A-Z]/g,""):k==="number"?y.value=y.value.replace(/[^0-9]/g,""):k==="suffix"&&(f.value=f.value.toUpperCase().replace(/[^A-Z]/g,"")),R()},Y=Z(()=>{const k=r.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(k)}),ne=Z(()=>!L.value||L.value.trim()===""),H=Z(()=>r.plate_number.length>0&&!Y.value?"Format plat nomor tidak valid.":null),Q=Z(()=>{const k=!r.plate_number||r.plate_number.trim()==="",p=!L.value||L.value.trim()==="";return k||p||!Y.value||v.value}),le=Z(()=>{const k=r.plate_number!==d.value,p=r.car_id!==g.value||L.value!==i.value;return k||p}),ce=Z(()=>le.value&&!Q.value),C=k=>{var K,B,J;if(!k)return"";const p=[];return(K=k.brand)!=null&&K.name&&p.push(k.brand.name),(B=k.model)!=null&&B.name&&p.push(k.model.name),(J=k.type)!=null&&J.name&&p.push(k.type.name),k.cc&&p.push((k.cc/1e3).toFixed(1)),k.transmission&&p.push(k.transmission),k.year&&p.push(k.year.toString()),k.fuel_type&&p.push(k.fuel_type),k.production_period&&p.push(`(${k.production_period})`),p.join(" ")},U=()=>{r.car_id&&(r.car_id=null,I.value=null,A.value=[]),l()},l=Se.debounce(()=>{if(!L.value.trim()){z.value=[],b.value=!1;return}N.value=!0;try{const k=L.value.toLowerCase().trim();z.value=t.CarDetail.filter(p=>C(p).toLowerCase().includes(k)),b.value=!0}finally{N.value=!1}},300),w=()=>{setTimeout(()=>{b.value=!1,r.car_name=L.value,W()},200)},c=async k=>{I.value=k,L.value=C(k),r.car_id=k.id,r.car_name=C(k),b.value=!1,await $(k.id),W(),m("update:hasUnsavedChanges",le.value),m("update:validation",Q.value)},j=k=>!k||!k.file_path?"":`/storage/${k.file_path}`,$=async k=>{try{const p=await fetch(`/api/cars/${k}/images`);if(p.ok){const K=await p.json();A.value=Array.isArray(K)?K:[]}else A.value=[]}catch(p){console.error("Error loading car images:",p),A.value=[]}},E=k=>{u.value=k,P.value=!0,document.body.style.overflow="hidden"},V=()=>{P.value=!1,document.body.style.overflow=""},S=()=>{u.value=(u.value+1)%A.value.length},q=()=>{u.value=(u.value-1+A.value.length)%A.value.length},O=k=>{if(P.value)switch(k.key){case"Escape":V();break;case"ArrowRight":S();break;case"ArrowLeft":q();break}},W=()=>{const k={plate_number:r.plate_number,car_id:r.car_id,car_name:r.car_name};m("update-vehicle",k)},ge=()=>{t.inspection&&r.post(route("inspections.updateVehicleDetails",{inspection:t.inspection.id}),{preserveScroll:!0,onSuccess:()=>{d.value=r.plate_number,g.value=r.car_id,i.value=r.car_name,m("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:k=>{console.error("Gagal menyimpan data:",k)}})};return de([()=>r.plate_number,()=>r.car_name],k=>{M.value="",v.value=!1,D.value="";const p=k[0];if(p&&p.length>=6){const K=t.allInspections.filter(B=>{var J;return B.plate_number===p&&B.id!==((J=t.inspection)==null?void 0:J.id)});if(K.length>0){const B=["draft","in_progress","pending","pending_review","revision"],J=K.find(te=>B.includes(te.status));if(J)v.value=!0,M.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${J.status.replace(/_/g," ").toUpperCase()}.`;else{const te=K.filter(se=>["approved","rejected","completed","cancelled"].includes(se.status));if(te.length>0){te.sort((ee,Ce)=>new Date(Ce.created_at)-new Date(ee.created_at));const se=te[0];if(se.car_id){const ee=t.CarDetail.find(Ce=>Ce.id===se.car_id);ee&&c(ee)}else se.car_name&&(L.value=se.car_name,r.car_name=se.car_name,r.car_id=null);D.value=`Nomor plat ini sudah pernah diperiksa ${te.length} kali sebelumnya.`}}}}m("update:hasUnsavedChanges",le.value),m("update:validation",Q.value)},{deep:!0}),(k,p)=>{var K;return o(),n("div",He,[p[21]||(p[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b"},[e("h3",{class:"text-xl font-semibold text-indigo-700"},"Detail Kendaraan")],-1)),a.inspection?(o(),n("div",Oe,[e("div",We,[p[9]||(p[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",Ze,[ve(e("input",{"onUpdate:modelValue":p[0]||(p[0]=B=>s.value=B),type:"text",placeholder:"Contoh: B",class:G(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!Y.value||v.value}]),onInput:p[1]||(p[1]=B=>X("area")),maxlength:"2"},null,34),[[be,s.value]]),ve(e("input",{"onUpdate:modelValue":p[2]||(p[2]=B=>y.value=B),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:G(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!Y.value||v.value}]),onInput:p[3]||(p[3]=B=>X("number")),maxlength:"4"},null,34),[[be,y.value]]),ve(e("input",{"onUpdate:modelValue":p[4]||(p[4]=B=>f.value=B),type:"text",placeholder:"ABC",class:G(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!Y.value||v.value}]),onInput:p[5]||(p[5]=B=>X("suffix")),maxlength:"3"},null,34),[[be,f.value]])]),H.value?(o(),n("span",Ke,T(H.value),1)):h("",!0),M.value?(o(),n("span",Ge,T(M.value),1)):h("",!0),D.value?(o(),n("span",Xe,T(D.value),1)):h("",!0)]),e("div",Ye,[p[13]||(p[13]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",Je,[ve(e("input",{"onUpdate:modelValue":p[6]||(p[6]=B=>L.value=B),type:"text",placeholder:"Cari atau ketik nama mobil...",class:G(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ne.value}]),onInput:U,onFocus:p[7]||(p[7]=B=>b.value=!0),onBlur:w},null,34),[[be,L.value]]),N.value?(o(),n("div",Qe,p[10]||(p[10]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):h("",!0),ne.value?(o(),n("span",et,"Nama mobil tidak boleh kosong.")):h("",!0),!oe(r).car_id&&L.value?(o(),n("div",tt,p[11]||(p[11]=[Pe('<div class="flex items-start" data-v-a6c054b9><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-a6c054b9><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-a6c054b9></path></svg><div data-v-a6c054b9><p class="text-yellow-800 font-medium mb-1" data-v-a6c054b9>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-a6c054b9> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-a6c054b9>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-a6c054b9> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-a6c054b9> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-a6c054b9>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-a6c054b9>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):h("",!0),b.value?(o(),n("div",at,[z.value.length>0?(o(),n("div",st,[(o(!0),n(re,null,ue(z.value,B=>(o(),n("div",{key:B.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:J=>c(B)},[e("div",nt,T(C(B)),1),e("div",lt,T(B.year)+" • "+T(B.cc)+"cc • "+T(B.transmission)+" • "+T(B.fuel_type),1)],40,ot))),128))])):(o(),n("div",it,p[12]||(p[12]=[ae(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),ae(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):h("",!0)])]),oe(r).car_id&&I.value?(o(),n("div",rt,[I.value.description?(o(),n("div",ut,[p[14]||(p[14]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:I.value.description},null,8,dt)])):h("",!0),A.value.length>0?(o(),n("div",ct,[p[15]||(p[15]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",mt,[(o(!0),n(re,null,ue(A.value,(B,J)=>(o(),n("div",{key:B.id||J,class:"relative group cursor-pointer",onClick:te=>E(J)},[e("img",{src:j(B),alt:B.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,gt),B.note?(o(),n("div",pt,[e("p",ht,T(B.note),1)])):h("",!0)],8,vt))),128))])])):(o(),n("div",ft," Tidak ada gambar tersedia untuk mobil ini "))])):h("",!0),P.value?(o(),n("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:V},[e("div",bt,[e("button",{onClick:V,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},p[16]||(p[16]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),A.value.length>1?(o(),n("button",{key:0,onClick:ke(q,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},p[17]||(p[17]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):h("",!0),A.value.length>1?(o(),n("button",{key:1,onClick:ke(S,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},p[18]||(p[18]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):h("",!0),e("img",{src:j(A.value[u.value]),alt:"Car Image "+(u.value+1),class:"max-w-full max-h-full object-contain",onClick:p[8]||(p[8]=ke(()=>{},["stop"]))},null,8,wt),A.value.length>1?(o(),n("div",xt,T(u.value+1)+" / "+T(A.value.length),1)):h("",!0),(K=A.value[u.value])!=null&&K.note?(o(),n("div",yt,T(A.value[u.value].note),1)):h("",!0)])])):h("",!0),ie(qe,{type:"button",onClick:ge,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!ce.value},{default:xe(()=>[oe(r).processing?(o(),n("svg",kt,p[19]||(p[19]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):h("",!0),e("span",null,T(oe(r).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),ie(ze,{on:oe(r).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:xe(()=>p[20]||(p[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),ae(" Tersimpan. ")])),_:1,__:[20]},8,["on"])]),_:1},8,["disabled"])])):h("",!0)])}}},mo=pe($t,[["__scopeId","data-v-a6c054b9"]]),It={class:"mt-1"},Ct=["value","required","minlength","maxlength","allowSpace","placeholder"],Vt={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(a,{emit:F}){const t=a,m=F,r=Z(()=>{if(!t.modelValue)return"";let g=t.modelValue;switch(t.allowSpace||(g=g.replace(/\s+/g,"")),t.textTransform){case"uppercase":return g.toUpperCase();case"lowercase":return g.toLowerCase();case"capitalize":return g.replace(/\b\w/g,i=>i.toUpperCase());default:return g}}),d=g=>{let i=g.target.value;switch(t.allowSpace||(i=i.replace(/\s+/g,"")),t.textTransform){case"uppercase":i=i.toUpperCase();break;case"lowercase":i=i.toLowerCase();break;case"capitalize":i=i.replace(/\b\w/g,s=>s.toUpperCase());break}m("update:modelValue",i),m("save",t.pointId)};return(g,i)=>(o(),n("div",It,[e("input",{value:r.value,onInput:d,type:"text",required:a.required,minlength:a.minLength,maxlength:a.maxLength,allowSpace:a.allowSpace,placeholder:a.placeholder,class:G(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:a.textTransform==="uppercase",lowercase:a.textTransform==="lowercase",capitalize:a.textTransform==="capitalize"}])},null,42,Ct),a.error?(o(),n("p",Vt,T(a.error),1)):h("",!0)]))}},Mt={class:"mt-1"},_t=["value","required","min","max"],Nt={key:0,class:"mt-2 text-sm text-red-600"},Ut={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:F}){const t=a,m=F,r=d=>{m("update:modelValue",d.target.value),m("save",t.pointId)};return(d,g)=>(o(),n("div",Mt,[e("input",{value:a.modelValue,onChange:r,type:"date",required:a.required,min:a.minDate,max:a.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,_t),a.error?(o(),n("p",Nt,T(a.error),1)):h("",!0)]))}},Tt={class:"mt-1"},jt=["value","required","placeholder"],Lt={key:0,class:"mt-2 text-sm text-red-600"},Bt={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(a,{emit:F}){const t=a,m=F,r=x(""),d=Z(()=>{var f,v,M,D;return{currency_symbol:((f=t.settings)==null?void 0:f.currency_symbol)||"Rp",thousands_separator:((v=t.settings)==null?void 0:v.thousands_separator)||",",min_value:((M=t.settings)==null?void 0:M.min_value)!==void 0?Number(t.settings.min_value):0,max_value:((D=t.settings)==null?void 0:D.max_value)!==void 0?Number(t.settings.max_value):1e9}}),g=f=>{if(f==null||f==="")return"";const v=Number(f);if(isNaN(v))return"";let M=v.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return d.value.thousands_separator!==","&&(M=M.replace(/,/g,d.value.thousands_separator)),M},i=f=>f?f.replace(/[^\d]/g,""):"",s=Z(()=>r.value?`${d.value.currency_symbol} ${g(r.value)}`:""),y=f=>{let v=i(f.target.value),M=Number(v);d.value.min_value!==void 0&&M<d.value.min_value&&(v=d.value.min_value.toString()),d.value.max_value!==void 0&&M>d.value.max_value&&(v=d.value.max_value.toString()),r.value=v,m("update:modelValue",v),m("save",t.pointId)};return de(()=>t.modelValue,f=>{f!=null&&(r.value=f.toString())},{immediate:!0}),(f,v)=>(o(),n("div",Tt,[e("input",{value:s.value,onInput:y,type:"text",required:a.required,placeholder:a.placeholder,class:G(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",a.error?"border-red-300":"border-gray-300"])},null,42,jt),a.error?(o(),n("p",Lt,T(a.error),1)):h("",!0)]))}},Pt={class:"mt-1 space-y-3"},Dt={key:0,class:"space-y-2"},At={class:"flex flex-wrap gap-2"},Rt=["onClick"],Ft=["value","required","minlength","maxlength","placeholder"],qt={class:"flex justify-between items-center mt-1"},zt={class:"text-xs text-gray-500"},Et={key:0,class:"text-xs text-red-600"},Ht={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(a,{emit:F}){const t=a,m=F,r=x([]),d=x(""),g=f=>r.value.some(v=>v.value===f),i=f=>{g(f.value)?r.value=r.value.filter(L=>L.value!==f.value):r.value.push(f);const M=[...r.value.map(L=>L.value)];d.value.trim()&&M.push(d.value.trim());const D=M.join(", ");m("update:modelValue",D),m("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:D})},s=f=>{const v=f.target.value;m("update:modelValue",v),m("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:v}),y(v)},y=f=>{var L,b,N,z;if(!f){r.value=[],d.value="";return}const v=f.split(",").map(I=>I.trim()).filter(I=>I),M=((b=(L=t.settings)==null?void 0:L.damage_options)==null?void 0:b.map(I=>I.value))||[];r.value=((z=(N=t.settings)==null?void 0:N.damage_options)==null?void 0:z.filter(I=>v.includes(I.value)))||[];const D=v.filter(I=>!M.includes(I));d.value=D.join(", ")};return de(()=>t.modelValue,f=>{f!=null&&y(f)},{immediate:!0}),(f,v)=>{var M,D,L;return o(),n("div",Pt,[(M=a.settings)!=null&&M.enable_damage&&((D=a.settings)!=null&&D.damage_options)?(o(),n("div",Dt,[v[0]||(v[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",At,[(o(!0),n(re,null,ue(a.settings.damage_options,(b,N)=>(o(),n("button",{key:N,type:"button",onClick:z=>i(b),class:G(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":g(b.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!g(b.value)}])},T(b.label),11,Rt))),128))])])):h("",!0),e("div",null,[e("textarea",{value:a.modelValue,onInput:s,required:a.required,minlength:a.minLength,maxlength:a.maxLength,placeholder:a.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ft),e("div",qt,[e("span",zt,T(((L=a.modelValue)==null?void 0:L.length)||0)+"/"+T(a.maxLength||400),1),a.error?(o(),n("p",Et,T(a.error),1)):h("",!0)])])])}}},Ot={class:"mt-1"},Wt=["value","required"],Zt={key:0,class:"mt-2 text-sm text-red-600"},Kt={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:F}){const t=a,m=F,r=d=>{m("update:modelValue",d.target.value),m("save",t.pointId)};return(d,g)=>(o(),n("div",Ot,[e("select",{value:a.modelValue,onChange:r,required:a.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},g[0]||(g[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Wt),a.error?(o(),n("p",Zt,T(a.error),1)):h("",!0)]))}},vo=pe(Kt,[["__scopeId","data-v-c34a74db"]]),Gt={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},Xt={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},Yt={class:"text-xs text-gray-500 mt-2 text-center"},Jt={class:"flex flex-row space-x-4 mb-6"},Qt={class:"mt-4 text-right"},ea={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(a){return(F,t)=>a.show?(o(),n("div",Gt,[e("div",Xt,[t[7]||(t[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",Yt,[t[3]||(t[3]=ae("Ambil Foto Maksimal: ")),e("b",null,T(a.settings.max_files),1),t[4]||(t[4]=ae(" Dengan Rasio & Ukuran: ")),e("b",null,T(a.settings.camera_aspect_ratio),1)]),e("div",Jt,[e("button",{onClick:t[0]||(t[0]=m=>F.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Kamera",-1)])),e("button",{onClick:t[1]||(t[1]=m=>F.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",Qt,[e("button",{onClick:t[2]||(t[2]=m=>F.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):h("",!0)}},ta={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},aa={class:"webcam-content-box"},sa={class:"webcam-header"},oa={class:"rounded-full text-white hover:bg-gray-700 transition-colors"},na={class:"inspection-point-name"},la={key:0,class:"screen-flash-overlay"},ia={key:2,class:"zoom-controls"},ra=["max"],ua={class:"webcam-footer"},da={class:"camera-controls"},ca=["disabled"],ma={class:"camera-icon-container"},va={key:0,class:"camera-spinner"},ga={key:1,class:"camera-body"},pa={__name:"WebcamModal",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(a,{emit:F}){const t=a,m=F,r=x(null),d=x(null);let g=null,i=null;const s=x("environment"),y=x(!1),f=x(!1),v=x(!1),M=x(!1),D=x(!1),L=x({}),b=x(!1),N=x(1),z=x(1),I=x(!1),A=Z(()=>{var C;return((C=t.settings)==null?void 0:C.max_size)||2048}),P=Z(()=>t.aspectRatio?{aspectRatio:`${t.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),u=Z(()=>{if(!t.aspectRatio)return{};const C=t.aspectRatio,U=C>1?80:60,l=C>1?80/C:60*C;return{width:`${U}%`,height:`${l}%`}}),_=async()=>{g&&g.getTracks().forEach(C=>C.stop());try{const C={facingMode:s.value,width:{ideal:4096},height:{ideal:2160},aspectRatio:{ideal:t.aspectRatio||1.3333333333333333},frameRate:{ideal:30},advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{whiteBalanceMode:"continuous"}]};g=await navigator.mediaDevices.getUserMedia({video:C,audio:!1}),i=g.getVideoTracks()[0],r.value.srcObject=g,r.value.onloadedmetadata=async()=>{await X(),await r.value.play()}}catch(C){console.error("Error accessing camera: ",C),alert("Failed to access camera. Please allow camera permission."),m("close")}},R=()=>{g&&g.getTracks().forEach(C=>C.stop()),m("close")},X=async()=>{if(i)try{const C=await navigator.mediaDevices.enumerateDevices();y.value=C.filter(l=>l.kind==="videoinput").length>1;const U=i.getCapabilities();U.zoom?(I.value=!0,z.value=U.zoom.max,console.log(`Zoom supported. Max zoom: ${z.value}`)):(I.value=!1,console.warn("Zoom is not supported by this camera.")),f.value=U.torch||U.fillLightMode&&U.fillLightMode.includes("torch")}catch(C){console.error("Error checking camera capabilities:",C)}},Y=async C=>{if(!i)return;const U=r.value.getBoundingClientRect(),l=C.clientX-U.left,w=C.clientY-U.top;D.value=!0,L.value={left:`${l}px`,top:`${w}px`,transform:"translate(-50%, -50%)"};try{if(i.getCapabilities().pointsOfInterest){const j=l/U.width,$=w/U.height;await i.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:j,y:$}]}]})}else console.warn("Manual focus with point of interest is not supported.")}catch(c){console.warn("Manual focus failed:",c)}setTimeout(()=>{D.value=!1,i.getCapabilities().focusMode.includes("continuous")&&i.applyConstraints({advanced:[{focusMode:"continuous"}]})},1e3)},ne=async C=>{if(!i||!I.value)return;const U=Math.min(Math.max(C,1),z.value);N.value=U;try{await i.applyConstraints({advanced:[{zoom:U}]})}catch(l){console.error("Failed to set zoom:",l)}},H=async()=>{if(!(!i||!f.value))try{s.value==="user"?(v.value=!v.value,M.value=v.value):(await i.applyConstraints({advanced:[{torch:!v.value}]}),v.value=!v.value)}catch(C){console.error("Flash toggle failed:",C)}},Q=async()=>{y.value&&(s.value=s.value==="environment"?"user":"environment",g&&g.getTracks().forEach(C=>C.stop()),await _())},le=async C=>new Promise(U=>{const l=A.value*1024;if(C.size<=l){U(C);return}const w=new Image,c=new FileReader;c.onload=j=>{w.onload=()=>{const $=document.createElement("canvas"),E=$.getContext("2d"),V=Math.sqrt(l/C.size);$.width=w.width*V,$.height=w.height*V,E.drawImage(w,0,0,$.width,$.height);let S=.9;const q=()=>{$.toBlob(O=>{O.size>l&&S>.1?(S-=.1,q()):U(O)},"image/jpeg",S)};q()},w.src=j.target.result},c.readAsDataURL(C)}),ce=async()=>{if(!(b.value||!r.value||!d.value)){b.value=!0;try{const C=r.value,U=d.value,l=C.videoWidth,w=C.videoHeight;let c,j,$,E;l/w>t.aspectRatio?(j=w,c=w*t.aspectRatio,$=(l-c)/2,E=0):(c=l,j=l/t.aspectRatio,$=0,E=(w-j)/2),U.width=c,U.height=j,U.getContext("2d").drawImage(C,$,E,c,j,0,0,c,j);const S=await new Promise(O=>{U.toBlob(O,"image/jpeg",1)}),q=await le(S);if(q){const O=new File([q],`capture_${Date.now()}.jpeg`,{type:"image/jpeg",lastModified:Date.now()});m("photoCaptured",O),M.value=!0,setTimeout(()=>{M.value=!1},100)}}catch(C){console.error("Error capturing photo:",C),alert("Failed to capture photo. Please try again.")}finally{b.value=!1}}};return de(()=>t.show,C=>{C?_():R()}),Me(()=>{g&&g.getTracks().forEach(C=>C.stop())}),(C,U)=>{var l;return a.show?(o(),n("div",ta,[e("div",aa,[e("div",sa,[e("p",oa,T(a.settings.camera_aspect_ratio),1),e("div",na,T(((l=a.point)==null?void 0:l.name)||"Camera"),1),e("button",{onClick:R,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},U[2]||(U[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:we(P.value),onClick:Y,onTouchstart:Y},[e("video",{ref_key:"webcamVideo",ref:r,autoplay:"",playsinline:"",class:"webcam-video"},null,512),e("canvas",{ref_key:"webcamCanvas",ref:d,class:"hidden"},null,512),M.value?(o(),n("div",la)):h("",!0),e("div",{class:"aspect-ratio-guide",style:we(u.value)},null,4),D.value?(o(),n("div",{key:1,class:"focus-indicator",style:we(L.value)},U[3]||(U[3]=[e("div",{class:"focus-ring"},null,-1)]),4)):h("",!0),U[4]||(U[4]=e("div",{class:"hd-badge"},[e("span",{class:"hd-text"},"HD")],-1)),I.value?(o(),n("div",ia,[ve(e("input",{type:"range",min:"1",max:z.value,step:"0.1","onUpdate:modelValue":U[0]||(U[0]=w=>N.value=w),onInput:U[1]||(U[1]=w=>ne(parseFloat(w.target.value))),class:"zoom-slider"},null,40,ra),[[be,N.value]])])):h("",!0)],36),e("div",ua,[e("div",da,[a.settings.enable_flash&&f.value?(o(),n("button",{key:0,onClick:H,class:G(["control-button",{active:v.value,disabled:!f.value}])},U[5]||(U[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):h("",!0),e("button",{onClick:ce,class:"capture-button",disabled:b.value},[e("div",ma,[b.value?(o(),n("div",va)):(o(),n("div",ga,U[6]||(U[6]=[e("div",{class:"camera-lens"},null,-1),e("div",{class:"camera-flash"},null,-1)])))])],8,ca),a.settings.enable_camera_switch&&y.value?(o(),n("button",{key:1,onClick:Q,class:"control-button"},U[7]||(U[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]))):h("",!0)])])])])):h("",!0)}}},ha=pe(pa,[["__scopeId","data-v-b94530cf"]]),fa={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ba={class:"w-full h-full flex flex-col"},wa={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},xa={class:"text-lg font-semibold"},ya={class:"flex items-center gap-2"},ka={class:"flex-1 flex items-center justify-center overflow-hidden relative"},$a=["src"],Ia={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},Ca={class:"flex justify-between items-center w-full"},Va=["disabled"],Sa={key:1,class:"flex-1"},Ma=["disabled"],_a={class:"flex gap-3 w-full"},Na={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium",disabled:""},Ua={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images"],setup(a,{emit:F}){const t=a,m=F,r=x(0),d=x([]),g=Z(()=>d.value.length>0?d.value[r.value]:null);de(()=>t.images,b=>{d.value=b.map(N=>({...N,rotation:N.rotation||0})),b.length===0&&t.show&&M()},{deep:!0,immediate:!0}),de(()=>t.show,b=>{b&&t.images.length>0&&(r.value=t.initialIndex)});const i=b=>b.preview||(b.image_path?`/${b.image_path}`:""),s=()=>{if(g.value){const b=(g.value.rotation+90)%360;d.value[r.value].rotation=b,m("update:images",d.value)}},y=()=>{r.value=r.value<d.value.length-1?r.value+1:0},f=()=>{r.value=r.value>0?r.value-1:d.value.length-1},v=()=>{t.isUploading||m("saveImages",d.value)},M=()=>{t.isUploading||m("close")},D=()=>{if(g.value&&!t.isUploading){const b=g.value,N=d.value.findIndex(z=>z.isNew&&b.isNew&&z.preview===b.preview||!z.isNew&&!b.isNew&&z.id===b.id);N!==-1&&(m("removePreviewImage",b),d.value.splice(N,1),m("update:images",d.value)),r.value>=d.value.length&&(r.value=Math.max(0,d.value.length-1)),d.value.length===0&&m("close")}},L=()=>{t.isUploading||m("triggerAddMorePhotos")};return(b,N)=>{var z;return a.show?(o(),n("div",fa,[e("div",ba,[e("div",wa,[e("button",{onClick:M,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors"},N[0]||(N[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("div",xa,T(((z=a.point)==null?void 0:z.name)||"Preview")+" ("+T(r.value+1)+"/"+T(d.value.length)+") ",1),e("div",ya,[g.value&&g.value.isNew?(o(),n("button",{key:0,onClick:D,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image"},N[1]||(N[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]))):h("",!0),g.value&&g.value.isNew?(o(),n("button",{key:1,onClick:s,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors"},N[2]||(N[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))):h("",!0)])]),e("div",ka,[e("div",{class:"relative w-full max-w-full",style:we({paddingTop:a.aspectRatio?100/a.aspectRatio+"%":"75%"})},[g.value?(o(),n("img",{key:0,src:i(g.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:we({transform:`rotate(${g.value.rotation}deg)`})},null,12,$a)):h("",!0)],4),d.value.length>1?(o(),n("button",{key:0,onClick:f,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors"},N[3]||(N[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):h("",!0),d.value.length>1?(o(),n("button",{key:1,onClick:y,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors"},N[4]||(N[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):h("",!0)]),e("div",Ia,[e("div",Ca,[g.value&&!g.value.isNew?(o(),n("button",{key:0,onClick:D,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:a.isUploading},N[5]||(N[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ae(" Hapus Foto ")]),8,Va)):(o(),n("div",Sa)),a.allowMultiple&&d.value.length<a.maxFiles?(o(),n("button",{key:2,onClick:L,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:a.isUploading},N[6]||(N[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ae(" Tambah Foto ")]),8,Ma)):h("",!0)]),e("div",_a,[a.isUploading?(o(),n("button",Na,N[7]||(N[7]=[ae(" Menyimpan"),e("span",{class:"loading-dots ml-1"},[e("span",null,"."),e("span",null,"."),e("span",null,".")],-1)]))):(o(),n("button",{key:0,onClick:v,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium"}," Simpan "))])])])])):h("",!0)}}},Ta=pe(Ua,[["__scopeId","data-v-41f87672"]]),ja=["accept","multiple","disabled"],La={class:"text-xs text-gray-500 mb-2"},Ba=["disabled"],Pa={class:"h-full flex flex-col items-center justify-center p-4 text-center"},Da={class:"text-xs text-gray-400 mt-1"},Aa={key:0,class:"flex items-center gap-4"},Ra=["src"],Fa=["disabled"],qa={key:1,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},za=["disabled"],Ea=["onClick"],Ha=["src"],Oa={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},Wa={key:0},Za={key:1,class:"ml-1"},Ka={key:2,class:"mt-1 text-xs text-red-600"},Ga={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded"],setup(a,{emit:F}){const t=a,m=F,r=x(null),d=x(null),g=x(!1),i=x(!1),s=x(!1),y=x([]),f=x(0),v=x(!1),M=Z(()=>Number(t.settings.max_files)>1),D=Z(()=>t.settings.allowed_types.map(l=>`.${l}`).join(", ")),L=Z(()=>{const l=t.settings.camera_aspect_ratio.split(":");if(l.length===2){const w=parseFloat(l[0]),c=parseFloat(l[1]);if(!isNaN(w)&&!isNaN(c)&&c!==0)return w/c}return 3/4}),b=Z(()=>{const l=[],w=new Set;for(const c of y.value)c.id&&w.add(c.id),l.push(c);for(const c of t.modelValue)w.has(c.id)||l.push({...c,rotation:c.rotation||0,isNew:!1,preview:c.preview||(c.image_path?`/${c.image_path}`:null)});return l}),N=l=>l.preview||(l.image_path?`/${l.image_path}`:""),z=()=>{s.value&&(s.value=!1),g.value=!0},I=()=>{g.value=!1,r.value.click()},A=()=>{g.value=!1,i.value=!0},P=()=>{g.value=!1,b.value.length>0&&(s.value=!0)},u=()=>{i.value=!1,b.value.length>0&&(s.value=!0)},_=()=>{s.value=!1,y.value.forEach(l=>{l.preview&&l.preview.startsWith("blob:")&&URL.revokeObjectURL(l.preview)}),y.value=[]},R=l=>new Promise(w=>{const c=new FileReader;c.onload=j=>{const $=new Image;$.onload=()=>{w({file:l,preview:URL.createObjectURL(l),rotation:0,width:$.naturalWidth,height:$.naturalHeight,isNew:!0})},$.onerror=()=>{console.error("Failed to load image for dimensions:",l.name),w({file:l,preview:URL.createObjectURL(l),rotation:0,width:0,height:0,isNew:!0})},$.src=j.target.result},c.readAsDataURL(l)}),X=l=>{const w=l.name.split(".").pop().toLowerCase();return t.settings.allowed_types.includes(w)},Y=async l=>{const c=(t.settings.max_size||2048)*1024;return new Promise(j=>{const $=new Image,E=new FileReader;E.onload=V=>{$.onload=()=>{const S=document.createElement("canvas"),q=S.getContext("2d"),O=Math.max($.width,$.height);S.width=O,S.height=O,q.fillStyle="white",q.fillRect(0,0,O,O);const W=(O-$.width)/2,ge=(O-$.height)/2;q.drawImage($,W,ge,$.width,$.height);let me=.9;const he=()=>{S.toBlob(fe=>{if(fe.size>c&&me>.1)me-=.1,he();else{const ye=new File([fe],l.name,{type:"image/jpeg",lastModified:Date.now()});j(ye)}},"image/jpeg",me)};he()},$.src=V.target.result},E.readAsDataURL(l)})},ne=async l=>{const w=Array.from(l.target.files);if(!w.length){g.value=!1,b.value.length>0&&(s.value=!0);return}try{const c=w.filter(q=>!X(q));if(c.length>0){const q=c.map(O=>O.name.split(".").pop()).join(", ");alert(`File type not allowed: ${q}. Allowed types: ${t.settings.allowed_types.join(", ")}`),l.target.value="";return}const j=b.value.length,$=t.settings.max_files-j,E=await Promise.all(w.slice(0,$).map(async q=>await Y(q))),V=await Promise.all(E.map(R)),S=M.value?V:V.slice(0,1);M.value?y.value.push(...S):(y.value.forEach(q=>{q.preview&&q.preview.startsWith("blob:")&&URL.revokeObjectURL(q.preview)}),y.value=S),g.value=!1,S.length>0?(f.value=Math.max(0,b.value.length-S.length),s.value=!0):b.value.length>0&&(s.value=!0),l.target.value=""}catch(c){console.error("Error processing selected images:",c),alert("Failed to process selected images. Please try again."),g.value=!1,b.value.length>0&&(s.value=!0)}},H=async l=>{const w=b.value.length;if(!M.value||w<t.settings.max_files)try{const c=await Y(l),j=new Image;j.onload=()=>{const $={file:c,preview:URL.createObjectURL(c),rotation:0,width:j.naturalWidth,height:j.naturalHeight,isNew:!0};M.value?y.value.push($):(y.value.forEach(E=>{E.preview&&E.preview.startsWith("blob:")&&URL.revokeObjectURL(E.preview)}),y.value=[$]),i.value=!1,g.value=!1,f.value=b.value.length-1,s.value=!0},j.src=URL.createObjectURL(c)}catch(c){console.error("Error processing captured image:",c),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${t.settings.max_files} files allowed.`),i.value=!1,g.value=!1,b.value.length>0&&(s.value=!0)},Q=(l=0)=>{f.value=l,s.value=!0},le=l=>new Promise(w=>{if(l.rotation===0||!d.value){if(!l.isNew&&!l.file){w({file:null,width:l.width,height:l.height,isOriginal:!0});return}w({file:l.file,width:l.width,height:l.height});return}const c=new Image;c.onload=async()=>{try{const j=d.value,$=j.getContext("2d"),E=c.width,V=c.height;let S,q;l.rotation===90||l.rotation===270?(S=V,q=E):(S=E,q=V),j.width=S,j.height=q,$.clearRect(0,0,j.width,j.height),$.translate(j.width/2,j.height/2),$.rotate(l.rotation*Math.PI/180),$.drawImage(c,-E/2,-V/2,E,V),$.setTransform(1,0,0,1,0,0);const O=await new Promise(me=>{j.toBlob(me,"image/jpeg",.9)}),W=new File([O],l.file?l.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),ge=await Y(W);w({file:ge,width:S,height:q})}catch(j){console.error("Error processing rotated image:",j),w({file:l.file,width:l.width,height:l.height})}},c.onerror=()=>{console.error("Failed to load image for rotation processing:",l.preview),w({file:l.file,width:l.width,height:l.height})},c.src=l.preview}),ce=async l=>{var j,$,E,V;v.value=!0;const w=[],c=[];if(!t.pointId){alert("Error: Point ID is missing. Cannot upload image."),v.value=!1;return}try{for(const S of l){if(!S.isNew&&S.rotation===0&&S.id&&S.image_path){w.push({id:S.id,image_path:S.image_path,width:S.width,height:S.height,rotation:0,preview:S.preview});continue}const{file:q,width:O,height:W,isOriginal:ge}=await le(S);if(ge&&!S.isNew){w.push({id:S.id,image_path:S.image_path,width:S.width,height:S.height,rotation:0,preview:S.preview});continue}q&&c.push({file:q,width:O,height:W,rotation:0})}if(c.length>0){const S=new FormData;S.append("inspection_id",t.inspectionId),S.append("point_id",t.pointId),c.forEach(W=>{S.append("images[]",W.file)});const O=(await Ue.post(route("inspections.upload-image"),S,{headers:{"Content-Type":"multipart/form-data"}})).data.images;for(const W of O)w.push({id:W.image_id,image_path:W.path,width:W.width||0,height:W.height||0,rotation:W.rotation||0,preview:W.public_url});c.forEach(W=>{W.file&&W.file.preview&&W.file.preview.startsWith("blob:")&&URL.revokeObjectURL(W.file.preview)})}m("update:modelValue",w),m("save",t.pointId),m("uploaded",{pointId:t.pointId,images:w}),_()}catch(S){if(console.error("Error during image processing/upload:",S),($=(j=S.response)==null?void 0:j.data)!=null&&$.message)alert(`Failed to save images: ${S.response.data.message}`);else if((V=(E=S.response)==null?void 0:E.data)!=null&&V.errors){const q=Object.values(S.response.data.errors).flat().join(`
`);alert(`Failed to save images:
${q}`)}else alert(`Failed to save images: ${S.message}`)}finally{v.value=!1}},C=l=>{if(l){if(l.id&&!l.isNew)U(l);else{const w=y.value.findIndex(c=>c.preview&&c.preview===l.preview&&c.isNew||c.id&&c.id===l.id);if(w!==-1){const c=y.value.splice(w,1)[0];c.preview&&c.preview.startsWith("blob:")&&URL.revokeObjectURL(c.preview)}m("update:modelValue",t.modelValue.filter(c=>!(c.id&&c.id===l.id)&&!(c.preview&&c.preview===l.preview)))}f.value>=b.value.length&&(f.value=Math.max(0,b.value.length-1)),b.value.length===0&&_()}},U=async l=>{var c,j;if(l.id||l.image_path)try{await Ue.delete(route("inspections.delete-image"),{data:{image_id:l.id,image_path:l.image_path}})}catch($){console.error("Error deleting image from server:",$),(j=(c=$.response)==null?void 0:c.data)!=null&&j.message?alert(`Failed to delete image from server: ${$.response.data.message}`):alert(`Failed to delete image from server: ${$.message}`);return}l.preview&&l.preview.startsWith("blob:")&&URL.revokeObjectURL(l.preview);const w=t.modelValue.filter($=>$.id!==l.id);m("update:modelValue",w),y.value=y.value.filter($=>$.isNew&&l.isNew?$.preview!==l.preview:$.id!==l.id),m("removeImage",{image:l}),s.value&&b.value.length===0?_():s.value&&f.value>=b.value.length&&(f.value=Math.max(0,b.value.length-1))};return(l,w)=>(o(),n("div",null,[e("input",{ref_key:"galleryInput",ref:r,type:"file",accept:D.value,class:"hidden",onChange:ne,multiple:M.value,disabled:v.value},null,40,ja),e("canvas",{ref_key:"processingCanvas",ref:d,class:"hidden"},null,512),e("p",La,"Foto Maksimal: "+T(a.settings.max_files)+" | Rasio: "+T(a.settings.camera_aspect_ratio),1),b.value.length===0?(o(),n("label",{key:0,onClick:z,class:G(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:v.value},[e("div",Pa,[w[2]||(w[2]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),w[3]||(w[3]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",Da,"Tipe: "+T(D.value),1)])],8,Ba)):(o(),n("div",{key:1,class:G(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":a.settings.max_files==1,"bg-transparent":a.settings.max_files>1}]),"aria-label":"Image gallery"},[a.settings.max_files===1?(o(),n("div",Aa,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:w[0]||(w[0]=c=>Q(0))},[e("img",{src:N(b.value[0]),class:"w-full h-full object-cover"},null,8,Ra)]),e("button",{onClick:w[1]||(w[1]=ke(c=>U(b.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:v.value},w[4]||(w[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ae(" Hapus Foto ")]),8,Fa)])):(o(),n("div",qa,[M.value&&b.value.length<a.settings.max_files?(o(),n("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:z,disabled:v.value},w[5]||(w[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,za)):h("",!0),(o(!0),n(re,null,ue(b.value,(c,j)=>(o(),n("div",{key:c.id||c.preview,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:$=>Q(j)},[e("img",{src:N(c),class:"w-full h-full object-cover"},null,8,Ha),c.isNew||c.rotation!==0?(o(),n("div",Oa,[c.isNew?(o(),n("span",Wa,"BARU")):h("",!0),c.rotation!==0?(o(),n("span",Za,"ROTASI")):h("",!0)])):h("",!0)],8,Ea))),128))]))],2)),a.error?(o(),n("p",Ka,T(a.error),1)):h("",!0),ie(ea,{show:g.value,settings:a.settings,onClose:P,onOpenWebcam:A,onTriggerGallery:I},null,8,["show","settings"]),ie(ha,{show:i.value,"aspect-ratio":L.value,settings:a.settings,point:a.point,onClose:u,onPhotoCaptured:H},null,8,["show","aspect-ratio","settings","point"]),ie(Ta,{show:s.value,images:b.value,point:a.point,"initial-index":f.value,"allow-multiple":M.value,"max-files":a.settings.max_files,"is-uploading":v.value,"aspect-ratio":L.value,onClose:_,onSaveImages:ce,onRemovePreviewImage:C,onTriggerAddMorePhotos:z},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio"])]))}},je=pe(Ga,[["__scopeId","data-v-771b7e31"]]),Xa={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Ya={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Ja={class:"px-4 pb-2 border-b border-gray-200"},Qa={class:"text-lg font-semibold text-gray-900"},es={key:0,class:"text-sm text-gray-500 mt-1"},ts={class:"flex-1 overflow-y-auto p-4"},as={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},ss={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},emits:["close"],setup(a,{emit:F}){const t=F,m=()=>{t("close")},r=d=>{d.key==="Escape"&&m()};return $e(()=>{document.addEventListener("keydown",r)}),Me(()=>{document.removeEventListener("keydown",r)}),(d,g)=>(o(),Ie(De,{name:"bottom-sheet"},{default:xe(()=>[a.show?(o(),n("div",Xa,[e("div",{class:"absolute inset-0 bg-black bg-opacity-50",onClick:m}),e("div",Ya,[g[0]||(g[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Ja,[e("h3",Qa,T(a.title),1),a.subtitle?(o(),n("p",es,T(a.subtitle),1)):h("",!0)]),e("div",ts,[Te(d.$slots,"default",{},void 0,!0)]),d.$slots.footer?(o(),n("div",as,[Te(d.$slots,"footer",{},void 0,!0)])):h("",!0)])])):h("",!0)]),_:3}))}},os=pe(ss,[["__scopeId","data-v-7893c2dc"]]),ns={class:"space-y-4"},ls={key:0,class:"mt-2"},is={key:1,class:"mt-2"},rs={key:2,class:"mt-2"},us={key:3,class:"mt-2"},ds={key:4,class:"mt-2"},cs={class:"text-sm font-medium text-gray-700 mb-2"},ms={key:0,class:"text-red-500"},vs={key:0,class:"text-xs text-red-500"},gs=["name","value","checked"],ps={key:6,class:"space-y-2"},hs={key:0,class:"text-red-500"},fs={key:1,class:"text-xs text-red-500"},bs={key:7,class:"mt-4"},ws={class:"text-sm font-medium text-gray-700 mb-2"},xs={key:0,class:"text-red-500"},ys={key:0,class:"text-xs text-red-500"},ks={class:"flex gap-2"},$s=["disabled"],Le={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:String,notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(a,{emit:F}){const t=a,m=F,r=i=>m("hapus",i),d=Z(()=>t.options.find(i=>i.value===t.selectedValue)),g=Z(()=>{var s,y,f,v,M,D,L;if(t.point.input_type==="text"&&(!((s=t.notesValue)!=null&&s.trim())||t.point.settings.min_length&&t.notesValue.length<t.point.settings.min_length||t.point.settings.max_length&&t.notesValue.length>t.point.settings.max_length)||t.point.input_type==="number"&&(!((y=t.notesValue)!=null&&y.trim())||t.point.settings.min&&t.notesValue.length<t.point.settings.min||t.point.settings.max&&t.notesValue.length>t.point.settings.max)||t.point.input_type==="account"&&(!((f=t.notesValue)!=null&&f.trim())||t.point.settings.min_value&&t.notesValue.length<t.point.settings.min_value||t.point.settings.max_value&&t.notesValue.length>t.point.settings.max_value)||t.point.input_type==="date"&&(!((v=t.notesValue)!=null&&v.trim())||t.point.settings.min_date&&t.notesValue.length<t.point.settings.min_date||t.point.settings.max_date&&t.notesValue.length>t.point.settings.max_date)||t.point.input_type==="imageTOradio"&&t.imagesValue.length===0||t.options.length&&!t.selectedValue)return!1;const i=d.value;return!(t.showTextarea&&((M=i==null?void 0:i.settings)!=null&&M.show_textarea)&&(!((D=t.notesValue)!=null&&D.trim())||i.settings.min_length&&t.notesValue.length<i.settings.min_length||i.settings.max_length&&t.notesValue.length>i.settings.max_length)||t.showImageUpload&&((L=i==null?void 0:i.settings)!=null&&L.show_image_upload)&&(t.imagesValue.length===0||i.settings.max_files&&t.imagesValue.length>i.settings.max_files))});return(i,s)=>(o(),Ie(os,{show:a.show,title:a.title,subtitle:a.subtitle,onClose:s[18]||(s[18]=y=>i.$emit("close"))},{footer:xe(()=>[a.selectedPoint?(o(),n("button",{key:0,onClick:s[15]||(s[15]=y=>r(a.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},s[20]||(s[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),ae(" Hapus Data ")]))):h("",!0),e("div",ks,[e("button",{type:"button",onClick:s[16]||(s[16]=y=>i.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:s[17]||(s[17]=y=>i.$emit("save")),disabled:!g.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,$s)])]),default:xe(()=>{var y,f,v,M,D,L,b,N,z,I,A,P,u,_,R,X,Y,ne,H,Q,le,ce,C,U,l,w,c,j,$,E;return[e("div",ns,[a.point.input_type==="text"?(o(),n("div",ls,[ie(St,{"model-value":a.notesValue,required:(y=a.point.settings)==null?void 0:y.is_required,"min-length":(f=a.point.settings)==null?void 0:f.min_length,"max-length":(v=a.point.settings)==null?void 0:v.max_length,allowSpace:(M=a.point.settings)==null?void 0:M.allow_space,textTransform:(D=a.point.settings)==null?void 0:D.text_transform,placeholder:((L=a.point.settings)==null?void 0:L.placeholder)||"Masukan text",error:i.error,"onUpdate:modelValue":s[0]||(s[0]=V=>i.$emit("update:notesValue",V)),onSave:s[1]||(s[1]=V=>i.$emit("saveText",V))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):h("",!0),a.point.input_type==="number"?(o(),n("div",is,[ie(Ee,{"model-value":a.notesValue,required:(b=a.point.settings)==null?void 0:b.is_required,min:(N=a.point.settings)==null?void 0:N.min,max:(z=a.point.settings)==null?void 0:z.max,step:((I=a.point.settings)==null?void 0:I.step)||1,placeholder:((A=a.point.settings)==null?void 0:A.placeholder)||"Masukan number",error:i.error,"onUpdate:modelValue":s[2]||(s[2]=V=>i.$emit("update:notesValue",V)),onSave:s[3]||(s[3]=V=>i.$emit("saveNumber",V))},null,8,["model-value","required","min","max","step","placeholder","error"])])):h("",!0),a.point.input_type==="account"?(o(),n("div",rs,[ie(Bt,{"model-value":a.notesValue,required:(P=a.point.settings)==null?void 0:P.is_required,placeholder:((u=a.point.settings)==null?void 0:u.placeholder)||"Masukkan nilai",error:i.error,"point-id":a.pointId,settings:a.point.settings,"onUpdate:modelValue":s[4]||(s[4]=V=>i.$emit("update:notesValue",V)),onSave:s[5]||(s[5]=V=>i.$emit("saveAccount",V))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):h("",!0),a.point.input_type==="date"?(o(),n("div",us,[ie(Ut,{"model-value":a.notesValue,required:(_=a.point.settings)==null?void 0:_.is_required,"min-date":(R=a.point.settings)==null?void 0:R.min_date,"max-date":(X=a.point.settings)==null?void 0:X.max_date,error:i.error,"onUpdate:modelValue":s[6]||(s[6]=V=>i.$emit("update:notesValue",V)),onSave:s[7]||(s[7]=V=>i.$emit("saveDate",V))},null,8,["model-value","required","min-date","max-date","error"])])):h("",!0),a.point.input_type==="imageTOradio"?(o(),n("div",ds,[e("h4",cs,[(Y=a.point.settings)!=null&&Y.required?(o(),n("span",ms,"*")):h("",!0)]),ie(je,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point.inspection_point,"inspection-id":a.inspectionId,settings:a.point.settings,"onUpdate:modelValue":s[8]||(s[8]=V=>i.$emit("update:imagesValue",V)),onSave:s[9]||(s[9]=V=>i.$emit("saveImage",V))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ne=a.point.settings)!=null&&ne.required&&a.imagesValue.length===0?(o(),n("p",vs," Foto wajib diupload ")):h("",!0)])):h("",!0),a.options.length?(o(),n("div",{key:5,class:G(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(o(!0),n(re,null,ue(a.options,(V,S)=>(o(),n("label",{key:S,class:"cursor-pointer"},[e("input",{type:"radio",name:a.name,value:V.value,checked:a.selectedValue===V.value,onChange:s[10]||(s[10]=q=>i.$emit("update:selectedValue",q.target.value)),class:"hidden peer"},null,40,gs),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":a.selectedValue===V.value,"border-gray-300 text-gray-700 hover:bg-gray-50":a.selectedValue!==V.value}])},T(V.label),3)]))),128))],2)):h("",!0),a.showTextarea&&((Q=(H=d.value)==null?void 0:H.settings)!=null&&Q.show_textarea)?(o(),n("div",ps,[(le=d.value.settings)!=null&&le.required?(o(),n("span",hs,"*")):h("",!0),ie(Ht,{"model-value":a.notesValue,"point-id":a.pointId,"inspection-id":a.inspectionId,settings:d.value.settings,required:(ce=d.value.settings)==null?void 0:ce.required,"min-length":(C=d.value.settings)==null?void 0:C.min_length,"max-length":(U=d.value.settings)==null?void 0:U.max_length,placeholder:((l=d.value.settings)==null?void 0:l.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":s[11]||(s[11]=V=>i.$emit("update:notesValue",V)),onSave:s[12]||(s[12]=V=>i.$emit("saveTextarea",V))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(w=d.value.settings)!=null&&w.required&&!a.notesValue?(o(),n("p",fs," Keterangan wajib diisi ")):h("",!0)])):h("",!0),a.showImageUpload&&((j=(c=d.value)==null?void 0:c.settings)!=null&&j.show_image_upload)?(o(),n("div",bs,[e("h4",ws,[s[19]||(s[19]=ae(" Upload Foto ")),($=d.value.settings)!=null&&$.required?(o(),n("span",xs,"*")):h("",!0)]),ie(je,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,settings:d.value.settings,"onUpdate:modelValue":s[13]||(s[13]=V=>i.$emit("update:imagesValue",V)),onSave:s[14]||(s[14]=V=>i.$emit("saveImage",V))},null,8,["model-value","point-id","point","inspection-id","settings"]),(E=d.value.settings)!=null&&E.required&&a.imagesValue.length===0?(o(),n("p",ys," Foto wajib diupload ")):h("",!0)])):h("",!0)])]}),_:1},8,["show","title","subtitle"]))}},Is={class:"mt-2 space-y-2"},Cs=["name","value","checked","onChange","required"],Vs={key:0,class:"p-2 rounded-lg bg-gray-50"},Ss={key:0,class:"mt-2"},Ms={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},_s=["src"],Ns={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Us={key:1,class:"mt-2"},Ts={class:"text-sm text-gray-600"},js={key:2,class:"mt-2 text-sm text-red-600"},go={__name:"InputRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:F}){const t=a,m=F,r=x(t.notes),d=x([...t.images]),g=x(!1),i=x(""),s=x([]),y=x(""),f=x([]),v=Z(()=>t.options.find(u=>u.value===t.modelValue)),M=u=>u.settings&&(u.settings.show_textarea||u.settings.show_image_upload);de(()=>t.notes,u=>{r.value=u}),de(()=>t.images,u=>{d.value=[...u]}),de(()=>t.modelValue,u=>{u&&(y.value=u)});const D=u=>{m("update:modelValue",u.value),M(u)?b():m("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:u.value,notes:"",images:[]})},L=u=>u.preview||(u.image_path?`/${u.image_path}`:u),b=()=>{y.value=t.modelValue,i.value=r.value,s.value=[...d.value],f.value=[...d.value],g.value=!0},N=()=>{i.value="",s.value=[],y.value="",g.value=!1},z=u=>{s.value=u,d.value=[...u],m("update:images",[...u]),m("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:t.modelValue,notes:r.value,images:[...u]})},I=u=>{},A=()=>{y.value!==t.modelValue&&m("update:modelValue",y.value),r.value=i.value,m("update:notes",i.value),d.value=[...s.value],m("update:images",[...s.value]),m("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:y.value,notes:i.value,images:s.value}),g.value=!1},P=u=>{y.value="",i.value="",s.value=[],r.value="",d.value=[],m("update:modelValue",""),m("update:notes",""),m("update:images",[]),m("hapus",u),g.value=!1};return(u,_)=>{var R,X,Y,ne;return o(),n("div",Is,[e("div",{class:G(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(o(!0),n(re,null,ue(a.options,(H,Q)=>(o(),n("label",{key:Q,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+a.pointId,value:H.value,checked:a.modelValue===H.value,onChange:le=>D(H),class:"hidden peer",required:a.required},null,40,Cs),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":a.modelValue===H.value,"border-gray-300 text-gray-700 hover:bg-gray-50":a.modelValue!==H.value}])},T(H.label),3)]))),128))],2),a.modelValue&&v.value&&M(v.value)?(o(),n("div",Vs,[e("div",{class:"flex justify-between items-start"},[_[4]||(_[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:b,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),a.images.length>0&&((R=v.value.settings)!=null&&R.show_image_upload)?(o(),n("div",Ss,[e("div",Ms,[(o(!0),n(re,null,ue(a.images,(H,Q)=>(o(),n("div",{key:Q,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:L(H),class:"w-full h-full object-cover rounded"},null,8,_s),Q===3&&a.images.length>4?(o(),n("span",Ns," +"+T(a.images.length-4),1)):h("",!0)]))),128))])])):h("",!0),a.notes&&((X=v.value.settings)!=null&&X.show_textarea)?(o(),n("div",Us,[e("p",Ts,T(a.notes),1)])):h("",!0)])):h("",!0),g.value?(o(),Ie(Le,{key:(Y=a.selectedPoint)==null?void 0:Y.id,show:g.value,title:a.pointName||"Detail",subtitle:(ne=v.value)==null?void 0:ne.description,name:"modal-radio-"+a.pointId,options:a.options,"selected-value":y.value,"notes-value":i.value,"images-value":s.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":_[0]||(_[0]=H=>y.value=H),"onUpdate:notesValue":_[1]||(_[1]=H=>i.value=H),"onUpdate:imagesValue":_[2]||(_[2]=H=>z(H)),onClose:N,onSave:A,onSaveTextarea:u.handleTextareaSave,onSaveImage:I,onHapus:_[3]||(_[3]=H=>P(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):h("",!0),a.error?(o(),n("p",js,T(a.error),1)):h("",!0)])}}},Ls={class:"mt-2 space-y-2"},Bs={key:0,class:"flex flex-wrap gap-3"},Ps={key:1,class:"p-2"},Ds={key:0,class:"mt-2"},As={class:"flex gap-2 overflow-x-auto scrollbar-hide"},Rs=["src"],Fs={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},qs=["name","value","checked"],zs={key:1,class:"mt-2"},Es={class:"text-sm text-gray-600"},Hs={key:3,class:"mt-2 text-sm text-red-600"},po={__name:"InputImageToRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:F}){const t=a,m=F,r=x(t.notes),d=x([...t.images]),g=x(!1),i=x(""),s=x([]),y=x(""),f=x([]),v=Z(()=>t.options.find(I=>I.value===t.modelValue)),M=I=>I.preview||(I.image_path?`/${I.image_path}`:I);de(()=>t.notes,I=>{r.value=I});const D=()=>{y.value=t.modelValue||"",i.value=r.value,s.value=[...d.value],f.value=[...d.value],g.value=!0},L=()=>{i.value="",s.value=[],y.value="",g.value=!1},b=I=>{s.value=I,d.value=[...I],m("update:images",[...I]),m("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:t.modelValue,notes:r.value,images:[...I]})},N=()=>{y.value!==t.modelValue&&m("update:modelValue",y.value),r.value=i.value,m("update:notes",i.value),d.value=[...s.value],m("update:images",[...s.value]),m("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:y.value,notes:i.value,images:s.value}),g.value=!1},z=I=>{y.value="",i.value="",s.value=[],r.value="",d.value=[],m("update:modelValue",""),m("update:notes",""),m("update:images",[]),m("hapus",I),g.value=!1};return(I,A)=>{var P,u,_;return o(),n("div",Ls,[!a.modelValue&&d.value.length===0&&!r.value?(o(),n("div",Bs,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:D},A[4]||(A[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(o(),n("div",Ps,[e("div",{class:"flex justify-between items-start"},[A[5]||(A[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:D,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),d.value.length>0?(o(),n("div",Ds,[e("div",As,[(o(!0),n(re,null,ue(d.value,(R,X)=>(o(),n("div",{key:X,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:M(R),class:"w-full h-full object-cover rounded"},null,8,Rs),X===3&&d.value.length>4?(o(),n("span",Fs," +"+T(d.value.length-4),1)):h("",!0)]))),128))])])):h("",!0),e("div",{class:G(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(o(!0),n(re,null,ue(a.options,(R,X)=>(o(),n("label",{key:X,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+a.pointId,value:R.value,checked:a.modelValue===R.value,disabled:!0,class:"hidden peer"},null,8,qs),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":a.modelValue===R.value,"border-gray-300 text-gray-700 hover:bg-gray-50":a.modelValue!==R.value}])},T(R.label),3)]))),128))],2),r.value&&((P=v.value.settings)!=null&&P.show_textarea)?(o(),n("div",zs,[e("p",Es,T(r.value),1)])):h("",!0)])),g.value?(o(),Ie(Le,{key:(u=a.selectedPoint)==null?void 0:u.id,show:g.value,title:a.pointName||"Detail",subtitle:(_=v.value)==null?void 0:_.description,name:"modal-radio-"+a.pointId,options:a.options,"selected-value":y.value,"notes-value":i.value,"images-value":s.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":A[0]||(A[0]=R=>y.value=R),"onUpdate:notesValue":A[1]||(A[1]=R=>i.value=R),"onUpdate:imagesValue":A[2]||(A[2]=R=>b(R)),onClose:L,onSave:N,onHapus:A[3]||(A[3]=R=>z(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):h("",!0),a.error?(o(),n("p",Hs,T(a.error),1)):h("",!0)])}}},Os={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Ws={class:"p-4 space-y-4-6"},Zs={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Ks=["value"],Gs={class:"p-4 space-y-4-6"},Xs={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Ys=["value"],Js={key:0,class:"p-4 space-y-4"},Qs={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},eo=["value"],to={class:"p-4 space-y-2"},ao={class:"flex gap-1 mb-2 p-2 bg-gray-100 rounded-md"},so={class:"text-xs mt-1 text-gray-500"},oo={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0}},setup(a){const F=a,t=x(null),m=x(!1);x("");const r=x(""),d=`inspection-${F.inspectionId}-note`,g=P=>{if(!P)return{};if(typeof P=="string")try{return JSON.parse(P)||{}}catch(u){return console.error("Error parsing settings JSON:",u),{}}return typeof P=="object"&&P!==null?P:{}},i=Z(()=>g(F.inspection.settings).conclusion||{}),s=x({flooded:i.value.flooded||"",collision:i.value.collision||"",collision_severity:i.value.collision_severity||"",conclusion_note:""}),y=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],f=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],v=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];$e(()=>{A();const P=localStorage.getItem(d);P?s.value.conclusion_note=P:F.inspection.notes&&(s.value.conclusion_note=F.inspection.notes),Ae(()=>{M()})});const M=()=>{t.value&&s.value.conclusion_note&&(t.value.innerHTML=s.value.conclusion_note)},D=Se.debounce(()=>{if(t.value){const P=window.getSelection();P.rangeCount>0&&P.getRangeAt(0),s.value.conclusion_note=t.value.innerHTML,localStorage.setItem(d,s.value.conclusion_note),I()}},500),L=P=>{P.preventDefault(),document.execCommand("insertParagraph",!1,null)},b=P=>{P.preventDefault();const u=(P.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,u)},N=P=>{if(!t.value)return;t.value.focus();const u=window.getSelection();switch(u.rangeCount>0&&u.getRangeAt(0),P){case"bold":document.execCommand("bold");break;case"italic":document.execCommand("italic");break;case"underline":document.execCommand("underline");break}D()},z=()=>{m.value=!1,t.value&&(s.value.conclusion_note=t.value.innerHTML,localStorage.setItem(d,s.value.conclusion_note),I())},I=Se.debounce(()=>{const P={flooded:s.value.flooded,collision:s.value.collision,collision_severity:s.value.collision==="yes"?s.value.collision_severity:null,conclusion_note:s.value.conclusion_note};Re.post(route("inspections.updateConclusion",F.inspectionId),P,{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{localStorage.removeItem(d),r.value="⏳ Tersimpan"}})},500);de([()=>s.value.flooded,()=>s.value.collision,()=>s.value.collision_severity],()=>{I()});const A=()=>{const u=g(F.inspection.settings).conclusion||{};s.value.flooded=u.flooded||"",s.value.collision=u.collision||"",s.value.collision_severity=u.collision_severity||""};return(P,u)=>(o(),n("div",Os,[u[18]||(u[18]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b"},[e("h3",{class:"text-xl font-semibold text-indigo-700"},"Kesimpulan Inspeksi")],-1)),e("div",Ws,[u[11]||(u[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ae(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Zs,[(o(),n(re,null,ue(y,_=>e("label",{key:_.value,class:"cursor-pointer"},[ve(e("input",{type:"radio","onUpdate:modelValue":u[0]||(u[0]=R=>s.value.flooded=R),value:_.value,class:"hidden peer",onChange:u[1]||(u[1]=(...R)=>oe(I)&&oe(I)(...R))},null,40,Ks),[[Ve,s.value.flooded]]),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":s.value.flooded===_.value,"border-gray-300 text-gray-700 hover:bg-gray-50":s.value.flooded!==_.value}])},T(_.label),3)])),64))])]),e("div",Gs,[u[13]||(u[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ae(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Xs,[(o(),n(re,null,ue(f,_=>e("label",{key:_.value,class:"cursor-pointer"},[ve(e("input",{type:"radio","onUpdate:modelValue":u[2]||(u[2]=R=>s.value.collision=R),value:_.value,class:"hidden peer",onChange:u[3]||(u[3]=(...R)=>oe(I)&&oe(I)(...R))},null,40,Ys),[[Ve,s.value.collision]]),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":s.value.collision===_.value,"border-gray-300 text-gray-700 hover:bg-gray-50":s.value.collision!==_.value}])},T(_.label),3)])),64))]),s.value.collision==="yes"?(o(),n("div",Js,[u[12]||(u[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ae("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Qs,[(o(),n(re,null,ue(v,_=>e("label",{key:_.value,class:"cursor-pointer"},[ve(e("input",{type:"radio","onUpdate:modelValue":u[4]||(u[4]=R=>s.value.collision_severity=R),value:_.value,class:"hidden peer",onChange:u[5]||(u[5]=(...R)=>oe(I)&&oe(I)(...R))},null,40,eo),[[Ve,s.value.collision_severity]]),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":s.value.collision_severity===_.value,"border-gray-300 text-gray-700 hover:bg-gray-50":s.value.collision_severity!==_.value}])},T(_.label),3)])),64))])])):h("",!0)]),e("div",to,[u[17]||(u[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catatan Kesimpulan",-1)),e("div",ao,[e("button",{type:"button",onClick:u[6]||(u[6]=_=>N("bold")),class:"p-2 rounded hover:bg-gray-200 transition-colors",title:"Bold"},u[14]||(u[14]=[e("strong",null,"B",-1)])),e("button",{type:"button",onClick:u[7]||(u[7]=_=>N("italic")),class:"p-2 rounded hover:bg-gray-200 transition-colors",title:"Italic"},u[15]||(u[15]=[e("em",null,"I",-1)])),e("button",{type:"button",onClick:u[8]||(u[8]=_=>N("underline")),class:"p-2 rounded hover:bg-gray-200 transition-colors",title:"Underline"},u[16]||(u[16]=[e("u",null,"U",-1)]))]),e("div",{ref_key:"editorRef",ref:t,contenteditable:"true",class:G(["w-full min-h-[120px] p-2 rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 prose max-w-none",{"bg-white":!m.value,"bg-blue-50":m.value}]),onInput:u[9]||(u[9]=(..._)=>oe(D)&&oe(D)(..._)),onBlur:z,onFocus:u[10]||(u[10]=_=>m.value=!0),onKeydown:Fe(L,["enter"]),onPaste:b,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34),e("p",so,T(r.value),1)])]))}},ho=pe(oo,[["__scopeId","data-v-819ad3a0"]]);function fo(a,F){const t=x({x:F.x,y:F.y}),m=x(!1),r=x(null),d=x(!1);return $e(()=>{const v=localStorage.getItem(a);v&&(t.value=JSON.parse(v))}),{pos:t,dragging:m,startLongPress:v=>{v.preventDefault(),r.value=setTimeout(()=>{d.value=!0,m.value=!0,v.type.includes("touch")?(t.value.x=v.touches[0].clientX-24,t.value.y=v.touches[0].clientY-24):(t.value.x=v.clientX-24,t.value.y=v.clientY-24)},500)},cancelLongPress:()=>{clearTimeout(r.value),d.value=!1,m.value||(r.value=null)},onDrag:v=>{!m.value||!d.value||(v.preventDefault(),v.type.includes("touch")?(t.value.x=v.touches[0].clientX-24,t.value.y=v.touches[0].clientY-24):(t.value.x=v.clientX-24,t.value.y=v.clientY-24))},stopDrag:()=>{m.value&&(m.value=!1,d.value=!1,clearTimeout(r.value),r.value=null,localStorage.setItem(a,JSON.stringify(t.value)))},handleClick:v=>!m.value&&!d.value}}export{os as B,ho as C,je as I,mo as V,St as _,Bt as a,Ut as b,Ht as c,go as d,po as e,vo as f,Le as g,fo as u};
