import{x as T,d as p,k as w,z as U,m as j,c as z,o as d,w as D,b as q,a as s,e as i,f,u as l,t as n,p as m,v as y,F as C,h as I,A as F,s as L,n as $}from"./app-DKBrlfM2.js";import{l as E}from"./lodash-B6zFz3nX.js";import{A as H}from"./AppLayout-BRpFpQGQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"space-y-6 bg-white rounded-xl shadow-md p-6"},J={key:0,class:"mb-4 text-sm text-red-600 bg-red-100 p-3 rounded-md"},P={class:"mb-6"},Q={class:"mb-6"},W={class:"relative"},G={key:0,class:"absolute right-3 top-3"},O={key:1,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},R=["onMousedown"],X={class:"font-medium text-gray-900"},Y={class:"text-sm text-gray-500"},Z={key:0,class:"text-sm text-sky-600 mt-2"},ee={key:1,class:"text-sm text-indigo-600 mt-2"},te={class:"mb-6"},se=["value"],re={class:"mb-6 flex items-center justify-between"},oe={class:"relative inline-flex items-center cursor-pointer"},le={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"mt-6 flex justify-end"},de=["disabled"],me={__name:"Create",props:{CarDetail:Array,Category:Array},setup(x){const B=x,t=T({plate_number:"",car_id:null,car_name:"",category_id:"",is_scheduled:!1,scheduled_at_date:null,scheduled_at_time:null}),a=p(""),c=p(!1),v=p(!1),g=p([]),_=p(null),M=w(()=>!t.plate_number.trim()||!t.category_id||!t.car_id&&!a.value.trim()?!1:t.is_scheduled?t.scheduled_at_date&&t.scheduled_at_time:!0),V=w(()=>t.is_scheduled?"Buat Jadwal":"Mulai Inspeksi"),b=o=>{var u,r,h;if(!o)return"";const e=[];return(u=o.brand)!=null&&u.name&&e.push(o.brand.name),(r=o.model)!=null&&r.name&&e.push(o.model.name),(h=o.type)!=null&&h.name&&e.push(o.type.name),o.year&&e.push(o.year.toString()),e.join(" ")},k=E.debounce(()=>{if(!a.value.trim()){g.value=[],c.value=!1;return}v.value=!0;const o=a.value.toLowerCase().trim();g.value=B.CarDetail.filter(e=>b(e).toLowerCase().includes(o)),c.value=!0,v.value=!1},300),S=()=>{setTimeout(()=>{c.value=!1},200)},N=o=>{_.value=o,a.value=b(o),t.car_id=o.id,t.car_name="",c.value=!1};U(a,o=>{(!_.value||b(_.value)!==o)&&(t.car_id=null,t.car_name=o)});const A=()=>{const o={plate_number:t.plate_number,category_id:t.category_id,is_scheduled:t.is_scheduled};t.is_scheduled&&(o.scheduled_at=`${t.scheduled_at_date} ${t.scheduled_at_time}`),t.car_id?o.car_id=t.car_id:o.car_name=a.value,t.post(route("inspections.store"),{preserveScroll:!0,onSuccess:e=>{if(o.is_scheduled)console.log("Inspeksi berhasil dijadwalkan.");else{const u=e.props.flash.newInspectionId;u?window.location.href=route("inspections.start",u):console.error("Tidak ada ID inspeksi baru yang dikembalikan.")}},onError:()=>{}})};return(o,e)=>{const u=j("Head");return d(),z(H,null,{default:D(()=>[q(u,{title:"Inspek Baru"}),s("div",K,[e[17]||(e[17]=s("div",{class:"mb-4"},[s("h3",{class:"text-xl md:text-3xl font-bold text-gray-900 mb-6 text-center"},"Buat Inspeksi Baru"),s("p",{class:"text-gray-600"},"Isi detail kendaraan dan jadwal untuk memulai inspeksi.")],-1)),l(t).errors.form_error?(d(),i("div",J,n(l(t).errors.form_error),1)):f("",!0),s("div",P,[e[8]||(e[8]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nomor Plat Kendaraan ",-1)),m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l(t).plate_number=r),type:"text",placeholder:"Contoh: B 1234 ABC",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"},null,512),[[y,l(t).plate_number]])]),s("div",Q,[e[10]||(e[10]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nama Mobil ",-1)),s("div",W,[m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>a.value=r),type:"text",placeholder:"Cari atau ketik nama mobil...",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",onInput:e[2]||(e[2]=(...r)=>l(k)&&l(k)(...r)),onFocus:e[3]||(e[3]=r=>c.value=!0),onBlur:S},null,544),[[y,a.value]]),v.value?(d(),i("div",G,e[9]||(e[9]=[s("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):f("",!0),c.value&&g.value.length>0?(d(),i("div",O,[(d(!0),i(C,null,I(g.value,r=>(d(),i("div",{key:r.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:h=>N(r)},[s("div",X,n(b(r)),1),s("div",Y,n(r.year)+" • "+n(r.cc)+"cc • "+n(r.transmission)+" • "+n(r.fuel_type),1)],40,R))),128))])):f("",!0)]),l(t).car_id?(d(),i("div",Z," ✓ Mobil terpilih: "+n(a.value),1)):a.value.trim()?(d(),i("div",ee," ℹ Mobil baru akan dibuat: "+n(a.value),1)):f("",!0)]),s("div",te,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"category"}," Kategori Inspeksi ",-1)),m(s("select",{id:"category","onUpdate:modelValue":e[4]||(e[4]=r=>l(t).category_id=r),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},[e[11]||(e[11]=s("option",{value:"",disabled:""},"Pilih Kategori",-1)),(d(!0),i(C,null,I(x.Category,r=>(d(),i("option",{key:r.id,value:r.id},n(r.name),9,se))),128))],512),[[F,l(t).category_id]])]),s("div",re,[e[14]||(e[14]=s("label",{for:"schedule-toggle",class:"text-sm font-medium text-gray-700"},"Jadwalkan Inspeksi?",-1)),s("label",oe,[m(s("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=r=>l(t).is_scheduled=r),id:"schedule-toggle",class:"sr-only peer"},null,512),[[L,l(t).is_scheduled]]),e[13]||(e[13]=s("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-700"},null,-1))])]),l(t).is_scheduled?(d(),i("div",le,[s("div",null,[e[15]||(e[15]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"schedule-date"}," Tanggal ",-1)),m(s("input",{type:"date",id:"schedule-date","onUpdate:modelValue":e[6]||(e[6]=r=>l(t).scheduled_at_date=r),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},null,512),[[y,l(t).scheduled_at_date]])]),s("div",null,[e[16]||(e[16]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"schedule-time"}," Waktu ",-1)),m(s("input",{type:"time",id:"schedule-time","onUpdate:modelValue":e[7]||(e[7]=r=>l(t).scheduled_at_time=r),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},null,512),[[y,l(t).scheduled_at_time]])])])):f("",!0),s("div",ae,[s("button",{onClick:A,disabled:!M.value||l(t).processing,class:$({"px-6 py-3 rounded-md text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed":!0,"bg-gradient-to-r from-indigo-700 to-sky-600  border border-transparent text-white hover:bg-blue-700":!l(t).is_scheduled,"bg-gradient-to-r from-green-700 to-indigo-600  border-transparent text-white hover:bg-green-700":l(t).is_scheduled})},n(V.value),11,de)])])]),_:1})}}};export{me as default};
