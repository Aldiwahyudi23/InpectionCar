import{x as Be,r as y,g as $e,q as Z,E as Me,G as de,c as n,o,d as e,b as p,k as ie,z as ve,A as be,n as G,t as j,u as oe,e as Pe,F as re,m as ue,f as ae,y as ke,w as xe,L as we,a as Ue,j as Ie,l as Te,T as De,D as Re,W as Ae,J as Ve,B as Fe}from"./vendor-CV8_PVEu.js";import{l as Se}from"./lodash-BRlxIpe8.js";import{_ as qe}from"./PrimaryButton-Dgy-kueV.js";import{_ as Ee}from"./ActionMessage-Dm4wSOXc.js";import{_ as pe}from"./app-D0SLJKXY.js";import{_ as ze}from"./InputNumber-BcABGAJA.js";const He={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Oe={key:0,class:"p-4 space-y-2"},We={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ze={class:"flex items-center space-x-2"},Ke={key:0,class:"text-xs text-red-500 font-normal ml-2"},Ge={key:1,class:"text-xs text-red-500 font-normal ml-2"},Xe={key:2,class:"text-xs text-green-500 font-normal ml-2"},Ye={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Je={class:"relative"},Qe={key:0,class:"absolute right-3 top-3"},et={key:1,class:"text-xs text-red-500 font-normal ml-2"},tt={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},at={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},st={key:0},ot=["onMousedown"],nt={class:"font-medium text-gray-900"},lt={class:"text-sm text-gray-500"},it={key:1,class:"p-4 text-sm text-gray-500 text-center"},rt={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ut={key:0,class:"mb-4"},dt=["innerHTML"],ct={key:1},mt={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},vt=["onClick"],gt=["src","alt"],pt={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},ht={class:"text-white text-xs text-center"},ft={key:2,class:"text-center py-4 text-gray-500 text-sm"},bt={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},wt=["src","alt"],xt={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},yt={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},kt={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},$t={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges"],setup(t,{emit:F}){var me,he,fe,ye,_e,Ne;const a=t,m=F,d=Be({plate_number:((me=a.inspection)==null?void 0:me.plate_number)||"",car_id:((he=a.inspection)==null?void 0:he.car_id)||null,car_name:((fe=a.inspection)==null?void 0:fe.car_name)||""}),r=y(((ye=a.inspection)==null?void 0:ye.plate_number)||""),v=y(((_e=a.inspection)==null?void 0:_e.car_id)||null),i=y(((Ne=a.inspection)==null?void 0:Ne.car_name)||""),s=y(""),k=y(""),h=y(""),x=y(!1),b=y(""),L=y(""),U=y(d.car_name),f=y(!1),N=y(!1),E=y([]),C=y(null),R=y([]),D=y(!1),u=y(0);$e(()=>{var $,g,K,P,J;if(_(($=a.inspection)==null?void 0:$.plate_number),(g=a.inspection)!=null&&g.car_id&&((K=a.CarDetail)==null?void 0:K.length)>0){const te=a.CarDetail.find(se=>se.id===a.inspection.car_id);te&&c(te)}else!((P=a.inspection)!=null&&P.car_id)&&((J=a.inspection)!=null&&J.car_name)&&(U.value=a.inspection.car_name,d.car_id=null);window.addEventListener("keydown",O),m("update:hasUnsavedChanges",le.value),m("update:validation",Q.value)}),Me(()=>{window.removeEventListener("keydown",O)});const _=$=>{if(!$){s.value="",k.value="",h.value="";return}const g=$.toUpperCase().trim(),K=g.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(K)s.value=K[1]||"",k.value=K[2]||"",h.value=K[3]||"";else{let P="area",J="",te="",se="";for(const ee of g)P==="area"&&/[A-Z]/.test(ee)?J+=ee:P==="area"&&/[0-9]/.test(ee)?(P="number",te+=ee):P==="number"&&/[0-9]/.test(ee)?te+=ee:P==="number"&&/[A-Z]/.test(ee)?(P="suffix",se+=ee):P==="suffix"&&/[A-Z]/.test(ee)&&(se+=ee);s.value=J,k.value=te,h.value=se}A()},A=()=>{const $=`${s.value}${k.value}${h.value}`;d.plate_number=$,W()},X=$=>{$==="area"?s.value=s.value.toUpperCase().replace(/[^A-Z]/g,""):$==="number"?k.value=k.value.replace(/[^0-9]/g,""):$==="suffix"&&(h.value=h.value.toUpperCase().replace(/[^A-Z]/g,"")),A()},Y=Z(()=>{const $=d.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test($)}),ne=Z(()=>!U.value||U.value.trim()===""),H=Z(()=>d.plate_number.length>0&&!Y.value?"Format plat nomor tidak valid.":null),Q=Z(()=>{const $=!d.plate_number||d.plate_number.trim()==="",g=!U.value||U.value.trim()==="";return $||g||!Y.value||x.value}),le=Z(()=>{const $=d.plate_number!==r.value,g=d.car_id!==v.value||U.value!==i.value;return $||g}),ce=Z(()=>le.value&&!Q.value),V=$=>{var K,P,J;if(!$)return"";const g=[];return(K=$.brand)!=null&&K.name&&g.push($.brand.name),(P=$.model)!=null&&P.name&&g.push($.model.name),(J=$.type)!=null&&J.name&&g.push($.type.name),$.cc&&g.push(($.cc/1e3).toFixed(1)),$.transmission&&g.push($.transmission),$.year&&g.push($.year.toString()),$.fuel_type&&g.push($.fuel_type),$.production_period&&g.push(`(${$.production_period})`),g.join(" ")},T=()=>{d.car_id&&(d.car_id=null,C.value=null,R.value=[]),l()},l=Se.debounce(()=>{if(!U.value.trim()){E.value=[],f.value=!1;return}N.value=!0;try{const $=U.value.toLowerCase().trim();E.value=a.CarDetail.filter(g=>V(g).toLowerCase().includes($)),f.value=!0}finally{N.value=!1}},300),w=()=>{setTimeout(()=>{f.value=!1,d.car_name=U.value,W()},200)},c=async $=>{C.value=$,U.value=V($),d.car_id=$.id,d.car_name=V($),f.value=!1,await I($.id),W(),m("update:hasUnsavedChanges",le.value),m("update:validation",Q.value)},B=$=>!$||!$.file_path?"":`/storage/${$.file_path}`,I=async $=>{try{const g=await fetch(`/api/cars/${$}/images`);if(g.ok){const K=await g.json();R.value=Array.isArray(K)?K:[]}else R.value=[]}catch(g){console.error("Error loading car images:",g),R.value=[]}},z=$=>{u.value=$,D.value=!0,document.body.style.overflow="hidden"},S=()=>{D.value=!1,document.body.style.overflow=""},M=()=>{u.value=(u.value+1)%R.value.length},q=()=>{u.value=(u.value-1+R.value.length)%R.value.length},O=$=>{if(D.value)switch($.key){case"Escape":S();break;case"ArrowRight":M();break;case"ArrowLeft":q();break}},W=()=>{const $={plate_number:d.plate_number,car_id:d.car_id,car_name:d.car_name};m("update-vehicle",$)},ge=()=>{a.inspection&&d.post(route("inspections.updateVehicleDetails",{inspection:a.inspection.id}),{preserveScroll:!0,onSuccess:()=>{r.value=d.plate_number,v.value=d.car_id,i.value=d.car_name,m("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:$=>{console.error("Gagal menyimpan data:",$)}})};return de([()=>d.plate_number,()=>d.car_name],$=>{b.value="",x.value=!1,L.value="";const g=$[0];if(g&&g.length>=6){const K=a.allInspections.filter(P=>{var J;return P.plate_number===g&&P.id!==((J=a.inspection)==null?void 0:J.id)});if(K.length>0){const P=["draft","in_progress","pending","pending_review","revision"],J=K.find(te=>P.includes(te.status));if(J)x.value=!0,b.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${J.status.replace(/_/g," ").toUpperCase()}.`;else{const te=K.filter(se=>["approved","rejected","completed","cancelled"].includes(se.status));if(te.length>0){te.sort((ee,Ce)=>new Date(Ce.created_at)-new Date(ee.created_at));const se=te[0];if(se.car_id){const ee=a.CarDetail.find(Ce=>Ce.id===se.car_id);ee&&c(ee)}else se.car_name&&(U.value=se.car_name,d.car_name=se.car_name,d.car_id=null);L.value=`Nomor plat ini sudah pernah diperiksa ${te.length} kali sebelumnya.`}}}}m("update:hasUnsavedChanges",le.value),m("update:validation",Q.value)},{deep:!0}),($,g)=>{var K;return o(),n("div",He,[g[21]||(g[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b"},[e("h3",{class:"text-xl font-semibold text-indigo-700"},"Detail Kendaraan")],-1)),t.inspection?(o(),n("div",Oe,[e("div",We,[g[9]||(g[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",Ze,[ve(e("input",{"onUpdate:modelValue":g[0]||(g[0]=P=>s.value=P),type:"text",placeholder:"Contoh: B",class:G(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!Y.value||x.value}]),onInput:g[1]||(g[1]=P=>X("area")),maxlength:"2"},null,34),[[be,s.value]]),ve(e("input",{"onUpdate:modelValue":g[2]||(g[2]=P=>k.value=P),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:G(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!Y.value||x.value}]),onInput:g[3]||(g[3]=P=>X("number")),maxlength:"4"},null,34),[[be,k.value]]),ve(e("input",{"onUpdate:modelValue":g[4]||(g[4]=P=>h.value=P),type:"text",placeholder:"ABC",class:G(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!Y.value||x.value}]),onInput:g[5]||(g[5]=P=>X("suffix")),maxlength:"3"},null,34),[[be,h.value]])]),H.value?(o(),n("span",Ke,j(H.value),1)):p("",!0),b.value?(o(),n("span",Ge,j(b.value),1)):p("",!0),L.value?(o(),n("span",Xe,j(L.value),1)):p("",!0)]),e("div",Ye,[g[13]||(g[13]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",Je,[ve(e("input",{"onUpdate:modelValue":g[6]||(g[6]=P=>U.value=P),type:"text",placeholder:"Cari atau ketik nama mobil...",class:G(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ne.value}]),onInput:T,onFocus:g[7]||(g[7]=P=>f.value=!0),onBlur:w},null,34),[[be,U.value]]),N.value?(o(),n("div",Qe,g[10]||(g[10]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):p("",!0),ne.value?(o(),n("span",et,"Nama mobil tidak boleh kosong.")):p("",!0),!oe(d).car_id&&U.value?(o(),n("div",tt,g[11]||(g[11]=[Pe('<div class="flex items-start" data-v-a6c054b9><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-a6c054b9><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-a6c054b9></path></svg><div data-v-a6c054b9><p class="text-yellow-800 font-medium mb-1" data-v-a6c054b9>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-a6c054b9> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-a6c054b9>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-a6c054b9> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-a6c054b9> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-a6c054b9>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-a6c054b9>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):p("",!0),f.value?(o(),n("div",at,[E.value.length>0?(o(),n("div",st,[(o(!0),n(re,null,ue(E.value,P=>(o(),n("div",{key:P.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:J=>c(P)},[e("div",nt,j(V(P)),1),e("div",lt,j(P.year)+" • "+j(P.cc)+"cc • "+j(P.transmission)+" • "+j(P.fuel_type),1)],40,ot))),128))])):(o(),n("div",it,g[12]||(g[12]=[ae(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),ae(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):p("",!0)])]),oe(d).car_id&&C.value?(o(),n("div",rt,[C.value.description?(o(),n("div",ut,[g[14]||(g[14]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:C.value.description},null,8,dt)])):p("",!0),R.value.length>0?(o(),n("div",ct,[g[15]||(g[15]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",mt,[(o(!0),n(re,null,ue(R.value,(P,J)=>(o(),n("div",{key:P.id||J,class:"relative group cursor-pointer",onClick:te=>z(J)},[e("img",{src:B(P),alt:P.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,gt),P.note?(o(),n("div",pt,[e("p",ht,j(P.note),1)])):p("",!0)],8,vt))),128))])])):(o(),n("div",ft," Tidak ada gambar tersedia untuk mobil ini "))])):p("",!0),D.value?(o(),n("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:S},[e("div",bt,[e("button",{onClick:S,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},g[16]||(g[16]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),R.value.length>1?(o(),n("button",{key:0,onClick:ke(q,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},g[17]||(g[17]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):p("",!0),R.value.length>1?(o(),n("button",{key:1,onClick:ke(M,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},g[18]||(g[18]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):p("",!0),e("img",{src:B(R.value[u.value]),alt:"Car Image "+(u.value+1),class:"max-w-full max-h-full object-contain",onClick:g[8]||(g[8]=ke(()=>{},["stop"]))},null,8,wt),R.value.length>1?(o(),n("div",xt,j(u.value+1)+" / "+j(R.value.length),1)):p("",!0),(K=R.value[u.value])!=null&&K.note?(o(),n("div",yt,j(R.value[u.value].note),1)):p("",!0)])])):p("",!0),ie(qe,{type:"button",onClick:ge,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!ce.value},{default:xe(()=>[oe(d).processing?(o(),n("svg",kt,g[19]||(g[19]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):p("",!0),e("span",null,j(oe(d).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),ie(Ee,{on:oe(d).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:xe(()=>g[20]||(g[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),ae(" Tersimpan. ")])),_:1,__:[20]},8,["on"])]),_:1},8,["disabled"])])):p("",!0)])}}},mo=pe($t,[["__scopeId","data-v-a6c054b9"]]),It={class:"mt-1"},Ct=["value","required","minlength","maxlength","allowSpace","placeholder"],Vt={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(t,{emit:F}){const a=t,m=F,d=Z(()=>{if(!a.modelValue)return"";let v=a.modelValue;switch(a.allowSpace||(v=v.replace(/\s+/g,"")),a.textTransform){case"uppercase":return v.toUpperCase();case"lowercase":return v.toLowerCase();case"capitalize":return v.replace(/\b\w/g,i=>i.toUpperCase());default:return v}}),r=v=>{let i=v.target.value;switch(a.allowSpace||(i=i.replace(/\s+/g,"")),a.textTransform){case"uppercase":i=i.toUpperCase();break;case"lowercase":i=i.toLowerCase();break;case"capitalize":i=i.replace(/\b\w/g,s=>s.toUpperCase());break}m("update:modelValue",i),m("save",a.pointId)};return(v,i)=>(o(),n("div",It,[e("input",{value:d.value,onInput:r,type:"text",required:t.required,minlength:t.minLength,maxlength:t.maxLength,allowSpace:t.allowSpace,placeholder:t.placeholder,class:G(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:t.textTransform==="uppercase",lowercase:t.textTransform==="lowercase",capitalize:t.textTransform==="capitalize"}])},null,42,Ct),t.error?(o(),n("p",Vt,j(t.error),1)):p("",!0)]))}},Mt={class:"mt-1"},_t=["value","required","min","max"],Nt={key:0,class:"mt-2 text-sm text-red-600"},Ut={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:F}){const a=t,m=F,d=r=>{m("update:modelValue",r.target.value),m("save",a.pointId)};return(r,v)=>(o(),n("div",Mt,[e("input",{value:t.modelValue,onChange:d,type:"date",required:t.required,min:t.minDate,max:t.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,_t),t.error?(o(),n("p",Nt,j(t.error),1)):p("",!0)]))}},Tt={class:"mt-1"},jt=["value","required","placeholder"],Lt={key:0,class:"mt-2 text-sm text-red-600"},Bt={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(t,{emit:F}){const a=t,m=F,d=y(""),r=Z(()=>{var h,x,b,L;return{currency_symbol:((h=a.settings)==null?void 0:h.currency_symbol)||"Rp",thousands_separator:((x=a.settings)==null?void 0:x.thousands_separator)||",",min_value:((b=a.settings)==null?void 0:b.min_value)!==void 0?Number(a.settings.min_value):0,max_value:((L=a.settings)==null?void 0:L.max_value)!==void 0?Number(a.settings.max_value):1e9}}),v=h=>{if(h==null||h==="")return"";const x=Number(h);if(isNaN(x))return"";let b=x.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return r.value.thousands_separator!==","&&(b=b.replace(/,/g,r.value.thousands_separator)),b},i=h=>h?h.replace(/[^\d]/g,""):"",s=Z(()=>d.value?`${r.value.currency_symbol} ${v(d.value)}`:""),k=h=>{let x=i(h.target.value),b=Number(x);r.value.min_value!==void 0&&b<r.value.min_value&&(x=r.value.min_value.toString()),r.value.max_value!==void 0&&b>r.value.max_value&&(x=r.value.max_value.toString()),d.value=x,m("update:modelValue",x),m("save",a.pointId)};return de(()=>a.modelValue,h=>{h!=null&&(d.value=h.toString())},{immediate:!0}),(h,x)=>(o(),n("div",Tt,[e("input",{value:s.value,onInput:k,type:"text",required:t.required,placeholder:t.placeholder,class:G(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",t.error?"border-red-300":"border-gray-300"])},null,42,jt),t.error?(o(),n("p",Lt,j(t.error),1)):p("",!0)]))}},Pt={class:"mt-1 space-y-3"},Dt={key:0,class:"space-y-2"},Rt={class:"flex flex-wrap gap-2"},At=["onClick"],Ft=["value","required","minlength","maxlength","placeholder"],qt={class:"flex justify-between items-center mt-1"},Et={class:"text-xs text-gray-500"},zt={key:0,class:"text-xs text-red-600"},Ht={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(t,{emit:F}){const a=t,m=F,d=y([]),r=y(""),v=h=>d.value.some(x=>x.value===h),i=h=>{v(h.value)?d.value=d.value.filter(U=>U.value!==h.value):d.value.push(h);const b=[...d.value.map(U=>U.value)];r.value.trim()&&b.push(r.value.trim());const L=b.join(", ");m("update:modelValue",L),m("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:L})},s=h=>{const x=h.target.value;m("update:modelValue",x),m("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:x}),k(x)},k=h=>{var U,f,N,E;if(!h){d.value=[],r.value="";return}const x=h.split(",").map(C=>C.trim()).filter(C=>C),b=((f=(U=a.settings)==null?void 0:U.damage_options)==null?void 0:f.map(C=>C.value))||[];d.value=((E=(N=a.settings)==null?void 0:N.damage_options)==null?void 0:E.filter(C=>x.includes(C.value)))||[];const L=x.filter(C=>!b.includes(C));r.value=L.join(", ")};return de(()=>a.modelValue,h=>{h!=null&&k(h)},{immediate:!0}),(h,x)=>{var b,L,U;return o(),n("div",Pt,[(b=t.settings)!=null&&b.enable_damage&&((L=t.settings)!=null&&L.damage_options)?(o(),n("div",Dt,[x[0]||(x[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",Rt,[(o(!0),n(re,null,ue(t.settings.damage_options,(f,N)=>(o(),n("button",{key:N,type:"button",onClick:E=>i(f),class:G(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":v(f.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!v(f.value)}])},j(f.label),11,At))),128))])])):p("",!0),e("div",null,[e("textarea",{value:t.modelValue,onInput:s,required:t.required,minlength:t.minLength,maxlength:t.maxLength,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ft),e("div",qt,[e("span",Et,j(((U=t.modelValue)==null?void 0:U.length)||0)+"/"+j(t.maxLength||400),1),t.error?(o(),n("p",zt,j(t.error),1)):p("",!0)])])])}}},Ot={class:"mt-1"},Wt=["value","required"],Zt={key:0,class:"mt-2 text-sm text-red-600"},Kt={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:F}){const a=t,m=F,d=r=>{m("update:modelValue",r.target.value),m("save",a.pointId)};return(r,v)=>(o(),n("div",Ot,[e("select",{value:t.modelValue,onChange:d,required:t.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},v[0]||(v[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Wt),t.error?(o(),n("p",Zt,j(t.error),1)):p("",!0)]))}},vo=pe(Kt,[["__scopeId","data-v-c34a74db"]]),Gt={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},Xt={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},Yt={class:"text-xs text-gray-500 mt-2 text-center"},Jt={class:"flex flex-row space-x-4 mb-6"},Qt={class:"mt-4 text-right"},ea={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(t){return(F,a)=>t.show?(o(),n("div",Gt,[e("div",Xt,[a[7]||(a[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",Yt,[a[3]||(a[3]=ae("Ambil Foto Maksimal: ")),e("b",null,j(t.settings.max_files),1),a[4]||(a[4]=ae(" Dengan Rasio & Ukuran: ")),e("b",null,j(t.settings.camera_aspect_ratio),1)]),e("div",Jt,[e("button",{onClick:a[0]||(a[0]=m=>F.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[5]||(a[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Kamera",-1)])),e("button",{onClick:a[1]||(a[1]=m=>F.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[6]||(a[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",Qt,[e("button",{onClick:a[2]||(a[2]=m=>F.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):p("",!0)}},ta={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},aa={class:"webcam-content-box"},sa={class:"webcam-header"},oa={class:"rounded-full text-white hover:bg-gray-700 transition-colors"},na={class:"inspection-point-name"},la={key:0,class:"screen-flash-overlay"},ia={key:2,class:"zoom-controls"},ra=["max"],ua={class:"webcam-footer"},da={class:"camera-controls"},ca=["disabled"],ma={class:"camera-icon-container"},va={key:0,class:"camera-spinner"},ga={key:1,class:"camera-body"},pa={__name:"WebcamModal",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(t,{emit:F}){const a=t,m=F,d=y(null),r=y(null);let v=null,i=null;const s=y("environment"),k=y(!1),h=y(!1),x=y(!1),b=y(!1),L=y(!1),U=y({}),f=y(!1),N=y(1),E=y(1),C=y(!1),R=Z(()=>{var V;return((V=a.settings)==null?void 0:V.max_size)||2048}),D=Z(()=>a.aspectRatio?{aspectRatio:`${a.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),u=Z(()=>{if(!a.aspectRatio)return{};const V=a.aspectRatio,T=V>1?80:60,l=V>1?80/V:60*V;return{width:`${T}%`,height:`${l}%`}}),_=async()=>{v&&v.getTracks().forEach(V=>V.stop());try{const V={facingMode:s.value,width:{ideal:4096},height:{ideal:2160},aspectRatio:{ideal:a.aspectRatio||1.3333333333333333},frameRate:{ideal:30},advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{whiteBalanceMode:"continuous"}]};v=await navigator.mediaDevices.getUserMedia({video:V,audio:!1}),i=v.getVideoTracks()[0],d.value.srcObject=v,d.value.onloadedmetadata=async()=>{await X(),await d.value.play()}}catch(V){console.error("Error accessing camera: ",V),alert("Failed to access camera. Please allow camera permission."),m("close")}},A=()=>{v&&v.getTracks().forEach(V=>V.stop()),m("close")},X=async()=>{if(i)try{const V=await navigator.mediaDevices.enumerateDevices();k.value=V.filter(l=>l.kind==="videoinput").length>1;const T=i.getCapabilities();T.zoom?(C.value=!0,E.value=T.zoom.max,console.log(`Zoom supported. Max zoom: ${E.value}`)):(C.value=!1,console.warn("Zoom is not supported by this camera.")),h.value=T.torch||T.fillLightMode&&T.fillLightMode.includes("torch")}catch(V){console.error("Error checking camera capabilities:",V)}},Y=async V=>{if(!i)return;const T=d.value.getBoundingClientRect(),l=V.clientX-T.left,w=V.clientY-T.top;L.value=!0,U.value={left:`${l}px`,top:`${w}px`,transform:"translate(-50%, -50%)"};try{if(i.getCapabilities().pointsOfInterest){const B=l/T.width,I=w/T.height;await i.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:B,y:I}]}]})}else console.warn("Manual focus with point of interest is not supported.")}catch(c){console.warn("Manual focus failed:",c)}setTimeout(()=>{L.value=!1,i.getCapabilities().focusMode.includes("continuous")&&i.applyConstraints({advanced:[{focusMode:"continuous"}]})},1e3)},ne=async V=>{if(!i||!C.value)return;const T=Math.min(Math.max(V,1),E.value);N.value=T;try{await i.applyConstraints({advanced:[{zoom:T}]})}catch(l){console.error("Failed to set zoom:",l)}},H=async()=>{if(!(!i||!h.value))try{s.value==="user"?(x.value=!x.value,b.value=x.value):(await i.applyConstraints({advanced:[{torch:!x.value}]}),x.value=!x.value)}catch(V){console.error("Flash toggle failed:",V)}},Q=async()=>{k.value&&(s.value=s.value==="environment"?"user":"environment",v&&v.getTracks().forEach(V=>V.stop()),await _())},le=async V=>new Promise(T=>{const l=R.value*1024;if(V.size<=l){T(V);return}const w=new Image,c=new FileReader;c.onload=B=>{w.onload=()=>{const I=document.createElement("canvas"),z=I.getContext("2d"),S=Math.sqrt(l/V.size);I.width=w.width*S,I.height=w.height*S,z.drawImage(w,0,0,I.width,I.height);let M=.9;const q=()=>{I.toBlob(O=>{O.size>l&&M>.1?(M-=.1,q()):T(O)},"image/jpeg",M)};q()},w.src=B.target.result},c.readAsDataURL(V)}),ce=async()=>{if(!(f.value||!d.value||!r.value)){f.value=!0;try{const V=d.value,T=r.value,l=V.videoWidth,w=V.videoHeight;let c,B,I,z;l/w>a.aspectRatio?(B=w,c=w*a.aspectRatio,I=(l-c)/2,z=0):(c=l,B=l/a.aspectRatio,I=0,z=(w-B)/2),T.width=c,T.height=B,T.getContext("2d").drawImage(V,I,z,c,B,0,0,c,B);const M=await new Promise(O=>{T.toBlob(O,"image/jpeg",1)}),q=await le(M);if(q){const O=new File([q],`capture_${Date.now()}.jpeg`,{type:"image/jpeg",lastModified:Date.now()});m("photoCaptured",O),b.value=!0,setTimeout(()=>{b.value=!1},100)}}catch(V){console.error("Error capturing photo:",V),alert("Failed to capture photo. Please try again.")}finally{f.value=!1}}};return de(()=>a.show,V=>{V?_():A()}),Me(()=>{v&&v.getTracks().forEach(V=>V.stop())}),(V,T)=>{var l;return t.show?(o(),n("div",ta,[e("div",aa,[e("div",sa,[e("p",oa,j(t.settings.camera_aspect_ratio),1),e("div",na,j(((l=t.point)==null?void 0:l.name)||"Camera"),1),e("button",{onClick:A,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},T[2]||(T[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:we(D.value),onClick:Y,onTouchstart:Y},[e("video",{ref_key:"webcamVideo",ref:d,autoplay:"",playsinline:"",class:"webcam-video"},null,512),e("canvas",{ref_key:"webcamCanvas",ref:r,class:"hidden"},null,512),b.value?(o(),n("div",la)):p("",!0),e("div",{class:"aspect-ratio-guide",style:we(u.value)},null,4),L.value?(o(),n("div",{key:1,class:"focus-indicator",style:we(U.value)},T[3]||(T[3]=[e("div",{class:"focus-ring"},null,-1)]),4)):p("",!0),T[4]||(T[4]=e("div",{class:"hd-badge"},[e("span",{class:"hd-text"},"HD")],-1)),C.value?(o(),n("div",ia,[ve(e("input",{type:"range",min:"1",max:E.value,step:"0.1","onUpdate:modelValue":T[0]||(T[0]=w=>N.value=w),onInput:T[1]||(T[1]=w=>ne(parseFloat(w.target.value))),class:"zoom-slider"},null,40,ra),[[be,N.value]])])):p("",!0)],36),e("div",ua,[e("div",da,[t.settings.enable_flash&&h.value?(o(),n("button",{key:0,onClick:H,class:G(["control-button",{active:x.value,disabled:!h.value}])},T[5]||(T[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):p("",!0),e("button",{onClick:ce,class:"capture-button",disabled:f.value},[e("div",ma,[f.value?(o(),n("div",va)):(o(),n("div",ga,T[6]||(T[6]=[e("div",{class:"camera-lens"},null,-1),e("div",{class:"camera-flash"},null,-1)])))])],8,ca),t.settings.enable_camera_switch&&k.value?(o(),n("button",{key:1,onClick:Q,class:"control-button"},T[7]||(T[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]))):p("",!0)])])])])):p("",!0)}}},ha=pe(pa,[["__scopeId","data-v-b94530cf"]]),fa={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ba={class:"w-full h-full flex flex-col"},wa={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},xa={class:"text-lg font-semibold"},ya={class:"flex items-center gap-2"},ka={class:"flex-1 flex items-center justify-center overflow-hidden relative"},$a=["src"],Ia={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},Ca={class:"flex justify-between items-center w-full"},Va=["disabled"],Sa={key:1,class:"flex-1"},Ma=["disabled"],_a={class:"flex gap-3 w-full"},Na={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium",disabled:""},Ua={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images"],setup(t,{emit:F}){const a=t,m=F,d=y(0),r=y([]),v=Z(()=>r.value.length>0?r.value[d.value]:null);de(()=>a.images,f=>{r.value=f.map(N=>({...N,rotation:N.rotation||0})),f.length===0&&a.show&&b()},{deep:!0,immediate:!0}),de(()=>a.show,f=>{f&&a.images.length>0&&(d.value=a.initialIndex)});const i=f=>f.preview||(f.image_path?`/${f.image_path}`:""),s=()=>{if(v.value){const f=(v.value.rotation+90)%360;r.value[d.value].rotation=f,m("update:images",r.value)}},k=()=>{d.value=d.value<r.value.length-1?d.value+1:0},h=()=>{d.value=d.value>0?d.value-1:r.value.length-1},x=()=>{a.isUploading||m("saveImages",r.value)},b=()=>{a.isUploading||m("close")},L=()=>{if(v.value&&!a.isUploading){const f=v.value,N=r.value.findIndex(E=>E.isNew&&f.isNew&&E.preview===f.preview||!E.isNew&&!f.isNew&&E.id===f.id);N!==-1&&(m("removePreviewImage",f),r.value.splice(N,1),m("update:images",r.value)),d.value>=r.value.length&&(d.value=Math.max(0,r.value.length-1)),r.value.length===0&&m("close")}},U=()=>{a.isUploading||m("triggerAddMorePhotos")};return(f,N)=>{var E;return t.show?(o(),n("div",fa,[e("div",ba,[e("div",wa,[e("button",{onClick:b,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors"},N[0]||(N[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("div",xa,j(((E=t.point)==null?void 0:E.name)||"Preview")+" ("+j(d.value+1)+"/"+j(r.value.length)+") ",1),e("div",ya,[v.value&&v.value.isNew?(o(),n("button",{key:0,onClick:L,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image"},N[1]||(N[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]))):p("",!0),v.value&&v.value.isNew?(o(),n("button",{key:1,onClick:s,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors"},N[2]||(N[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))):p("",!0)])]),e("div",ka,[e("div",{class:"relative w-full max-w-full",style:we({paddingTop:t.aspectRatio?100/t.aspectRatio+"%":"75%"})},[v.value?(o(),n("img",{key:0,src:i(v.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:we({transform:`rotate(${v.value.rotation}deg)`})},null,12,$a)):p("",!0)],4),r.value.length>1?(o(),n("button",{key:0,onClick:h,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors"},N[3]||(N[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):p("",!0),r.value.length>1?(o(),n("button",{key:1,onClick:k,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors"},N[4]||(N[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):p("",!0)]),e("div",Ia,[e("div",Ca,[v.value&&!v.value.isNew?(o(),n("button",{key:0,onClick:L,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:t.isUploading},N[5]||(N[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ae(" Hapus Foto ")]),8,Va)):(o(),n("div",Sa)),t.allowMultiple&&r.value.length<t.maxFiles?(o(),n("button",{key:2,onClick:U,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:t.isUploading},N[6]||(N[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ae(" Tambah Foto ")]),8,Ma)):p("",!0)]),e("div",_a,[t.isUploading?(o(),n("button",Na,N[7]||(N[7]=[ae(" Menyimpan"),e("span",{class:"loading-dots ml-1"},[e("span",null,"."),e("span",null,"."),e("span",null,".")],-1)]))):(o(),n("button",{key:0,onClick:x,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium"}," Simpan "))])])])])):p("",!0)}}},Ta=pe(Ua,[["__scopeId","data-v-41f87672"]]),ja=["accept","multiple","disabled"],La={class:"text-xs text-gray-500 mb-2"},Ba=["disabled"],Pa={class:"h-full flex flex-col items-center justify-center p-4 text-center"},Da={class:"text-xs text-gray-400 mt-1"},Ra={key:0,class:"flex items-center gap-4"},Aa=["src"],Fa=["disabled"],qa={key:1,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},Ea=["disabled"],za=["onClick"],Ha=["src"],Oa={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},Wa={key:0},Za={key:1,class:"ml-1"},Ka={key:2,class:"mt-1 text-xs text-red-600"},Ga={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded"],setup(t,{emit:F}){const a=t,m=F,d=y(null),r=y(null),v=y(!1),i=y(!1),s=y(!1),k=y([]),h=y(0),x=y(!1),b=Z(()=>Number(a.settings.max_files)>1),L=Z(()=>a.settings.allowed_types.map(l=>`.${l}`).join(", ")),U=Z(()=>{const l=a.settings.camera_aspect_ratio.split(":");if(l.length===2){const w=parseFloat(l[0]),c=parseFloat(l[1]);if(!isNaN(w)&&!isNaN(c)&&c!==0)return w/c}return 3/4}),f=Z(()=>{const l=[],w=new Set;for(const c of k.value)c.id&&w.add(c.id),l.push(c);for(const c of a.modelValue)w.has(c.id)||l.push({...c,rotation:c.rotation||0,isNew:!1,preview:c.preview||(c.image_path?`/${c.image_path}`:null)});return l}),N=l=>l.preview||(l.image_path?`/${l.image_path}`:""),E=()=>{s.value&&(s.value=!1),v.value=!0},C=()=>{v.value=!1,d.value.click()},R=()=>{v.value=!1,i.value=!0},D=()=>{v.value=!1,f.value.length>0&&(s.value=!0)},u=()=>{i.value=!1,f.value.length>0&&(s.value=!0)},_=()=>{s.value=!1,k.value.forEach(l=>{l.preview&&l.preview.startsWith("blob:")&&URL.revokeObjectURL(l.preview)}),k.value=[]},A=l=>new Promise(w=>{const c=new FileReader;c.onload=B=>{const I=new Image;I.onload=()=>{w({file:l,preview:URL.createObjectURL(l),rotation:0,width:I.naturalWidth,height:I.naturalHeight,isNew:!0})},I.onerror=()=>{console.error("Failed to load image for dimensions:",l.name),w({file:l,preview:URL.createObjectURL(l),rotation:0,width:0,height:0,isNew:!0})},I.src=B.target.result},c.readAsDataURL(l)}),X=l=>{const w=l.name.split(".").pop().toLowerCase();return a.settings.allowed_types.includes(w)},Y=async l=>{const c=(a.settings.max_size||2048)*1024;return new Promise(B=>{const I=new Image,z=new FileReader;z.onload=S=>{I.onload=()=>{const M=document.createElement("canvas"),q=M.getContext("2d"),O=Math.max(I.width,I.height);M.width=O,M.height=O,q.fillStyle="white",q.fillRect(0,0,O,O);const W=(O-I.width)/2,ge=(O-I.height)/2;q.drawImage(I,W,ge,I.width,I.height);let me=.9;const he=()=>{M.toBlob(fe=>{if(fe.size>c&&me>.1)me-=.1,he();else{const ye=new File([fe],l.name,{type:"image/jpeg",lastModified:Date.now()});B(ye)}},"image/jpeg",me)};he()},I.src=S.target.result},z.readAsDataURL(l)})},ne=async l=>{const w=Array.from(l.target.files);if(!w.length){v.value=!1,f.value.length>0&&(s.value=!0);return}try{const c=w.filter(q=>!X(q));if(c.length>0){const q=c.map(O=>O.name.split(".").pop()).join(", ");alert(`File type not allowed: ${q}. Allowed types: ${a.settings.allowed_types.join(", ")}`),l.target.value="";return}const B=f.value.length,I=a.settings.max_files-B,z=await Promise.all(w.slice(0,I).map(async q=>await Y(q))),S=await Promise.all(z.map(A)),M=b.value?S:S.slice(0,1);b.value?k.value.push(...M):(k.value.forEach(q=>{q.preview&&q.preview.startsWith("blob:")&&URL.revokeObjectURL(q.preview)}),k.value=M),v.value=!1,M.length>0?(h.value=Math.max(0,f.value.length-M.length),s.value=!0):f.value.length>0&&(s.value=!0),l.target.value=""}catch(c){console.error("Error processing selected images:",c),alert("Failed to process selected images. Please try again."),v.value=!1,f.value.length>0&&(s.value=!0)}},H=async l=>{const w=f.value.length;if(!b.value||w<a.settings.max_files)try{const c=await Y(l),B=new Image;B.onload=()=>{const I={file:c,preview:URL.createObjectURL(c),rotation:0,width:B.naturalWidth,height:B.naturalHeight,isNew:!0};b.value?k.value.push(I):(k.value.forEach(z=>{z.preview&&z.preview.startsWith("blob:")&&URL.revokeObjectURL(z.preview)}),k.value=[I]),i.value=!1,v.value=!1,h.value=f.value.length-1,s.value=!0},B.src=URL.createObjectURL(c)}catch(c){console.error("Error processing captured image:",c),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${a.settings.max_files} files allowed.`),i.value=!1,v.value=!1,f.value.length>0&&(s.value=!0)},Q=(l=0)=>{h.value=l,s.value=!0},le=l=>new Promise(w=>{if(l.rotation===0||!r.value){if(!l.isNew&&!l.file){w({file:null,width:l.width,height:l.height,isOriginal:!0});return}w({file:l.file,width:l.width,height:l.height});return}const c=new Image;c.onload=async()=>{try{const B=r.value,I=B.getContext("2d"),z=c.width,S=c.height;let M,q;l.rotation===90||l.rotation===270?(M=S,q=z):(M=z,q=S),B.width=M,B.height=q,I.clearRect(0,0,B.width,B.height),I.translate(B.width/2,B.height/2),I.rotate(l.rotation*Math.PI/180),I.drawImage(c,-z/2,-S/2,z,S),I.setTransform(1,0,0,1,0,0);const O=await new Promise(me=>{B.toBlob(me,"image/jpeg",.9)}),W=new File([O],l.file?l.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),ge=await Y(W);w({file:ge,width:M,height:q})}catch(B){console.error("Error processing rotated image:",B),w({file:l.file,width:l.width,height:l.height})}},c.onerror=()=>{console.error("Failed to load image for rotation processing:",l.preview),w({file:l.file,width:l.width,height:l.height})},c.src=l.preview}),ce=async l=>{var B,I,z,S;x.value=!0;const w=[],c=[];if(!a.pointId){alert("Error: Point ID is missing. Cannot upload image."),x.value=!1;return}try{for(const M of l){if(!M.isNew&&M.rotation===0&&M.id&&M.image_path){w.push({id:M.id,image_path:M.image_path,width:M.width,height:M.height,rotation:0,preview:M.preview});continue}const{file:q,width:O,height:W,isOriginal:ge}=await le(M);if(ge&&!M.isNew){w.push({id:M.id,image_path:M.image_path,width:M.width,height:M.height,rotation:0,preview:M.preview});continue}q&&c.push({file:q,width:O,height:W,rotation:0})}if(c.length>0){const M=new FormData;M.append("inspection_id",a.inspectionId),M.append("point_id",a.pointId),c.forEach(W=>{M.append("images[]",W.file)});const O=(await Ue.post(route("inspections.upload-image"),M,{headers:{"Content-Type":"multipart/form-data"}})).data.images;for(const W of O)w.push({id:W.image_id,image_path:W.path,width:W.width||0,height:W.height||0,rotation:W.rotation||0,preview:W.public_url});c.forEach(W=>{W.file&&W.file.preview&&W.file.preview.startsWith("blob:")&&URL.revokeObjectURL(W.file.preview)})}m("update:modelValue",w),m("save",a.pointId),m("uploaded",{pointId:a.pointId,images:w}),_()}catch(M){if(console.error("Error during image processing/upload:",M),(I=(B=M.response)==null?void 0:B.data)!=null&&I.message)alert(`Failed to save images: ${M.response.data.message}`);else if((S=(z=M.response)==null?void 0:z.data)!=null&&S.errors){const q=Object.values(M.response.data.errors).flat().join(`
`);alert(`Failed to save images:
${q}`)}else alert(`Failed to save images: ${M.message}`)}finally{x.value=!1}},V=l=>{if(l){if(l.id&&!l.isNew)T(l);else{const w=k.value.findIndex(c=>c.preview&&c.preview===l.preview&&c.isNew||c.id&&c.id===l.id);if(w!==-1){const c=k.value.splice(w,1)[0];c.preview&&c.preview.startsWith("blob:")&&URL.revokeObjectURL(c.preview)}m("update:modelValue",a.modelValue.filter(c=>!(c.id&&c.id===l.id)&&!(c.preview&&c.preview===l.preview)))}h.value>=f.value.length&&(h.value=Math.max(0,f.value.length-1)),f.value.length===0&&_()}},T=async l=>{var c,B;if(l.id||l.image_path)try{await Ue.delete(route("inspections.delete-image"),{data:{image_id:l.id,image_path:l.image_path}})}catch(I){console.error("Error deleting image from server:",I),(B=(c=I.response)==null?void 0:c.data)!=null&&B.message?alert(`Failed to delete image from server: ${I.response.data.message}`):alert(`Failed to delete image from server: ${I.message}`);return}l.preview&&l.preview.startsWith("blob:")&&URL.revokeObjectURL(l.preview);const w=a.modelValue.filter(I=>I.id!==l.id);m("update:modelValue",w),k.value=k.value.filter(I=>I.isNew&&l.isNew?I.preview!==l.preview:I.id!==l.id),m("removeImage",{image:l}),s.value&&f.value.length===0?_():s.value&&h.value>=f.value.length&&(h.value=Math.max(0,f.value.length-1))};return(l,w)=>(o(),n("div",null,[e("input",{ref_key:"galleryInput",ref:d,type:"file",accept:L.value,class:"hidden",onChange:ne,multiple:b.value,disabled:x.value},null,40,ja),e("canvas",{ref_key:"processingCanvas",ref:r,class:"hidden"},null,512),e("p",La,"Foto Maksimal: "+j(t.settings.max_files)+" | Rasio: "+j(t.settings.camera_aspect_ratio),1),f.value.length===0?(o(),n("label",{key:0,onClick:E,class:G(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:x.value},[e("div",Pa,[w[2]||(w[2]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),w[3]||(w[3]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",Da,"Tipe: "+j(L.value),1)])],8,Ba)):(o(),n("div",{key:1,class:G(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":t.settings.max_files==1,"bg-transparent":t.settings.max_files>1}]),"aria-label":"Image gallery"},[t.settings.max_files===1?(o(),n("div",Ra,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:w[0]||(w[0]=c=>Q(0))},[e("img",{src:N(f.value[0]),class:"w-full h-full object-cover"},null,8,Aa)]),e("button",{onClick:w[1]||(w[1]=ke(c=>T(f.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:x.value},w[4]||(w[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ae(" Hapus Foto ")]),8,Fa)])):(o(),n("div",qa,[b.value&&f.value.length<t.settings.max_files?(o(),n("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:E,disabled:x.value},w[5]||(w[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,Ea)):p("",!0),(o(!0),n(re,null,ue(f.value,(c,B)=>(o(),n("div",{key:c.id||c.preview,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:I=>Q(B)},[e("img",{src:N(c),class:"w-full h-full object-cover"},null,8,Ha),c.isNew||c.rotation!==0?(o(),n("div",Oa,[c.isNew?(o(),n("span",Wa,"BARU")):p("",!0),c.rotation!==0?(o(),n("span",Za,"ROTASI")):p("",!0)])):p("",!0)],8,za))),128))]))],2)),t.error?(o(),n("p",Ka,j(t.error),1)):p("",!0),ie(ea,{show:v.value,settings:t.settings,onClose:D,onOpenWebcam:R,onTriggerGallery:C},null,8,["show","settings"]),ie(ha,{show:i.value,"aspect-ratio":U.value,settings:t.settings,point:t.point,onClose:u,onPhotoCaptured:H},null,8,["show","aspect-ratio","settings","point"]),ie(Ta,{show:s.value,images:f.value,point:t.point,"initial-index":h.value,"allow-multiple":b.value,"max-files":t.settings.max_files,"is-uploading":x.value,"aspect-ratio":U.value,onClose:_,onSaveImages:ce,onRemovePreviewImage:V,onTriggerAddMorePhotos:E},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio"])]))}},je=pe(Ga,[["__scopeId","data-v-771b7e31"]]),Xa={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Ya={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Ja={class:"px-4 pb-2 border-b border-gray-200"},Qa={class:"text-lg font-semibold text-gray-900"},es={key:0,class:"text-sm text-gray-500 mt-1"},ts={class:"flex-1 overflow-y-auto p-4"},as={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},ss={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},emits:["close"],setup(t,{emit:F}){const a=F,m=()=>{a("close")},d=r=>{r.key==="Escape"&&m()};return $e(()=>{document.addEventListener("keydown",d)}),Me(()=>{document.removeEventListener("keydown",d)}),(r,v)=>(o(),Ie(De,{name:"bottom-sheet"},{default:xe(()=>[t.show?(o(),n("div",Xa,[e("div",{class:"absolute inset-0 bg-black bg-opacity-50",onClick:m}),e("div",Ya,[v[0]||(v[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Ja,[e("h3",Qa,j(t.title),1),t.subtitle?(o(),n("p",es,j(t.subtitle),1)):p("",!0)]),e("div",ts,[Te(r.$slots,"default",{},void 0,!0)]),r.$slots.footer?(o(),n("div",as,[Te(r.$slots,"footer",{},void 0,!0)])):p("",!0)])])):p("",!0)]),_:3}))}},os=pe(ss,[["__scopeId","data-v-7893c2dc"]]),ns={class:"space-y-4"},ls={key:0,class:"mt-2"},is={key:1,class:"mt-2"},rs={key:2,class:"mt-2"},us={key:3,class:"mt-2"},ds={key:4,class:"mt-2"},cs={class:"text-sm font-medium text-gray-700 mb-2"},ms={key:0,class:"text-red-500"},vs={key:0,class:"text-xs text-red-500"},gs=["name","value","checked"],ps={key:6,class:"space-y-2"},hs={key:0,class:"text-red-500"},fs={key:1,class:"text-xs text-red-500"},bs={key:7,class:"mt-4"},ws={class:"text-sm font-medium text-gray-700 mb-2"},xs={key:0,class:"text-red-500"},ys={key:0,class:"text-xs text-red-500"},ks={class:"flex gap-2"},$s=["disabled"],Le={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:String,notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(t,{emit:F}){const a=t,m=F,d=i=>m("hapus",i),r=Z(()=>a.options.find(i=>i.value===a.selectedValue)),v=Z(()=>{var s,k,h,x,b,L,U;if(a.point.input_type==="text"&&(!((s=a.notesValue)!=null&&s.trim())||a.point.settings.min_length&&a.notesValue.length<a.point.settings.min_length||a.point.settings.max_length&&a.notesValue.length>a.point.settings.max_length)||a.point.input_type==="number"&&(!((k=a.notesValue)!=null&&k.trim())||a.point.settings.min&&a.notesValue.length<a.point.settings.min||a.point.settings.max&&a.notesValue.length>a.point.settings.max)||a.point.input_type==="account"&&(!((h=a.notesValue)!=null&&h.trim())||a.point.settings.min_value&&a.notesValue.length<a.point.settings.min_value||a.point.settings.max_value&&a.notesValue.length>a.point.settings.max_value)||a.point.input_type==="date"&&(!((x=a.notesValue)!=null&&x.trim())||a.point.settings.min_date&&a.notesValue.length<a.point.settings.min_date||a.point.settings.max_date&&a.notesValue.length>a.point.settings.max_date)||a.point.input_type==="imageTOradio"&&a.imagesValue.length===0||a.options.length&&!a.selectedValue)return!1;const i=r.value;return!(a.showTextarea&&((b=i==null?void 0:i.settings)!=null&&b.show_textarea)&&(!((L=a.notesValue)!=null&&L.trim())||i.settings.min_length&&a.notesValue.length<i.settings.min_length||i.settings.max_length&&a.notesValue.length>i.settings.max_length)||a.showImageUpload&&((U=i==null?void 0:i.settings)!=null&&U.show_image_upload)&&(a.imagesValue.length===0||i.settings.max_files&&a.imagesValue.length>i.settings.max_files))});return(i,s)=>(o(),Ie(os,{show:t.show,title:t.title,subtitle:t.subtitle,onClose:s[18]||(s[18]=k=>i.$emit("close"))},{footer:xe(()=>[t.selectedPoint?(o(),n("button",{key:0,onClick:s[15]||(s[15]=k=>d(t.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},s[20]||(s[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),ae(" Hapus Data ")]))):p("",!0),e("div",ks,[e("button",{type:"button",onClick:s[16]||(s[16]=k=>i.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:s[17]||(s[17]=k=>i.$emit("save")),disabled:!v.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,$s)])]),default:xe(()=>{var k,h,x,b,L,U,f,N,E,C,R,D,u,_,A,X,Y,ne,H,Q,le,ce,V,T,l,w,c,B,I,z;return[e("div",ns,[t.point.input_type==="text"?(o(),n("div",ls,[ie(St,{"model-value":t.notesValue,required:(k=t.point.settings)==null?void 0:k.is_required,"min-length":(h=t.point.settings)==null?void 0:h.min_length,"max-length":(x=t.point.settings)==null?void 0:x.max_length,allowSpace:(b=t.point.settings)==null?void 0:b.allow_space,textTransform:(L=t.point.settings)==null?void 0:L.text_transform,placeholder:((U=t.point.settings)==null?void 0:U.placeholder)||"Masukan text",error:i.error,"onUpdate:modelValue":s[0]||(s[0]=S=>i.$emit("update:notesValue",S)),onSave:s[1]||(s[1]=S=>i.$emit("saveText",S))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):p("",!0),t.point.input_type==="number"?(o(),n("div",is,[ie(ze,{"model-value":t.notesValue,required:(f=t.point.settings)==null?void 0:f.is_required,min:(N=t.point.settings)==null?void 0:N.min,max:(E=t.point.settings)==null?void 0:E.max,step:((C=t.point.settings)==null?void 0:C.step)||1,placeholder:((R=t.point.settings)==null?void 0:R.placeholder)||"Masukan number",error:i.error,"onUpdate:modelValue":s[2]||(s[2]=S=>i.$emit("update:notesValue",S)),onSave:s[3]||(s[3]=S=>i.$emit("saveNumber",S))},null,8,["model-value","required","min","max","step","placeholder","error"])])):p("",!0),t.point.input_type==="account"?(o(),n("div",rs,[ie(Bt,{"model-value":t.notesValue,required:(D=t.point.settings)==null?void 0:D.is_required,placeholder:((u=t.point.settings)==null?void 0:u.placeholder)||"Masukkan nilai",error:i.error,"point-id":t.pointId,settings:t.point.settings,"onUpdate:modelValue":s[4]||(s[4]=S=>i.$emit("update:notesValue",S)),onSave:s[5]||(s[5]=S=>i.$emit("saveAccount",S))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):p("",!0),t.point.input_type==="date"?(o(),n("div",us,[ie(Ut,{"model-value":t.notesValue,required:(_=t.point.settings)==null?void 0:_.is_required,"min-date":(A=t.point.settings)==null?void 0:A.min_date,"max-date":(X=t.point.settings)==null?void 0:X.max_date,error:i.error,"onUpdate:modelValue":s[6]||(s[6]=S=>i.$emit("update:notesValue",S)),onSave:s[7]||(s[7]=S=>i.$emit("saveDate",S))},null,8,["model-value","required","min-date","max-date","error"])])):p("",!0),t.point.input_type==="imageTOradio"?(o(),n("div",ds,[e("h4",cs,[(Y=t.point.settings)!=null&&Y.required?(o(),n("span",ms,"*")):p("",!0)]),ie(je,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point.inspection_point,"inspection-id":t.inspectionId,settings:t.point.settings,"onUpdate:modelValue":s[8]||(s[8]=S=>i.$emit("update:imagesValue",S)),onSave:s[9]||(s[9]=S=>i.$emit("saveImage",S))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ne=t.point.settings)!=null&&ne.required&&t.imagesValue.length===0?(o(),n("p",vs," Foto wajib diupload ")):p("",!0)])):p("",!0),t.options.length?(o(),n("div",{key:5,class:G(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(o(!0),n(re,null,ue(t.options,(S,M)=>(o(),n("label",{key:M,class:"cursor-pointer"},[e("input",{type:"radio",name:t.name,value:S.value,checked:t.selectedValue===S.value,onChange:s[10]||(s[10]=q=>i.$emit("update:selectedValue",q.target.value)),class:"hidden peer"},null,40,gs),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.selectedValue===S.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.selectedValue!==S.value}])},j(S.label),3)]))),128))],2)):p("",!0),t.showTextarea&&((Q=(H=r.value)==null?void 0:H.settings)!=null&&Q.show_textarea)?(o(),n("div",ps,[(le=r.value.settings)!=null&&le.required?(o(),n("span",hs,"*")):p("",!0),ie(Ht,{"model-value":t.notesValue,"point-id":t.pointId,"inspection-id":t.inspectionId,settings:r.value.settings,required:(ce=r.value.settings)==null?void 0:ce.required,"min-length":(V=r.value.settings)==null?void 0:V.min_length,"max-length":(T=r.value.settings)==null?void 0:T.max_length,placeholder:((l=r.value.settings)==null?void 0:l.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":s[11]||(s[11]=S=>i.$emit("update:notesValue",S)),onSave:s[12]||(s[12]=S=>i.$emit("saveTextarea",S))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(w=r.value.settings)!=null&&w.required&&!t.notesValue?(o(),n("p",fs," Keterangan wajib diisi ")):p("",!0)])):p("",!0),t.showImageUpload&&((B=(c=r.value)==null?void 0:c.settings)!=null&&B.show_image_upload)?(o(),n("div",bs,[e("h4",ws,[s[19]||(s[19]=ae(" Upload Foto ")),(I=r.value.settings)!=null&&I.required?(o(),n("span",xs,"*")):p("",!0)]),ie(je,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,settings:r.value.settings,"onUpdate:modelValue":s[13]||(s[13]=S=>i.$emit("update:imagesValue",S)),onSave:s[14]||(s[14]=S=>i.$emit("saveImage",S))},null,8,["model-value","point-id","point","inspection-id","settings"]),(z=r.value.settings)!=null&&z.required&&t.imagesValue.length===0?(o(),n("p",ys," Foto wajib diupload ")):p("",!0)])):p("",!0)])]}),_:1},8,["show","title","subtitle"]))}},Is={class:"mt-2 space-y-2"},Cs=["name","value","checked","onChange","required"],Vs={key:0,class:"p-2 rounded-lg bg-gray-50"},Ss={key:0,class:"mt-2"},Ms={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},_s=["src"],Ns={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Us={key:1,class:"mt-2"},Ts={class:"text-sm text-gray-600"},js={key:2,class:"mt-2 text-sm text-red-600"},go={__name:"InputRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:F}){const a=t,m=F,d=y(a.notes),r=y([...a.images]),v=y(!1),i=y(""),s=y([]),k=y(""),h=y([]),x=Z(()=>a.options.find(u=>u.value===a.modelValue)),b=u=>u.settings&&(u.settings.show_textarea||u.settings.show_image_upload);de(()=>a.notes,u=>{d.value=u}),de(()=>a.images,u=>{r.value=[...u]}),de(()=>a.modelValue,u=>{u&&(k.value=u)});const L=u=>{m("update:modelValue",u.value),b(u)?f():m("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:u.value,notes:"",images:[]})},U=u=>u.preview||(u.image_path?`/${u.image_path}`:u),f=()=>{k.value=a.modelValue,i.value=d.value,s.value=[...r.value],h.value=[...r.value],v.value=!0},N=()=>{i.value="",s.value=[],k.value="",v.value=!1},E=u=>{s.value=u,r.value=[...u],m("update:images",[...u]),m("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:d.value,images:[...u]})},C=u=>{},R=()=>{k.value!==a.modelValue&&m("update:modelValue",k.value),d.value=i.value,m("update:notes",i.value),r.value=[...s.value],m("update:images",[...s.value]),m("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:k.value,notes:i.value,images:s.value}),v.value=!1},D=u=>{k.value="",i.value="",s.value=[],d.value="",r.value=[],m("update:modelValue",""),m("update:notes",""),m("update:images",[]),m("hapus",u),v.value=!1};return(u,_)=>{var A,X,Y,ne;return o(),n("div",Is,[e("div",{class:G(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(o(!0),n(re,null,ue(t.options,(H,Q)=>(o(),n("label",{key:Q,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:H.value,checked:t.modelValue===H.value,onChange:le=>L(H),class:"hidden peer",required:t.required},null,40,Cs),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===H.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==H.value}])},j(H.label),3)]))),128))],2),t.modelValue&&x.value&&b(x.value)?(o(),n("div",Vs,[e("div",{class:"flex justify-between items-start"},[_[4]||(_[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:f,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),t.images.length>0&&((A=x.value.settings)!=null&&A.show_image_upload)?(o(),n("div",Ss,[e("div",Ms,[(o(!0),n(re,null,ue(t.images,(H,Q)=>(o(),n("div",{key:Q,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:U(H),class:"w-full h-full object-cover rounded"},null,8,_s),Q===3&&t.images.length>4?(o(),n("span",Ns," +"+j(t.images.length-4),1)):p("",!0)]))),128))])])):p("",!0),t.notes&&((X=x.value.settings)!=null&&X.show_textarea)?(o(),n("div",Us,[e("p",Ts,j(t.notes),1)])):p("",!0)])):p("",!0),v.value?(o(),Ie(Le,{key:(Y=t.selectedPoint)==null?void 0:Y.id,show:v.value,title:t.pointName||"Detail",subtitle:(ne=x.value)==null?void 0:ne.description,name:"modal-radio-"+t.pointId,options:t.options,"selected-value":k.value,"notes-value":i.value,"images-value":s.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":_[0]||(_[0]=H=>k.value=H),"onUpdate:notesValue":_[1]||(_[1]=H=>i.value=H),"onUpdate:imagesValue":_[2]||(_[2]=H=>E(H)),onClose:N,onSave:R,onSaveTextarea:u.handleTextareaSave,onSaveImage:C,onHapus:_[3]||(_[3]=H=>D(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):p("",!0),t.error?(o(),n("p",js,j(t.error),1)):p("",!0)])}}},Ls={class:"mt-2 space-y-2"},Bs={key:0,class:"flex flex-wrap gap-3"},Ps={key:1,class:"p-2"},Ds={key:0,class:"mt-2"},Rs={class:"flex gap-2 overflow-x-auto scrollbar-hide"},As=["src"],Fs={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},qs=["name","value","checked"],Es={key:1,class:"mt-2"},zs={class:"text-sm text-gray-600"},Hs={key:3,class:"mt-2 text-sm text-red-600"},po={__name:"InputImageToRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:F}){const a=t,m=F,d=y(a.notes),r=y([...a.images]),v=y(!1),i=y(""),s=y([]),k=y(""),h=y([]),x=Z(()=>a.options.find(C=>C.value===a.modelValue)),b=C=>C.preview||(C.image_path?`/${C.image_path}`:C);de(()=>a.notes,C=>{d.value=C});const L=()=>{k.value=a.modelValue||"",i.value=d.value,s.value=[...r.value],h.value=[...r.value],v.value=!0},U=()=>{i.value="",s.value=[],k.value="",v.value=!1},f=C=>{s.value=C,r.value=[...C],m("update:images",[...C]),m("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:d.value,images:[...C]})},N=()=>{k.value!==a.modelValue&&m("update:modelValue",k.value),d.value=i.value,m("update:notes",i.value),r.value=[...s.value],m("update:images",[...s.value]),m("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:k.value,notes:i.value,images:s.value}),v.value=!1},E=C=>{k.value="",i.value="",s.value=[],d.value="",r.value=[],m("update:modelValue",""),m("update:notes",""),m("update:images",[]),m("hapus",C),v.value=!1};return(C,R)=>{var D,u,_;return o(),n("div",Ls,[!t.modelValue&&r.value.length===0&&!d.value?(o(),n("div",Bs,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:L},R[4]||(R[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(o(),n("div",Ps,[e("div",{class:"flex justify-between items-start"},[R[5]||(R[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:L,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),r.value.length>0?(o(),n("div",Ds,[e("div",Rs,[(o(!0),n(re,null,ue(r.value,(A,X)=>(o(),n("div",{key:X,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:b(A),class:"w-full h-full object-cover rounded"},null,8,As),X===3&&r.value.length>4?(o(),n("span",Fs," +"+j(r.value.length-4),1)):p("",!0)]))),128))])])):p("",!0),e("div",{class:G(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(o(!0),n(re,null,ue(t.options,(A,X)=>(o(),n("label",{key:X,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:A.value,checked:t.modelValue===A.value,disabled:!0,class:"hidden peer"},null,8,qs),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===A.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==A.value}])},j(A.label),3)]))),128))],2),d.value&&((D=x.value.settings)!=null&&D.show_textarea)?(o(),n("div",Es,[e("p",zs,j(d.value),1)])):p("",!0)])),v.value?(o(),Ie(Le,{key:(u=t.selectedPoint)==null?void 0:u.id,show:v.value,title:t.pointName||"Detail",subtitle:(_=x.value)==null?void 0:_.description,name:"modal-radio-"+t.pointId,options:t.options,"selected-value":k.value,"notes-value":i.value,"images-value":s.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":R[0]||(R[0]=A=>k.value=A),"onUpdate:notesValue":R[1]||(R[1]=A=>i.value=A),"onUpdate:imagesValue":R[2]||(R[2]=A=>f(A)),onClose:U,onSave:N,onHapus:R[3]||(R[3]=A=>E(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):p("",!0),t.error?(o(),n("p",Hs,j(t.error),1)):p("",!0)])}}},Os={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Ws={class:"p-4 space-y-4-6"},Zs={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Ks=["value"],Gs={class:"p-4 space-y-4-6"},Xs={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Ys=["value"],Js={key:0,class:"p-4 space-y-4"},Qs={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},eo=["value"],to={class:"p-4 space-y-2"},ao={class:"flex gap-1 mb-2 p-2 bg-gray-100 rounded-md"},so={class:"text-xs mt-1 text-gray-500"},oo={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0}},setup(t){const F=t,a=y(null),m=y(!1);y("");const d=y(""),r=`inspection-${F.inspectionId}-note`,v=D=>{if(!D)return{};if(typeof D=="string")try{return JSON.parse(D)||{}}catch(u){return console.error("Error parsing settings JSON:",u),{}}return typeof D=="object"&&D!==null?D:{}},i=Z(()=>v(F.inspection.settings).conclusion||{}),s=y({flooded:i.value.flooded||"",collision:i.value.collision||"",collision_severity:i.value.collision_severity||"",conclusion_note:""}),k=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],h=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],x=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];$e(()=>{R();const D=localStorage.getItem(r);D?s.value.conclusion_note=D:F.inspection.notes&&(s.value.conclusion_note=F.inspection.notes),Re(()=>{b()})});const b=()=>{a.value&&s.value.conclusion_note&&(a.value.innerHTML=s.value.conclusion_note)},L=Se.debounce(()=>{if(a.value){const D=window.getSelection();D.rangeCount>0&&D.getRangeAt(0),s.value.conclusion_note=a.value.innerHTML,localStorage.setItem(r,s.value.conclusion_note),C()}},500),U=D=>{D.preventDefault(),document.execCommand("insertParagraph",!1,null)},f=D=>{D.preventDefault();const u=(D.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,u)},N=D=>{if(!a.value)return;a.value.focus();const u=window.getSelection();switch(u.rangeCount>0&&u.getRangeAt(0),D){case"bold":document.execCommand("bold");break;case"italic":document.execCommand("italic");break;case"underline":document.execCommand("underline");break}L()},E=()=>{m.value=!1,a.value&&(s.value.conclusion_note=a.value.innerHTML,localStorage.setItem(r,s.value.conclusion_note),C())},C=Se.debounce(()=>{const D={flooded:s.value.flooded,collision:s.value.collision,collision_severity:s.value.collision==="yes"?s.value.collision_severity:null,conclusion_note:s.value.conclusion_note};Ae.post(route("inspections.updateConclusion",F.inspectionId),D,{preserveScroll:!0,preserveState:!0,only:[],onSuccess:()=>{localStorage.removeItem(r),d.value="⏳ Tersimpan"}})},500);de([()=>s.value.flooded,()=>s.value.collision,()=>s.value.collision_severity],()=>{C()});const R=()=>{const u=v(F.inspection.settings).conclusion||{};s.value.flooded=u.flooded||"",s.value.collision=u.collision||"",s.value.collision_severity=u.collision_severity||""};return(D,u)=>(o(),n("div",Os,[u[18]||(u[18]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b"},[e("h3",{class:"text-xl font-semibold text-indigo-700"},"Kesimpulan Inspeksi")],-1)),e("div",Ws,[u[11]||(u[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ae(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Zs,[(o(),n(re,null,ue(k,_=>e("label",{key:_.value,class:"cursor-pointer"},[ve(e("input",{type:"radio","onUpdate:modelValue":u[0]||(u[0]=A=>s.value.flooded=A),value:_.value,class:"hidden peer",onChange:u[1]||(u[1]=(...A)=>oe(C)&&oe(C)(...A))},null,40,Ks),[[Ve,s.value.flooded]]),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":s.value.flooded===_.value,"border-gray-300 text-gray-700 hover:bg-gray-50":s.value.flooded!==_.value}])},j(_.label),3)])),64))])]),e("div",Gs,[u[13]||(u[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ae(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Xs,[(o(),n(re,null,ue(h,_=>e("label",{key:_.value,class:"cursor-pointer"},[ve(e("input",{type:"radio","onUpdate:modelValue":u[2]||(u[2]=A=>s.value.collision=A),value:_.value,class:"hidden peer",onChange:u[3]||(u[3]=(...A)=>oe(C)&&oe(C)(...A))},null,40,Ys),[[Ve,s.value.collision]]),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":s.value.collision===_.value,"border-gray-300 text-gray-700 hover:bg-gray-50":s.value.collision!==_.value}])},j(_.label),3)])),64))]),s.value.collision==="yes"?(o(),n("div",Js,[u[12]||(u[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ae("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Qs,[(o(),n(re,null,ue(x,_=>e("label",{key:_.value,class:"cursor-pointer"},[ve(e("input",{type:"radio","onUpdate:modelValue":u[4]||(u[4]=A=>s.value.collision_severity=A),value:_.value,class:"hidden peer",onChange:u[5]||(u[5]=(...A)=>oe(C)&&oe(C)(...A))},null,40,eo),[[Ve,s.value.collision_severity]]),e("div",{class:G(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":s.value.collision_severity===_.value,"border-gray-300 text-gray-700 hover:bg-gray-50":s.value.collision_severity!==_.value}])},j(_.label),3)])),64))])])):p("",!0)]),e("div",to,[u[17]||(u[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catatan Kesimpulan",-1)),e("div",ao,[e("button",{type:"button",onClick:u[6]||(u[6]=_=>N("bold")),class:"p-2 rounded hover:bg-gray-200 transition-colors",title:"Bold"},u[14]||(u[14]=[e("strong",null,"B",-1)])),e("button",{type:"button",onClick:u[7]||(u[7]=_=>N("italic")),class:"p-2 rounded hover:bg-gray-200 transition-colors",title:"Italic"},u[15]||(u[15]=[e("em",null,"I",-1)])),e("button",{type:"button",onClick:u[8]||(u[8]=_=>N("underline")),class:"p-2 rounded hover:bg-gray-200 transition-colors",title:"Underline"},u[16]||(u[16]=[e("u",null,"U",-1)]))]),e("div",{ref_key:"editorRef",ref:a,contenteditable:"true",class:G(["w-full min-h-[120px] p-2 rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 prose max-w-none",{"bg-white":!m.value,"bg-blue-50":m.value}]),onInput:u[9]||(u[9]=(..._)=>oe(L)&&oe(L)(..._)),onBlur:E,onFocus:u[10]||(u[10]=_=>m.value=!0),onKeydown:Fe(U,["enter"]),onPaste:f,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34),e("p",so,j(d.value),1)])]))}},ho=pe(oo,[["__scopeId","data-v-819ad3a0"]]);function fo(t,F){const a=y({x:F.x,y:F.y}),m=y(!1),d=y(null),r=y(!1),v=y({x:0,y:0});$e(()=>{const b=localStorage.getItem(t);if(b)try{a.value=JSON.parse(b)}catch(L){console.error("Error parsing saved position:",L)}});const i=b=>{b.type.includes("touch")?(v.value.x=b.touches[0].clientX,v.value.y=b.touches[0].clientY):(v.value.x=b.clientX,v.value.y=b.clientY),d.value=setTimeout(()=>{r.value=!0,m.value=!0,console.log("Long press activated - drag mode ON")},900)},s=()=>{d.value&&(clearTimeout(d.value),d.value=null),r.value=!1};return{pos:a,dragging:m,startLongPress:i,cancelLongPress:s,onDrag:b=>{if(!m.value||!r.value)return;b.preventDefault();let L,U;b.type.includes("touch")?(L=b.touches[0].clientX,U=b.touches[0].clientY):(L=b.clientX,U=b.clientY),a.value.x=L-24,a.value.y=U-24},stopDrag:()=>{if(m.value&&r.value){console.log("Drag stopped - saving position"),m.value=!1,r.value=!1;try{localStorage.setItem(t,JSON.stringify(a.value))}catch(b){console.error("Error saving position:",b)}}s()},handleClick:b=>!m.value&&!r.value?(console.log("Regular click detected"),!0):(console.log("Click ignored - part of drag operation"),!1)}}export{os as B,ho as C,je as I,mo as V,St as _,Bt as a,Ut as b,Ht as c,go as d,po as e,vo as f,Le as g,fo as u};
