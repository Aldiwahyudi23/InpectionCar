import{N as W,M as we,r as _,g as ye,q as Te,W as je,D as $,j as Se,o as v,w as Ce,k as Ie,d as l,c as m,b as I,u as D,v as Le,z as qe,A as Oe,F as ne,m as ie,t as M,n as Re,f as Me,y as B}from"./vendor-BBdeZBHu.js";import{A as Ee}from"./AppLayout-BqLOyvHo.js";import"./app-DJ305Ikz.js";var G,se;function xe(){if(se)return G;se=1;function i(n){var s=typeof n;return n!=null&&(s=="object"||s=="function")}return G=i,G}var V,oe;function Ne(){if(oe)return V;oe=1;var i=typeof W=="object"&&W&&W.Object===Object&&W;return V=i,V}var F,ae;function _e(){if(ae)return F;ae=1;var i=Ne(),n=typeof self=="object"&&self&&self.Object===Object&&self,s=i||n||Function("return this")();return F=s,F}var z,le;function Pe(){if(le)return z;le=1;var i=_e(),n=function(){return i.Date.now()};return z=n,z}var H,ue;function We(){if(ue)return H;ue=1;var i=/\s/;function n(s){for(var o=s.length;o--&&i.test(s.charAt(o)););return o}return H=n,H}var U,ce;function Be(){if(ce)return U;ce=1;var i=We(),n=/^\s+/;function s(o){return o&&o.slice(0,i(o)+1).replace(n,"")}return U=s,U}var Q,de;function ke(){if(de)return Q;de=1;var i=_e(),n=i.Symbol;return Q=n,Q}var X,fe;function Ae(){if(fe)return X;fe=1;var i=ke(),n=Object.prototype,s=n.hasOwnProperty,o=n.toString,u=i?i.toStringTag:void 0;function y(g){var p=s.call(g,u),b=g[u];try{g[u]=void 0;var r=!0}catch{}var c=o.call(g);return r&&(p?g[u]=b:delete g[u]),c}return X=y,X}var J,ve;function $e(){if(ve)return J;ve=1;var i=Object.prototype,n=i.toString;function s(o){return n.call(o)}return J=s,J}var K,ge;function De(){if(ge)return K;ge=1;var i=ke(),n=Ae(),s=$e(),o="[object Null]",u="[object Undefined]",y=i?i.toStringTag:void 0;function g(p){return p==null?p===void 0?u:o:y&&y in Object(p)?n(p):s(p)}return K=g,K}var Y,me;function Ge(){if(me)return Y;me=1;function i(n){return n!=null&&typeof n=="object"}return Y=i,Y}var Z,pe;function Ve(){if(pe)return Z;pe=1;var i=De(),n=Ge(),s="[object Symbol]";function o(u){return typeof u=="symbol"||n(u)&&i(u)==s}return Z=o,Z}var ee,be;function Fe(){if(be)return ee;be=1;var i=Be(),n=xe(),s=Ve(),o=NaN,u=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,g=/^0o[0-7]+$/i,p=parseInt;function b(r){if(typeof r=="number")return r;if(s(r))return o;if(n(r)){var c=typeof r.valueOf=="function"?r.valueOf():r;r=n(c)?c+"":c}if(typeof r!="string")return r===0?r:+r;r=i(r);var x=y.test(r);return x||g.test(r)?p(r.slice(2),x?2:8):u.test(r)?o:+r}return ee=b,ee}var te,he;function ze(){if(he)return te;he=1;var i=xe(),n=Pe(),s=Fe(),o="Expected a function",u=Math.max,y=Math.min;function g(p,b,r){var c,x,k,T,h,j,w=0,E=!1,L=!1,O=!0;if(typeof p!="function")throw new TypeError(o);b=s(b)||0,i(r)&&(E=!!r.leading,L="maxWait"in r,k=L?u(s(r.maxWait)||0,b):k,O="trailing"in r?!!r.trailing:O);function q(f){var C=c,R=x;return c=x=void 0,w=f,T=p.apply(R,C),T}function N(f){return w=f,h=setTimeout(e,b),E?q(f):T}function P(f){var C=f-j,R=f-w,re=b-C;return L?y(re,k-R):re}function t(f){var C=f-j,R=f-w;return j===void 0||C>=b||C<0||L&&R>=k}function e(){var f=n();if(t(f))return a(f);h=setTimeout(e,P(f))}function a(f){return h=void 0,O&&c?q(f):(c=x=void 0,T)}function d(){h!==void 0&&clearTimeout(h),w=0,c=j=x=h=void 0}function S(){return h===void 0?T:a(n())}function A(){var f=n(),C=t(f);if(c=arguments,x=this,j=f,C){if(h===void 0)return N(j);if(L)return clearTimeout(h),h=setTimeout(e,b),q(j)}return h===void 0&&(h=setTimeout(e,b)),T}return A.cancel=d,A.flush=S,A}return te=g,te}var He=ze();const Ue=we(He),Qe=()=>{const i=_(null),n=_(!1),s=_(!1),o=_(navigator.onLine),u=()=>{const r=window.matchMedia("(display-mode: standalone)").matches,c=window.navigator.standalone===!0;n.value=r||c,s.value=!n.value},y=async()=>{if("serviceWorker"in navigator)try{const r=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registered successfully"),r.addEventListener("updatefound",()=>{const c=r.installing;console.log("New service worker found"),c.addEventListener("statechange",()=>{c.state==="installed"&&console.log("New content is available; please refresh.")})}),!0}catch(r){return console.error("Service Worker registration failed:",r),!1}return!1},g=()=>{window.addEventListener("beforeinstallprompt",r=>{r.preventDefault(),i.value=r,s.value=!0}),window.addEventListener("appinstalled",()=>{n.value=!0,s.value=!1,i.value=null}),window.addEventListener("online",()=>{o.value=!0}),window.addEventListener("offline",()=>{o.value=!1})},p=async()=>{if(i.value){i.value.prompt();const{outcome:r}=await i.value.userChoice;console.log(r==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),i.value=null}},b=async()=>{u(),g(),await y()};return ye(()=>{b()}),{deferredPrompt:i,isAppInstalled:n,canInstall:s,isOnline:o,installApp:p,initPWA:b}},Xe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 relative"},Je={class:"space-y-4 bg-white rounded-xl shadow-md p-4"},Ke={class:"relative mb-4"},Ye={key:0,class:"space-y-4"},Ze=["onClick"],et={class:"text-lg md:text-xl font-semibold text-indigo-700"},tt={key:0,class:"p-2 border-t border-gray-200"},rt={class:"text-gray-700 mb-4"},nt={key:0},it=["onClick"],st=["innerHTML"],ot={key:2,class:"mt-4"},at=["src","onClick"],lt={key:0,class:"mt-2"},ut={class:"space-y-4"},ct={class:"flex justify-between items-start"},dt={class:"font-medium text-gray-800"},ft=["onClick"],vt=["innerHTML"],gt={key:1,class:"text-gray-600 mt-2"},mt={key:2,class:"mt-2"},pt=["src","onClick"],bt={key:1},ht={key:1,class:"text-center py-12"},yt={class:"relative max-w-full max-h-full flex items-center justify-center"},xt=["src"],Tt={__name:"Bantuan",props:{components:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})}},setup(i){Qe();const n=i,s=_(n.filters.search||""),o=_(null),u=_(null),y=_([]),g=_({}),p=_({}),b=(t,e)=>{e&&(g.value[t]=e)},r=(t,e)=>{e&&(p.value[t]=e)},c=_(!1),x=_(""),k=t=>{if(!t)return"";const e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText||""},T=(t,e)=>t?t.length<=e?t:t.substring(0,e)+"...":"",h=t=>t.inspection_point&&t.inspection_point.length>0,j=t=>{if(!s.value||!h(t))return t.inspection_point||[];const e=s.value.toLowerCase();return t.inspection_point.filter(a=>a.name.toLowerCase().includes(e)||k(a.description).toLowerCase().includes(e))},w=Te(()=>{if(!s.value)return n.components;const t=s.value.toLowerCase();return n.components.filter(e=>{const a=e.name.toLowerCase().includes(t)||k(e.description).toLowerCase().includes(t),d=h(e)&&e.inspection_point.some(S=>S.name.toLowerCase().includes(t)||k(S.description).toLowerCase().includes(t));return a||d})}),E=async t=>{if(o.value===t)o.value=null;else{o.value=t,u.value=null,await $();const e=g.value[t];e&&e.scrollIntoView({behavior:"smooth",block:"start"})}},L=async t=>{if(u.value===t)u.value=null;else{u.value=t,await $();const e=p.value[t];e&&e.scrollIntoView({behavior:"smooth",block:"start"})}},O=t=>{y.value.includes(t)||y.value.push(t)},q=t=>{x.value=t,c.value=!0},N=()=>{c.value=!1,x.value=""},P=Ue(()=>{je.get("/bantuan",{search:s.value},{preserveState:!0,replace:!0})},300);return ye(async()=>{if(s.value&&w.value.length>0){o.value=w.value[0].id,await $();const t=g.value[o.value];t&&t.scrollIntoView({behavior:"smooth",block:"start"})}}),(t,e)=>(v(),Se(Ee,{title:"Pusat Bantuan"},{default:Ce(()=>[Ie(D(Le),{title:"Pusat Bantuan"}),l("div",Xe,[l("div",Je,[e[7]||(e[7]=l("div",{class:"flex justify-between items-center mb-4"},[l("h1",{class:"text-xl md:text-3xl font-bold text-gray-900 text-center flex-grow"}," Pusat Bantuan ")],-1)),l("div",Ke,[e[2]||(e[2]=l("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[l("svg",{class:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[l("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1)),qe(l("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),type:"text",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"Cari komponen, inspection point, atau deskripsi...",onInput:e[1]||(e[1]=(...a)=>D(P)&&D(P)(...a))},null,544),[[Oe,s.value]])]),w.value.length>0?(v(),m("div",Ye,[(v(!0),m(ne,null,ie(w.value,a=>(v(),m("div",{key:a.id,ref_for:!0,ref:d=>b(a.id,d),class:"bg-white rounded-xl shadow-md overflow-hidden component-item"},[l("div",{class:"p-2 flex justify-between items-center cursor-pointer bg-indigo-50 hover:bg-indigo-100 transition-colors",onClick:d=>E(a.id)},[l("h2",et,M(a.name),1),(v(),m("svg",{class:Re([{"rotate-180":o.value===a.id},"h-5 w-5 text-indigo-600 transform transition-transform"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e[3]||(e[3]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))],8,Ze),o.value===a.id?(v(),m("div",tt,[l("div",rt,[a.description&&!y.value.includes(a.id)?(v(),m("div",nt,[Me(M(T(k(a.description),300))+" ",1),k(a.description).length>300?(v(),m("button",{key:0,onClick:B(d=>O(a.id),["stop"]),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium ml-1"}," Selengkapnya ",8,it)):I("",!0)])):I("",!0),y.value.includes(a.id)?(v(),m("div",{key:1,class:"prose max-w-none text-gray-700",innerHTML:a.description},null,8,st)):I("",!0),a.file_path?(v(),m("div",ot,[l("img",{src:`/storage/${a.file_path}`,alt:"Component Image",class:"w-full h-auto rounded-lg shadow-md cursor-pointer",onClick:B(d=>q(`/storage/${a.file_path}`),["stop"])},null,8,at)])):I("",!0)]),h(a)?(v(),m("div",lt,[e[4]||(e[4]=l("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"Point:",-1)),l("div",ut,[(v(!0),m(ne,null,ie(j(a),d=>(v(),m("div",{key:d.id,ref_for:!0,ref:S=>r(d.id,S),class:"bg-gray-50 rounded-lg p-4 border border-gray-200 point-item"},[l("div",ct,[l("h4",dt,M(d.name),1),l("button",{onClick:S=>L(d.id),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium"},M(u.value===d.id?"Sembunyikan":"Selengkapnya"),9,ft)]),u.value===d.id?(v(),m("div",{key:0,class:"text-gray-600 mt-2 prose max-w-none",innerHTML:d.notes},null,8,vt)):(v(),m("div",gt,M(T(k(d.description),200)),1)),u.value===d.id&&d.file_path?(v(),m("div",mt,[l("img",{src:`/storage/${d.file_path}`,alt:"Inspection Point Image",class:"w-full h-auto rounded-lg shadow-md cursor-pointer",onClick:B(S=>q(`/storage/${d.file_path}`),["stop"])},null,8,pt)])):I("",!0)]))),128))])])):a.inspection_point&&a.inspection_point.length===0?(v(),m("div",bt,e[5]||(e[5]=[l("p",{class:"text-gray-500 italic"},"Tidak ada inspection points untuk komponen ini.",-1)]))):I("",!0)])):I("",!0)]))),128))])):(v(),m("div",ht,e[6]||(e[6]=[l("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),l("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"Tidak ada hasil ditemukan",-1),l("p",{class:"mt-1 text-gray-500"},"Coba dengan kata kunci pencarian yang berbeda.",-1)])))])]),c.value?(v(),m("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-90",onClick:N},[l("div",yt,[l("button",{onClick:B(N,["stop"]),class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},e[8]||(e[8]=[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),l("img",{src:x.value,alt:"Full-screen image",class:"max-w-full max-h-full object-contain"},null,8,xt)])])):I("",!0)]),_:1}))}};export{Tt as default};
