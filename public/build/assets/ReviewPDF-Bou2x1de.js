import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as R,q as $,f as o,o as n,i as y,d as e,t as d,F as f,k as _,n as A}from"./vendor-BDDfTp_K.js";const X={class:"p-6 bg-white rounded-lg shadow-md"},Y={key:0,class:"mt-2 mb-6"},Z={key:1},tt={class:"header flex flex-col gap-5 mb-6 mt-6"},et={class:"flex items-center gap-5"},st=["src"],ot={key:1,class:"w-40 h-40 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-gray-400"},nt={class:"mt-8"},at={class:"text-3xl font-bold m-0 text-gray-800"},rt={key:0,class:"car-info"},it={class:"w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"},dt={class:"bg-gray-50"},lt={class:"p-2 border border-gray-300 text-gray-600"},ct={class:"p-2 border border-gray-300 text-gray-600"},ut={class:"bg-gray-50"},gt={class:"p-2 border border-gray-300 text-gray-600"},bt={class:"p-2 border border-gray-300 text-gray-600"},yt={class:"bg-gray-50"},pt={class:"p-2 border border-gray-300 text-gray-600"},mt={class:"p-2 border border-gray-300 text-gray-600"},ft={class:"bg-gray-50"},xt={class:"p-2 border border-gray-300 text-gray-600"},ht={class:"p-2 border border-gray-300 text-gray-600"},kt={class:"bg-gray-50"},_t={class:"p-2 border border-gray-300 text-gray-600"},vt={key:1,class:"conclusion p-4 bg-gray-50 border-l-4 border-gray-800 rounded-lg"},wt={class:"m-0 text-gray-600"},jt={class:"component-title bg-gray-100 px-3 py-2 border-l-4 border-gray-800 font-bold rounded-l-lg"},It={key:0,class:"images flex flex-wrap gap-2 mt-4"},Ft=["src"],Dt={key:1,class:"w-28 h-28 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},Ct={class:"point-name inline-block min-w-[160px] font-bold align-top text-gray-700"},Tt={class:"point-content inline-block w-[calc(100%-170px)] align-top"},St={key:1,class:"point-note italic text-gray-600 my-1"},Ot={key:0,class:"inspection-images flex flex-wrap gap-2 mt-4"},Pt=["src"],Lt={key:1,class:"w-20 h-20 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},Bt={key:1,class:"textarea-note italic text-gray-600 my-2"},Kt={key:2,class:"flex flex-col items-center justify-center h-96 text-center"},Nt=["href"],Mt={key:3,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},Rt={class:"bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm"},$t={class:"flex justify-end space-x-4"},At=["disabled"],Et={key:0},Gt={key:1},Ut={key:1,class:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 cursor-not-allowed"},qt={__name:"ReviewPDF",props:{inspection:{type:Object,required:!0},menu_points:{type:Array,default:()=>[]},coverImage:{type:Object,default:null},encryptedIds:Object},setup(a){const x=a,v=R(!1),w=R(!1),E=$(()=>{const s={};return x.menu_points.forEach(t=>{var l,c;const r=((c=(l=t.inspection_point)==null?void 0:l.component)==null?void 0:c.name)||"Tanpa Komponen";s[r]||(s[r]=[]),s[r].push(t)}),s}),G=()=>{w.value=!0,setTimeout(()=>{window.location.href=route("inspections.download.pdf",x.encryptedIds),w.value=!1,v.value=!1},2e3)},U=$(()=>{if(x.inspection.notes)return!0;const s=x.menu_points.some(r=>j(r)||S(r)),t=x.coverImage&&x.coverImage.image_path;return s||t}),C=s=>s&&s.length>0,T=s=>`/${s}`,j=s=>{var t;return((t=s.inspection_point)==null?void 0:t.results)&&s.inspection_point.results.length>0},S=s=>{var t;return((t=s.inspection_point)==null?void 0:t.images)&&s.inspection_point.images.length>0},P=s=>j(s)&&s.inspection_point.results[0].note,q=s=>{var l,c,u;const t=s.input_type||"",r=(u=(c=(l=s.inspection_point)==null?void 0:l.results)==null?void 0:c[0])==null?void 0:u.status;return["radio","imageTOradio"].includes(t)&&r},z=s=>{const t=s.input_type||"";return["text","number","date","textarea"].includes(t)&&P(s)},H=s=>{var g,b,p,m;const t=s.input_type||"",r=s.settings||{},l=((b=(g=s.inspection_point)==null?void 0:g.results)==null?void 0:b[0])||{},u=((m=(((p=r.radios)==null?void 0:p.find(I=>I.value===l.status))||{}).settings)==null?void 0:m.show_image_upload)||!1;return(t==="image"||t==="imageTOradio"||t==="radio"&&u)&&S(s)},V=s=>{var c,u,g,b;const t=s.settings||{},r=((u=(c=s.inspection_point)==null?void 0:c.results)==null?void 0:u[0])||{};return((b=(((g=t.radios)==null?void 0:g.find(p=>p.value===r.status))||{}).settings)==null?void 0:b.show_textarea)||!1},J=s=>{if(!s)return"status-warning";const t=s.toLowerCase();return["normal","ada","baik","good","ok"].includes(t)?"status-good":["tidak normal","tidak ada","rusak","bad","not ok"].includes(t)?"status-bad":"status-warning"},Q=s=>{var c,u;const t=s.input_type||"",r=((u=(c=s.inspection_point)==null?void 0:c.results)==null?void 0:u[0])||{},l=s.settings||{};if(t==="account"&&r.note){const g=l.currency_symbol||"Rp",b=l.thousands_separator||".",p=l.decimal_separator||",",m=parseFloat(r.note);return isNaN(m)?r.note:`${g} ${m.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:2}).replace(/,/g,p).replace(/\./g,b)}`}return r.note};return(s,t)=>{var r,l,c,u,g,b,p,m,I,L,B;return n(),o("div",X,[a.inspection.status==="pending_review"?(n(),o("div",Y,[e("button",{onClick:t[0]||(t[0]=F=>v.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"}," Setujui Laporan "),t[2]||(t[2]=e("p",{class:"text-sm text-gray-500 mt-2 italic"}," Catatan: Halaman ini hanya simulasi dan mungkin berbeda dengan tampilan file PDF. Silakan periksa lebih detail untuk memastikan tidak ada kesalahan. Jika sudah yakin, silakan setujui untuk proses selanjutnya. ",-1))])):y("",!0),U.value?(n(),o("div",Z,[e("div",tt,[e("div",et,[a.coverImage&&C(a.coverImage.image_path)?(n(),o("img",{key:0,src:T(a.coverImage.image_path),alt:"Foto Utama",class:"w-40 h-40 object-cover rounded-lg border border-gray-300"},null,8,st)):(n(),o("div",ot,t[3]||(t[3]=[e("span",null,"Gambar tidak tersedia",-1)]))),e("div",nt,[e("h2",at,d(a.inspection.car_name),1)])]),a.inspection.car_id?(n(),o("div",rt,[e("table",it,[e("tr",dt,[t[4]||(t[4]=e("td",{class:"p-2 border border-gray-300 font-bold w-1/3 text-gray-700"},"Nomor Polisi",-1)),e("td",lt,d(a.inspection.plate_number),1)]),e("tr",null,[t[5]||(t[5]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Merek",-1)),e("td",ct,d((l=(r=a.inspection.car)==null?void 0:r.brand)==null?void 0:l.name),1)]),e("tr",ut,[t[6]||(t[6]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Model",-1)),e("td",gt,d((u=(c=a.inspection.car)==null?void 0:c.model)==null?void 0:u.name),1)]),e("tr",null,[t[7]||(t[7]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tipe",-1)),e("td",bt,d((b=(g=a.inspection.car)==null?void 0:g.type)==null?void 0:b.name),1)]),e("tr",yt,[t[8]||(t[8]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"CC",-1)),e("td",pt,d((p=a.inspection.car)==null?void 0:p.cc),1)]),e("tr",null,[t[9]||(t[9]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Bahan Bakar",-1)),e("td",mt,d((m=a.inspection.car)==null?void 0:m.fuel_type),1)]),e("tr",ft,[t[10]||(t[10]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Transmisi",-1)),e("td",xt,d((I=a.inspection.car)==null?void 0:I.transmission),1)]),e("tr",null,[t[11]||(t[11]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Periode Model",-1)),e("td",ht,d(((L=a.inspection.car)==null?void 0:L.production_period)||"-"),1)]),e("tr",kt,[t[12]||(t[12]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tahun Pembuatan",-1)),e("td",_t,d((B=a.inspection.car)==null?void 0:B.year),1)])])])):y("",!0),a.inspection.notes?(n(),o("div",vt,[t[13]||(t[13]=e("h3",{class:"text-lg font-bold mb-2 text-gray-800"},"Kesimpulan Inspeksi:",-1)),e("p",wt,d(a.inspection.notes),1)])):y("",!0)]),t[16]||(t[16]=e("h2",{class:"text-2xl font-bold border-b-2 border-gray-800 pb-2 mb-6"},"Hasil Inspeksi",-1)),(n(!0),o(f,null,_(E.value,(F,D)=>(n(),o("div",{key:D,class:A(["section mb-6",D==="Foto Kendaraan"?"photo-component":""])},[e("div",jt,d(D||"Tanpa Komponen"),1),D==="Foto Kendaraan"?(n(),o("div",It,[(n(!0),o(f,null,_(F,i=>{var k;return n(),o("div",{key:i.id},[(n(!0),o(f,null,_((k=i.inspection_point)==null?void 0:k.images,h=>(n(),o("div",{key:h.id,class:"image-container"},[C(h.image_path)?(n(),o("img",{key:0,src:T(h.image_path),alt:"Foto Kendaraan",class:"w-28 h-28 object-cover border border-gray-300 rounded-lg"},null,8,Ft)):(n(),o("div",Dt,t[14]||(t[14]=[e("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])}),128))])):(n(!0),o(f,{key:1},_(F,i=>{var k,h,K,N,M;return n(),o("div",{key:i.id,class:"point ml-4 py-3 border-b border-gray-100"},[j(i)||S(i)?(n(),o(f,{key:0},[e("span",Ct,d(((k=i.inspection_point)==null?void 0:k.name)||"-"),1),e("div",Tt,[j(i)?(n(),o(f,{key:0},[q(i)?(n(),o("span",{key:0,class:A(["status-badge",J((h=i.inspection_point)==null?void 0:h.results[0].status)])},d((K=i.inspection_point)==null?void 0:K.results[0].status),3)):y("",!0),z(i)?(n(),o("div",St,d(Q(i)),1)):y("",!0)],64)):y("",!0)]),H(i)?(n(),o("div",Ot,[(n(!0),o(f,null,_((N=i.inspection_point)==null?void 0:N.images,O=>(n(),o("div",{key:O.id,class:"image-container"},[C(O.image_path)?(n(),o("img",{key:0,src:T(O.image_path),alt:"image",class:"w-20 h-20 object-cover border border-gray-300 rounded-lg"},null,8,Pt)):(n(),o("div",Lt,t[15]||(t[15]=[e("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])):y("",!0),V(i)&&P(i)?(n(),o("div",Bt,d((M=i.inspection_point)==null?void 0:M.results[0].note),1)):y("",!0)],64)):y("",!0)])}),128))],2))),128))])):(n(),o("div",Kt,[t[17]||(t[17]=e("p",{class:"text-lg font-semibold text-gray-700"}," Data sudah tidak ada, karena sudah dijadikan PDF. ",-1)),e("a",{href:s.route("inspections.download.pdf",a.encryptedIds),class:"mt-4 inline-block bg-blue-600 text-white px-6 py-3 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Download PDF ",8,Nt)])),v.value?(n(),o("div",Mt,[e("div",Rt,[t[19]||(t[19]=e("h3",{class:"text-lg font-bold mb-4"},"Konfirmasi Laporan",-1)),t[20]||(t[20]=e("p",{class:"text-gray-700 mb-6"}," Apakah Anda yakin semua data sudah sesuai? Setelah disetujui, laporan akan diproses menjadi file PDF. ",-1)),e("div",$t,[e("button",{onClick:t[1]||(t[1]=F=>v.value=!1),class:"bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400"}," Batal "),a.inspection.file?(n(),o("button",Ut,t[18]||(t[18]=[e("span",null,"Laporan sudah di buat",-1)]))):(n(),o("button",{key:0,onClick:G,class:"bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors duration-200",disabled:w.value},[w.value?(n(),o("span",Et,"Membuat file PDF...")):(n(),o("span",Gt,"Setujui Laporan"))],8,At))])])])):y("",!0)])}}},Vt=W(qt,[["__scopeId","data-v-0fe6168e"]]);export{Vt as default};
