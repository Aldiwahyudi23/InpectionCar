import{x as Nt,r as k,g as je,q as ne,E as qe,G as he,c as o,o as s,d as e,b as l,k as Ie,z as Ve,A as Be,n as ae,t as N,u as Pe,e as Et,F as $e,m as Se,f as ke,y as Fe,w as Me,N as Le,D as Ge,L as kt,a as Ke,j as _e,l as xt,T as Oe,M as Vt,p as Ut,O as wt,J as He,B as Mt}from"./vendor-g77w9U1W.js";import{l as It}from"./lodash-CGXsUT3p.js";import{_ as Dt}from"./PrimaryButton-CrKKsBb9.js";import{_ as Pt}from"./ActionMessage-C9w22vKV.js";import{_ as De}from"./app-D3r0sYNz.js";const Lt={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Rt={key:0,class:"p-4 space-y-2"},Bt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},jt={class:"flex items-center space-x-2"},Ft={key:0,class:"text-xs text-red-500 font-normal ml-2"},Ot={key:1,class:"text-xs text-red-500 font-normal ml-2"},qt={key:2,class:"text-xs text-green-500 font-normal ml-2"},Kt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ht={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Gt={class:"col-span-2 flex space-x-3"},zt={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Wt={class:"flex items-start"},Jt={class:"text-sm text-blue-700"},Zt={class:"mt-1"},Yt={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Xt={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},Qt={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},ea={key:3,class:"text-blue-600"},ta={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},aa={class:"relative"},na={key:0,class:"absolute right-3 top-3"},sa={key:1,class:"text-xs text-red-500 font-normal ml-2"},oa={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ia={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},la={key:0},ra=["onMousedown"],ua={class:"font-medium text-gray-900"},da={class:"text-sm text-gray-500"},ca={key:1,class:"p-4 text-sm text-gray-500 text-center"},pa={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ma={key:0,class:"mb-4"},ga=["innerHTML"],va={key:1},fa={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ha=["onClick"],ba=["src","alt"],ya={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},xa={class:"text-white text-xs text-center"},wa={key:2,class:"text-center py-4 text-gray-500 text-sm"},ka={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},Ia=["src","alt"],$a={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Sa={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},_a={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Aa={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(t,{emit:W}){var ue,we,ye,S,V,K;const a=t,x=W,r=Nt({plate_number:((ue=a.inspection)==null?void 0:ue.plate_number)||"",car_id:((we=a.inspection)==null?void 0:we.car_id)||null,car_name:((ye=a.inspection)==null?void 0:ye.car_name)||""}),v=k(((S=a.inspection)==null?void 0:S.plate_number)||""),f=k(((V=a.inspection)==null?void 0:V.car_id)||null),d=k(((K=a.inspection)==null?void 0:K.car_name)||""),i=k(""),y=k(""),$=k(""),I=k(null),M=k({rear_door:!1}),j=k(!1),B=k(""),G=k(""),H=k(r.car_name),E=k(!1),w=k(!1),F=k([]),O=k(null),U=k([]),R=k(!1),J=k(0);je(()=>{var u,m,Y,D,te;if(A((u=a.inspection)==null?void 0:u.plate_number),(m=a.inspection)!=null&&m.car_id&&((Y=a.CarDetail)==null?void 0:Y.length)>0){const le=a.CarDetail.find(oe=>oe.id===a.inspection.car_id);le&&c(le)}else!((D=a.inspection)!=null&&D.car_id)&&((te=a.inspection)!=null&&te.car_name)&&(H.value=a.inspection.car_name,r.car_id=null);window.addEventListener("keydown",Q),ve(),x("update:hasUnsavedChanges",de.value),x("update:validation",ce.value)}),qe(()=>{window.removeEventListener("keydown",Q)});const ve=()=>{try{const u=localStorage.getItem("vehicle_features");if(u){const m=JSON.parse(u);M.value.rear_door=m.rear_door||!1,m.pick_up?I.value="pick_up":m.box?I.value="box":I.value=null}else M.value.rear_door=!1,I.value=null;g()}catch(u){console.error("Error loading vehicle type from localStorage:",u),M.value.rear_door=!1,I.value=null,g()}},C=()=>{M.value.rear_door=!M.value.rear_door,n()},p=u=>{I.value===u?I.value=null:I.value=u,n()},n=()=>{try{const u={rear_door:M.value.rear_door,pick_up:I.value==="pick_up",box:I.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(u)),g(),console.log("Vehicle features saved to localStorage:",u)}catch(u){console.error("Error saving vehicle type to localStorage:",u)}},g=()=>{const u={rear_door:M.value.rear_door,pick_up:I.value==="pick_up",box:I.value==="box"};x("update:vehicle-type",u)},A=u=>{if(!u){i.value="",y.value="",$.value="";return}const m=u.toUpperCase().trim(),Y=m.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(Y)i.value=Y[1]||"",y.value=Y[2]||"",$.value=Y[3]||"";else{let D="area",te="",le="",oe="";for(const se of m)D==="area"&&/[A-Z]/.test(se)?te+=se:D==="area"&&/[0-9]/.test(se)?(D="number",le+=se):D==="number"&&/[0-9]/.test(se)?le+=se:D==="number"&&/[A-Z]/.test(se)?(D="suffix",oe+=se):D==="suffix"&&/[A-Z]/.test(se)&&(oe+=se);i.value=te,y.value=le,$.value=oe}Z()},Z=()=>{const u=`${i.value}${y.value}${$.value}`;r.plate_number=u,z()},pe=u=>{u==="area"?i.value=i.value.toUpperCase().replace(/[^A-Z]/g,""):u==="number"?y.value=y.value.replace(/[^0-9]/g,""):u==="suffix"&&($.value=$.value.toUpperCase().replace(/[^A-Z]/g,"")),Z()},me=ne(()=>{const u=r.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(u)}),ie=ne(()=>!H.value||H.value.trim()===""),xe=ne(()=>r.plate_number.length>0&&!me.value?"Format plat nomor tidak valid.":null),ce=ne(()=>{const u=!r.plate_number||r.plate_number.trim()==="",m=!H.value||H.value.trim()==="";return u||m||!me.value||j.value}),de=ne(()=>{const u=r.plate_number!==v.value,m=r.car_id!==f.value||H.value!==d.value;return u||m}),be=ne(()=>de.value&&!ce.value),ge=u=>{var Y,D,te;if(!u)return"";const m=[];return(Y=u.brand)!=null&&Y.name&&m.push(u.brand.name),(D=u.model)!=null&&D.name&&m.push(u.model.name),(te=u.type)!=null&&te.name&&m.push(u.type.name),u.cc&&m.push((u.cc/1e3).toFixed(1)),u.transmission&&m.push(u.transmission),u.year&&m.push(u.year.toString()),u.fuel_type&&m.push(u.fuel_type),u.production_period&&m.push(`(${u.production_period})`),m.join(" ")},q=()=>{r.car_id&&(r.car_id=null,O.value=null,U.value=[]),Ae()},Ae=It.debounce(()=>{if(!H.value.trim()){F.value=[],E.value=!1;return}w.value=!0;try{const u=H.value.toLowerCase().trim();F.value=a.CarDetail.filter(m=>ge(m).toLowerCase().includes(u)),E.value=!0}finally{w.value=!1}},300),Ne=()=>{setTimeout(()=>{E.value=!1,r.car_name=H.value,z()},200)},c=async u=>{O.value=u,H.value=ge(u),r.car_id=u.id,r.car_name=ge(u),E.value=!1,await h(u.id),z(),x("update:hasUnsavedChanges",de.value),x("update:validation",ce.value)},_=u=>!u||!u.file_path?"":`/storage/${u.file_path}`,h=async u=>{try{const m=await fetch(`/api/cars/${u}/images`);if(m.ok){const Y=await m.json();U.value=Array.isArray(Y)?Y:[]}else U.value=[]}catch(m){console.error("Error loading car images:",m),U.value=[]}},T=u=>{J.value=u,R.value=!0,document.body.style.overflow="hidden"},P=()=>{R.value=!1,document.body.style.overflow=""},ee=()=>{J.value=(J.value+1)%U.value.length},X=()=>{J.value=(J.value-1+U.value.length)%U.value.length},Q=u=>{if(R.value)switch(u.key){case"Escape":P();break;case"ArrowRight":ee();break;case"ArrowLeft":X();break}},z=()=>{const u={plate_number:r.plate_number,car_id:r.car_id,car_name:r.car_name};x("update-vehicle",u)},re=()=>{a.inspection&&r.post(route("inspections.updateVehicleDetails",{inspection:a.inspection.id}),{preserveScroll:!0,onSuccess:()=>{v.value=r.plate_number,f.value=r.car_id,d.value=r.car_name,x("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:u=>{console.error("Gagal menyimpan data:",u)}})};return he([()=>r.plate_number,()=>r.car_name],u=>{B.value="",j.value=!1,G.value="";const m=u[0];if(m&&m.length>=6){const Y=a.allInspections.filter(D=>{var te;return D.plate_number===m&&D.id!==((te=a.inspection)==null?void 0:te.id)});if(Y.length>0){const D=["draft","in_progress","pending","pending_review","revision"],te=Y.find(le=>D.includes(le.status));if(te)j.value=!0,B.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${te.status.replace(/_/g," ").toUpperCase()}.`;else{const le=Y.filter(oe=>["approved","rejected","completed","cancelled"].includes(oe.status));if(le.length>0){le.sort((se,Ce)=>new Date(Ce.created_at)-new Date(se.created_at));const oe=le[0];if(oe.car_id){const se=a.CarDetail.find(Ce=>Ce.id===oe.car_id);se&&c(se)}else oe.car_name&&(H.value=oe.car_name,r.car_name=oe.car_name,r.car_id=null);G.value=`Nomor plat ini sudah pernah diperiksa ${le.length} kali sebelumnya.`}}}}x("update:hasUnsavedChanges",de.value),x("update:validation",ce.value)},{deep:!0}),he([()=>M.value.rear_door,()=>I.value],()=>{n()}),(u,m)=>{var Y;return s(),o("div",Lt,[m[27]||(m[27]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),t.inspection?(s(),o("div",Rt,[e("div",Bt,[m[11]||(m[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",jt,[Ve(e("input",{"onUpdate:modelValue":m[0]||(m[0]=D=>i.value=D),type:"text",placeholder:"Contoh: B",class:ae(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!me.value||j.value}]),onInput:m[1]||(m[1]=D=>pe("area")),maxlength:"2"},null,34),[[Be,i.value]]),Ve(e("input",{"onUpdate:modelValue":m[2]||(m[2]=D=>y.value=D),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:ae(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!me.value||j.value}]),onInput:m[3]||(m[3]=D=>pe("number")),maxlength:"4"},null,34),[[Be,y.value]]),Ve(e("input",{"onUpdate:modelValue":m[4]||(m[4]=D=>$.value=D),type:"text",placeholder:"ABC",class:ae(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!me.value||j.value}]),onInput:m[5]||(m[5]=D=>pe("suffix")),maxlength:"3"},null,34),[[Be,$.value]])]),xe.value?(s(),o("span",Ft,N(xe.value),1)):l("",!0),B.value?(s(),o("span",Ot,N(B.value),1)):l("",!0),G.value?(s(),o("span",qt,N(G.value),1)):l("",!0)]),e("div",Kt,[m[15]||(m[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),e("div",Ht,[e("div",{class:ae(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":M.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!M.value.rear_door}]),onClick:C},m[12]||(m[12]=[e("span",null,"Pintu Belakang",-1)]),2),e("div",Gt,[e("div",{class:ae(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":I.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.value!=="pick_up"}]),onClick:m[6]||(m[6]=D=>p("pick_up"))}," Pick Up ",2),e("div",{class:ae(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":I.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.value!=="box"}]),onClick:m[7]||(m[7]=D=>p("box"))}," Box ",2)])]),e("div",zt,[e("div",Wt,[m[14]||(m[14]=e("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",Jt,[m[13]||(m[13]=e("p",{class:"font-medium"},"Status Kendaraan:",-1)),e("p",Zt,[M.value.rear_door?(s(),o("span",Yt," âœ“ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):l("",!0),I.value==="pick_up"?(s(),o("span",Xt," âœ“ Pick Up ")):l("",!0),I.value==="box"?(s(),o("span",Qt," âœ“ Box ")):l("",!0),!M.value.rear_door&&!I.value?(s(),o("span",ea," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):l("",!0)])])])])]),e("div",ta,[m[19]||(m[19]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",aa,[Ve(e("input",{"onUpdate:modelValue":m[8]||(m[8]=D=>H.value=D),type:"text",placeholder:"Cari atau ketik nama mobil...",class:ae(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ie.value}]),onInput:q,onFocus:m[9]||(m[9]=D=>E.value=!0),onBlur:Ne},null,34),[[Be,H.value]]),w.value?(s(),o("div",na,m[16]||(m[16]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):l("",!0),ie.value?(s(),o("span",sa,"Nama mobil tidak boleh kosong.")):l("",!0),!Pe(r).car_id&&H.value?(s(),o("div",oa,m[17]||(m[17]=[Et('<div class="flex items-start" data-v-93565d5f><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-93565d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-93565d5f></path></svg><div data-v-93565d5f><p class="text-yellow-800 font-medium mb-1" data-v-93565d5f>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-93565d5f>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-93565d5f> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-93565d5f>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-93565d5f>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):l("",!0),E.value?(s(),o("div",ia,[F.value.length>0?(s(),o("div",la,[(s(!0),o($e,null,Se(F.value,D=>(s(),o("div",{key:D.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:te=>c(D)},[e("div",ua,N(ge(D)),1),e("div",da,N(D.year)+" â€¢ "+N(D.cc)+"cc â€¢ "+N(D.transmission)+" â€¢ "+N(D.fuel_type),1)],40,ra))),128))])):(s(),o("div",ca,m[18]||(m[18]=[ke(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),ke(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):l("",!0)])]),Pe(r).car_id&&O.value?(s(),o("div",pa,[O.value.description?(s(),o("div",ma,[m[20]||(m[20]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:O.value.description},null,8,ga)])):l("",!0),U.value.length>0?(s(),o("div",va,[m[21]||(m[21]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",fa,[(s(!0),o($e,null,Se(U.value,(D,te)=>(s(),o("div",{key:D.id||te,class:"relative group cursor-pointer",onClick:le=>T(te)},[e("img",{src:_(D),alt:D.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ba),D.note?(s(),o("div",ya,[e("p",xa,N(D.note),1)])):l("",!0)],8,ha))),128))])])):(s(),o("div",wa," Tidak ada gambar tersedia untuk mobil ini "))])):l("",!0),R.value?(s(),o("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:P},[e("div",ka,[e("button",{onClick:P,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},m[22]||(m[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),U.value.length>1?(s(),o("button",{key:0,onClick:Fe(X,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},m[23]||(m[23]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):l("",!0),U.value.length>1?(s(),o("button",{key:1,onClick:Fe(ee,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},m[24]||(m[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):l("",!0),e("img",{src:_(U.value[J.value]),alt:"Car Image "+(J.value+1),class:"max-w-full max-h-full object-contain",onClick:m[10]||(m[10]=Fe(()=>{},["stop"]))},null,8,Ia),U.value.length>1?(s(),o("div",$a,N(J.value+1)+" / "+N(U.value.length),1)):l("",!0),(Y=U.value[J.value])!=null&&Y.note?(s(),o("div",Sa,N(U.value[J.value].note),1)):l("",!0)])])):l("",!0),Ie(Dt,{type:"button",onClick:re,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!be.value},{default:Me(()=>[Pe(r).processing?(s(),o("svg",_a,m[25]||(m[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):l("",!0),e("span",null,N(Pe(r).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),Ie(Pt,{on:Pe(r).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Me(()=>m[26]||(m[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),ke(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):l("",!0)])}}},Bi=De(Aa,[["__scopeId","data-v-93565d5f"]]),Ca={class:"mt-1"},Ta=["value","required","minlength","maxlength","allowSpace","placeholder"],Na={key:0,class:"mt-2 text-sm text-red-600"},$t={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(t,{emit:W}){const a=t,x=W,r=ne(()=>{if(!a.modelValue)return"";let f=a.modelValue;switch(a.allowSpace||(f=f.replace(/\s+/g,"")),a.textTransform){case"uppercase":return f.toUpperCase();case"lowercase":return f.toLowerCase();case"capitalize":return f.replace(/\b\w/g,d=>d.toUpperCase());default:return f}}),v=f=>{let d=f.target.value;switch(a.allowSpace||(d=d.replace(/\s+/g,"")),a.textTransform){case"uppercase":d=d.toUpperCase();break;case"lowercase":d=d.toLowerCase();break;case"capitalize":d=d.replace(/\b\w/g,i=>i.toUpperCase());break}x("update:modelValue",d),x("save",a.pointId)};return(f,d)=>(s(),o("div",Ca,[e("input",{value:r.value,onInput:v,type:"text",required:t.required,minlength:t.minLength,maxlength:t.maxLength,allowSpace:t.allowSpace,placeholder:t.placeholder,class:ae(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:t.textTransform==="uppercase",lowercase:t.textTransform==="lowercase",capitalize:t.textTransform==="capitalize"}])},null,42,Ta),t.error?(s(),o("p",Na,N(t.error),1)):l("",!0)]))}},Ea={class:"mt-1"},Va=["value","required","min","max","step","placeholder"],Ua={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputNumber",props:{modelValue:[String,Number],required:Boolean,min:[String,Number],max:[String,Number],step:[String,Number],placeholder:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:W}){const a=t,x=W,r=v=>{const f=v.target.value;x("update:modelValue",f),x("save",a.pointId)};return(v,f)=>(s(),o("div",Ea,[e("input",{value:t.modelValue,onInput:r,type:"number",required:t.required,min:t.min,max:t.max,step:t.step,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Va),t.error?(s(),o("p",Ua,N(t.error),1)):l("",!0)]))}},Ma={class:"mt-1"},Da=["value","required","min","max"],Pa={key:0,class:"mt-2 text-sm text-red-600"},_t={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:W}){const a=t,x=W,r=v=>{x("update:modelValue",v.target.value),x("save",a.pointId)};return(v,f)=>(s(),o("div",Ma,[e("input",{value:t.modelValue,onChange:r,type:"date",required:t.required,min:t.minDate,max:t.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Da),t.error?(s(),o("p",Pa,N(t.error),1)):l("",!0)]))}},La={class:"mt-1"},Ra=["value","required","placeholder"],Ba={key:0,class:"mt-2 text-sm text-red-600"},At={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(t,{emit:W}){const a=t,x=W,r=k(""),v=ne(()=>{var $,I,M,j;return{currency_symbol:(($=a.settings)==null?void 0:$.currency_symbol)||"Rp",thousands_separator:((I=a.settings)==null?void 0:I.thousands_separator)||",",min_value:((M=a.settings)==null?void 0:M.min_value)!==void 0?Number(a.settings.min_value):0,max_value:((j=a.settings)==null?void 0:j.max_value)!==void 0?Number(a.settings.max_value):1e9}}),f=$=>{if($==null||$==="")return"";const I=Number($);if(isNaN(I))return"";let M=I.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return v.value.thousands_separator!==","&&(M=M.replace(/,/g,v.value.thousands_separator)),M},d=$=>$?$.replace(/[^\d]/g,""):"",i=ne(()=>r.value?`${v.value.currency_symbol} ${f(r.value)}`:""),y=$=>{let I=d($.target.value),M=Number(I);v.value.min_value!==void 0&&M<v.value.min_value&&(I=v.value.min_value.toString()),v.value.max_value!==void 0&&M>v.value.max_value&&(I=v.value.max_value.toString()),r.value=I,x("update:modelValue",I),x("save",a.pointId)};return he(()=>a.modelValue,$=>{$!=null&&(r.value=$.toString())},{immediate:!0}),($,I)=>(s(),o("div",La,[e("input",{value:i.value,onInput:y,type:"text",required:t.required,placeholder:t.placeholder,class:ae(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",t.error?"border-red-300":"border-gray-300"])},null,42,Ra),t.error?(s(),o("p",Ba,N(t.error),1)):l("",!0)]))}},ja={class:"mt-1 space-y-3"},Fa={key:0,class:"space-y-2"},Oa={class:"flex flex-wrap gap-2"},qa=["onClick"],Ka=["value","required","minlength","maxlength","placeholder"],Ha={class:"flex justify-between items-center mt-1"},Ga={class:"text-xs text-gray-500"},za={key:0,class:"text-xs text-red-600"},Ct={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(t,{emit:W}){const a=t,x=W,r=k([]),v=k(""),f=$=>r.value.some(I=>I.value===$),d=$=>{f($.value)?r.value=r.value.filter(B=>B.value!==$.value):r.value.push($);const M=[...r.value.map(B=>B.value)];v.value.trim()&&M.push(v.value.trim());const j=M.join(", ");x("update:modelValue",j),x("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:j})},i=$=>{const I=$.target.value;x("update:modelValue",I),x("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:I}),y(I)},y=$=>{var B,G,H,E;if(!$){r.value=[],v.value="";return}const I=$.split(",").map(w=>w.trim()).filter(w=>w),M=((G=(B=a.settings)==null?void 0:B.damage_options)==null?void 0:G.map(w=>w.value))||[];r.value=((E=(H=a.settings)==null?void 0:H.damage_options)==null?void 0:E.filter(w=>I.includes(w.value)))||[];const j=I.filter(w=>!M.includes(w));v.value=j.join(", ")};return he(()=>a.modelValue,$=>{$!=null&&y($)},{immediate:!0}),($,I)=>{var M,j,B;return s(),o("div",ja,[(M=t.settings)!=null&&M.enable_damage&&((j=t.settings)!=null&&j.damage_options)?(s(),o("div",Fa,[I[0]||(I[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",Oa,[(s(!0),o($e,null,Se(t.settings.damage_options,(G,H)=>(s(),o("button",{key:H,type:"button",onClick:E=>d(G),class:ae(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":f(G.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!f(G.value)}])},N(G.label),11,qa))),128))])])):l("",!0),e("div",null,[e("textarea",{value:t.modelValue,onInput:i,required:t.required,minlength:t.minLength,maxlength:t.maxLength,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ka),e("div",Ha,[e("span",Ga,N(((B=t.modelValue)==null?void 0:B.length)||0)+"/"+N(t.maxLength||400),1),t.error?(s(),o("p",za,N(t.error),1)):l("",!0)])])])}}},Wa={class:"mt-1"},Ja=["value","required"],Za={key:0,class:"mt-2 text-sm text-red-600"},Ya={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:W}){const a=t,x=W,r=v=>{x("update:modelValue",v.target.value),x("save",a.pointId)};return(v,f)=>(s(),o("div",Wa,[e("select",{value:t.modelValue,onChange:r,required:t.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},f[0]||(f[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Ja),t.error?(s(),o("p",Za,N(t.error),1)):l("",!0)]))}},Xa=De(Ya,[["__scopeId","data-v-1b6c0201"]]),Qa={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},en={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},tn={class:"text-xs text-gray-500 mt-2 text-center"},an={class:"flex flex-row space-x-4 mb-6"},nn={class:"mt-4 text-right"},sn={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(t){return(W,a)=>t.show?(s(),o("div",Qa,[e("div",en,[a[7]||(a[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",tn,[a[3]||(a[3]=ke("Ambil Foto Maksimal: ")),e("b",null,N(t.settings.max_files),1),a[4]||(a[4]=ke(" Dengan Rasio & Ukuran: ")),e("b",null,N(t.settings.camera_aspect_ratio),1)]),e("div",an,[e("button",{onClick:a[0]||(a[0]=x=>W.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[5]||(a[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Kamera",-1)])),e("button",{onClick:a[1]||(a[1]=x=>W.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[6]||(a[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",nn,[e("button",{onClick:a[2]||(a[2]=x=>W.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):l("",!0)}},on={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ln={class:"w-full h-full flex flex-col"},rn={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},un=["disabled"],dn={class:"text-lg font-semibold"},cn={class:"flex items-center gap-2"},pn=["disabled"],mn=["disabled"],gn={key:0,class:"bg-blue-900 bg-opacity-50 text-white p-3"},vn={class:"flex items-center justify-between mb-2"},fn={class:"text-xs"},hn={class:"w-full bg-blue-700 bg-opacity-50 rounded-full h-2"},bn={class:"text-xs mt-1 text-blue-300"},yn={class:"flex-1 flex items-center justify-center overflow-hidden relative"},xn=["src"],wn={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},kn={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},In=["disabled"],$n=["disabled"],Sn=["disabled"],_n={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},An={class:"flex justify-between items-center w-full"},Cn=["disabled"],Tn={key:1,class:"flex-1"},Nn=["disabled"],En={class:"flex gap-3 w-full"},Vn={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},Un={class:"flex items-center gap-2"},Mn={key:0,class:"text-center"},Dn={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(t,{emit:W}){const a=t,x=W,r=k(0),v=k([]),f=ne(()=>v.value.length>0?v.value[r.value]:null);he(()=>a.images,E=>{v.value=E.map(w=>({...w,rotation:w.rotation||0})),E.length===0&&a.show&&M()},{deep:!0,immediate:!0}),he(()=>a.show,E=>{E&&a.images.length>0&&(r.value=a.initialIndex)}),he(()=>a.uploadProgress,E=>{E===100&&console.log("Upload completed")});const d=E=>E.preview||(E.image_path?`/${E.image_path}`:""),i=()=>{if(f.value&&!a.isUploading){const E=(f.value.rotation+90)%360;v.value[r.value].rotation=E,x("update:images",v.value)}},y=()=>{a.isUploading||(r.value=r.value<v.value.length-1?r.value+1:0)},$=()=>{a.isUploading||(r.value=r.value>0?r.value-1:v.value.length-1)},I=()=>{a.isUploading||x("saveImages",v.value)},M=()=>{a.isUploading||x("close")},j=()=>{if(f.value&&!a.isUploading){const E=f.value,w=v.value.findIndex(F=>F.isNew&&E.isNew&&F.preview===E.preview||!F.isNew&&!E.isNew&&F.id===E.id);w!==-1&&(x("removePreviewImage",E),v.value.splice(w,1),x("update:images",v.value)),r.value>=v.value.length&&(r.value=Math.max(0,v.value.length-1)),v.value.length===0&&x("close")}},B=()=>{a.isUploading||x("triggerAddMorePhotos")},G=()=>{f.value&&!a.isUploading&&x("retryImage",f.value)},H=E=>{E.key==="Escape"&&!a.isUploading&&M()};return je(()=>{document.addEventListener("keydown",H)}),qe(()=>{document.removeEventListener("keydown",H)}),(E,w)=>{var F;return t.show?(s(),o("div",on,[e("div",ln,[e("div",rn,[e("button",{onClick:M,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},w[0]||(w[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,un),e("div",dn,N(((F=t.point)==null?void 0:F.name)||"Preview")+" ("+N(r.value+1)+"/"+N(v.value.length)+") ",1),e("div",cn,[f.value&&f.value.isNew?(s(),o("button",{key:0,onClick:j,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:t.isUploading},w[1]||(w[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,pn)):l("",!0),f.value&&f.value.isNew?(s(),o("button",{key:1,onClick:i,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},w[2]||(w[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]),8,mn)):l("",!0)])]),t.isUploading?(s(),o("div",gn,[e("div",vn,[w[3]||(w[3]=e("span",{class:"text-sm font-medium"},"Mengupload gambar...",-1)),e("span",fn,N(t.uploadProgress)+"%",1)]),e("div",hn,[e("div",{class:"bg-blue-400 h-2 rounded-full transition-all duration-300",style:Le({width:t.uploadProgress+"%"})},null,4)]),e("p",bn,N(t.currentUpload)+"/"+N(t.totalUpload)+" gambar terupload",1)])):l("",!0),e("div",yn,[e("div",{class:"relative w-full max-w-full",style:Le({paddingTop:t.aspectRatio?100/t.aspectRatio+"%":"75%"})},[f.value?(s(),o("img",{key:0,src:d(f.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:Le({transform:`rotate(${f.value.rotation}deg)`})},null,12,xn)):l("",!0),f.value&&f.value.isUploading?(s(),o("div",wn,w[4]||(w[4]=[e("div",{class:"text-center text-white"},[e("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e("p",{class:"text-sm"},"Mengupload...")],-1)]))):l("",!0),f.value&&f.value.isFailed?(s(),o("div",kn,[w[5]||(w[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),w[6]||(w[6]=e("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),e("button",{onClick:G,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:t.isUploading}," Coba Lagi ",8,In)])):l("",!0)],4),v.value.length>1&&!t.isUploading?(s(),o("button",{key:0,onClick:$,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},w[7]||(w[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,$n)):l("",!0),v.value.length>1&&!t.isUploading?(s(),o("button",{key:1,onClick:y,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},w[8]||(w[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Sn)):l("",!0)]),e("div",_n,[e("div",An,[f.value&&!f.value.isNew?(s(),o("button",{key:0,onClick:j,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:t.isUploading},w[9]||(w[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ke(" Hapus Foto ")]),8,Cn)):(s(),o("div",Tn)),t.allowMultiple&&v.value.length<t.maxFiles&&!t.isUploading?(s(),o("button",{key:2,onClick:B,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:t.isUploading},w[10]||(w[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ke(" Tambah Foto ")]),8,Nn)):l("",!0)]),e("div",En,[t.isUploading?(s(),o("button",Vn,[e("div",Un,[w[11]||(w[11]=e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),e("span",null,"Mengupload... "+N(t.uploadProgress)+"%",1)])])):(s(),o("button",{key:0,onClick:I,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),t.isUploading?(s(),o("div",Mn,w[12]||(w[12]=[e("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):l("",!0)])])])):l("",!0)}}},Pn=De(Dn,[["__scopeId","data-v-581782f4"]]),Ln={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},Rn={class:"webcam-content-box"},Bn={class:"webcam-header"},jn={class:"inspection-point-name"},Fn={key:0,class:"screen-flash-overlay"},On={key:1,class:"manual-controls-overlay"},qn={class:"manual-controls-panel"},Kn={class:"control-group"},Hn=["max"],Gn={class:"control-group"},zn=["min","max"],Wn={class:"control-value"},Jn={class:"orientation-icon"},Zn={class:"orientation-text"},Yn={key:3,class:"loading-overlay"},Xn={key:4,class:"error-overlay"},Qn={class:"error-content"},es={class:"error-message"},ts={class:"webcam-footer"},as={class:"camera-controls"},ns=["disabled"],ss={class:"camera-icon-container"},os={key:0,class:"camera-spinner"},is={key:1,class:"camera-body"},ls=["disabled"],rs={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(t,{emit:W}){const a=t,x=W,r=k(null),v=k(null);let f=null,d=null;const i=k("environment"),y=k(null),$=k([]),I=k(!1),M=k(!1),j=k(!1),B=k(!1),G=k(!1),H=k({}),E=k(!1),w=k(!1),F=k(null),O=k(!1),U=k("continuous"),R=k(0),J=k(0),ve=k(10),C=k(!1),p=k(0),n=k(-2),g=k(2),A=k(!1),Z=k("portrait"),pe=k("portrait"),me=ne(()=>{var S;return((S=a.settings)==null?void 0:S.max_size)||2048}),ie=ne(()=>Z.value==="portrait"||pe.value==="portrait"),xe=ne(()=>a.aspectRatio?{aspectRatio:`${ie.value?a.aspectRatio:1/a.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),ce=ne(()=>{if(!a.aspectRatio)return{};const S=ie.value?a.aspectRatio:1/a.aspectRatio,V=S>1?80:60,K=S>1?80/S:60*S;return{width:`${V}%`,height:`${K}%`}}),de=ne(()=>({"orientation-portrait":ie.value,"orientation-landscape":!ie.value})),be=ne(()=>ie.value?"ðŸ“±":"ðŸ”„"),ge=ne(()=>ie.value?"Portrait":"Landscape"),q=()=>{const S=()=>{pe.value=window.screen.orientation.type.includes("portrait")?"portrait":"landscape"},V=K=>{if(K.gamma!==null&&K.beta!==null){const u=Math.abs(K.gamma);Math.abs(K.beta)>45||u<45?Z.value="portrait":Z.value="landscape"}};return window.addEventListener("orientationchange",S),window.addEventListener("resize",S),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",V),S(),()=>{window.removeEventListener("orientationchange",S),window.removeEventListener("resize",S),window.removeEventListener("deviceorientation",V)}},Ae=async()=>{f&&f.getTracks().forEach(S=>S.stop()),w.value=!0,F.value=null;try{await Ne();const S={deviceId:y.value?{exact:y.value}:void 0,facingMode:y.value?void 0:{ideal:i.value},width:{ideal:1920},height:{ideal:1080},aspectRatio:{ideal:a.aspectRatio||4/3},frameRate:{ideal:30}};f=await navigator.mediaDevices.getUserMedia({video:S,audio:!1}),d=f.getVideoTracks()[0],r.value.srcObject=f,await new Promise((V,K)=>{r.value.onloadedmetadata=()=>V(),r.value.onerror=K,setTimeout(V,1e3)}),await r.value.play(),await _(),console.log("Camera initialized successfully")}catch(S){console.error("Error accessing camera: ",S),F.value=c(S)}finally{w.value=!1}},Ne=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(K=>K.stop());const V=await navigator.mediaDevices.enumerateDevices();if($.value=V.filter(K=>K.kind==="videoinput"),I.value=$.value.length>1,!y.value&&$.value.length>0){const K=$.value.find(u=>u.label.toLowerCase().includes("back")||u.label.toLowerCase().includes("rear")||u.label.toLowerCase().includes("environment"));y.value=K?K.deviceId:$.value[0].deviceId}}catch(S){console.error("Error getting camera devices:",S)}},c=S=>{switch(S.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan. Pastikan kamera terpasang dan tidak digunakan aplikasi lain.";case"NotSupportedError":return"Browser tidak mendukung akses kamera. Gunakan browser modern seperti Chrome, Firefox, atau Safari.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain. Tutup aplikasi lain yang menggunakan kamera.";case"OverconstrainedError":case"ConstraintNotSatisfiedError":return"Kamera tidak mendukung mode yang diminta. Menggunakan mode alternatif...";default:return`Error: ${S.message||"Tidak dapat mengakses kamera"}`}},_=async()=>{if(d)try{const S=d.getCapabilities();M.value=!!S.torch,S.focusMode&&S.focusMode.includes("manual")&&(C.value=!0,S.focusDistance&&(J.value=S.focusDistance.min,ve.value=S.focusDistance.max,R.value=S.focusDistance.min)),A.value=!!S.exposureCompensation}catch(S){console.error("Error checking camera capabilities:",S)}},h=async S=>{if(!d)return;const V=r.value.getBoundingClientRect(),K=S.clientX-V.left,u=S.clientY-V.top;G.value=!0,H.value={left:`${K}px`,top:`${u}px`,transform:"translate(-50%, -50%)"};try{if(d.getCapabilities().pointsOfInterest){const Y=K/V.width,D=u/V.height;await d.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:Y,y:D}]}]}),O.value=!0,U.value="manual"}}catch(m){console.warn("Manual focus failed:",m),U.value="continuous"}setTimeout(()=>{G.value=!1},2e3)},T=async S=>{if(!(!d||U.value!=="manual")){R.value=S;try{await d.applyConstraints({advanced:[{focusDistance:S}]})}catch(V){console.warn("Manual focus distance adjustment failed:",V)}}},P=async S=>{if(!(!d||!A.value)){p.value=Math.max(n.value,Math.min(g.value,S));try{await d.applyConstraints({advanced:[{exposureCompensation:p.value}]})}catch(V){console.error("Failed to set exposure compensation:",V)}}},ee=()=>{if(O.value=!1,d)try{d.applyConstraints({advanced:[{focusMode:"continuous"}]}),U.value="continuous"}catch(S){console.warn("Failed to reset to auto focus:",S)}},X=async()=>{if(!(!d||!M.value))try{i.value==="user"||await d.applyConstraints({advanced:[{torch:!j.value}]}),j.value=!j.value}catch(S){console.error("Flash toggle failed:",S)}},Q=async()=>{if(!I.value||w.value)return;w.value=!0,f&&f.getTracks().forEach(u=>u.stop());const V=($.value.findIndex(u=>u.deviceId===y.value)+1)%$.value.length;y.value=$.value[V].deviceId;const K=$.value[V];K.label.toLowerCase().includes("front")||K.label.toLowerCase().includes("user")?i.value="user":i.value="environment",await Ae()},z=async()=>{if(!(E.value||!r.value||!v.value||w.value)){E.value=!0;try{j.value&&(B.value=!0,await new Promise(fe=>setTimeout(fe,50)));const S=r.value,V=v.value,K=S.videoWidth,u=S.videoHeight;let m,Y,D,te,le,oe;if(ie.value)K/u>a.aspectRatio?(Y=u,m=u*a.aspectRatio,D=(K-m)/2,te=0):(m=K,Y=K/a.aspectRatio,D=0,te=(u-Y)/2),le=m,oe=Y;else{const fe=1/a.aspectRatio;K/u>fe?(Y=u,m=u*fe,D=(K-m)/2,te=0):(m=K,Y=K/fe,D=0,te=(u-Y)/2),le=m,oe=Y}V.width=le,V.height=oe;const se=V.getContext("2d");if(se.imageSmoothingEnabled=!0,se.imageSmoothingQuality="high",se.drawImage(S,D,te,m,Y,0,0,le,oe),p.value!==0&&A.value){const fe=se.getImageData(0,0,le,oe),Te=fe.data,Re=1+p.value*.15;for(let Ee=0;Ee<Te.length;Ee+=4)Te[Ee]=Math.min(255,Te[Ee]*Re),Te[Ee+1]=Math.min(255,Te[Ee+1]*Re),Te[Ee+2]=Math.min(255,Te[Ee+2]*Re);se.putImageData(fe,0,0)}const Ce=await new Promise(fe=>{V.toBlob(fe,"image/jpeg",.92)}),Ue=await re(Ce);if(Ue){const fe=`capture_${Date.now()}_${ie.value?"portrait":"landscape"}.jpeg`,Te=new File([Ue],fe,{type:"image/jpeg",lastModified:Date.now()});x("photoCaptured",Te)}setTimeout(()=>{B.value=!1},100)}catch(S){console.error("Error capturing photo:",S)}finally{E.value=!1}}},re=async S=>new Promise(V=>{const K=me.value*1024;if(S.size<=K){V(S);return}const u=new Image,m=new FileReader;m.onload=Y=>{u.onload=()=>{const D=document.createElement("canvas"),te=D.getContext("2d");let le=Math.sqrt(K/S.size),oe=Math.floor(u.width*le),se=Math.floor(u.height*le);oe<1200&&(oe=1200,se=Math.floor(1200/u.width*u.height)),D.width=oe,D.height=se,te.imageSmoothingEnabled=!0,te.imageSmoothingQuality="high",te.drawImage(u,0,0,oe,se);let Ce=.9;const Ue=()=>{D.toBlob(fe=>{fe.size>K&&Ce>.5?(Ce-=.1,Ue()):V(fe)},"image/jpeg",Ce)};Ue()},u.src=Y.target.result},m.readAsDataURL(S)}),ue=()=>{f&&f.getTracks().forEach(S=>S.stop()),x("close")},we=async()=>{F.value=null,await Ae()};let ye=null;return he(()=>a.show,async S=>{S?(await Ge(),ye=q(),await Ae()):(ye&&ye(),ue())}),qe(()=>{f&&f.getTracks().forEach(S=>S.stop()),ye&&ye()}),(S,V)=>{var K;return t.show?(s(),o("div",Ln,[e("div",Rn,[e("div",Bn,[e("div",jn,N(((K=t.point)==null?void 0:K.name)||"Camera"),1),e("button",{onClick:ue,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},V[4]||(V[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:Le(xe.value),onClick:h,onTouchstart:h},[e("video",{ref_key:"webcamVideo",ref:r,autoplay:"",playsinline:"",class:ae(["webcam-video",{"portrait-mode":ie.value}])},null,2),e("canvas",{ref_key:"webcamCanvas",ref:v,class:"hidden"},null,512),B.value?(s(),o("div",Fn)):l("",!0),O.value?(s(),o("div",On,[e("div",qn,[e("div",Kn,[V[5]||(V[5]=e("label",null,"Focus",-1)),Ve(e("input",{type:"range",min:"0",max:ve.value,step:"0.1","onUpdate:modelValue":V[0]||(V[0]=u=>R.value=u),onInput:V[1]||(V[1]=u=>T(parseFloat(u.target.value))),class:"control-slider"},null,40,Hn),[[Be,R.value]])]),e("div",Gn,[V[6]||(V[6]=e("label",null,"Exposure",-1)),Ve(e("input",{type:"range",min:n.value,max:g.value,step:"0.1","onUpdate:modelValue":V[2]||(V[2]=u=>p.value=u),onInput:V[3]||(V[3]=u=>P(parseFloat(u.target.value))),class:"control-slider"},null,40,zn),[[Be,p.value]]),e("span",Wn,N(p.value>0?"+":"")+N(p.value),1)]),e("button",{onClick:ee,class:"close-controls-btn"}," Tutup ")])])):l("",!0),e("div",{class:"aspect-ratio-guide",style:Le(ce.value)},null,4),G.value?(s(),o("div",{key:2,class:"focus-indicator",style:Le(H.value)},V[7]||(V[7]=[e("div",{class:"focus-ring"},null,-1)]),4)):l("",!0),e("div",{class:ae(["orientation-indicator",de.value])},[e("div",Jn,N(be.value),1),e("span",Zn,N(ge.value),1)],2),w.value?(s(),o("div",Yn,V[8]||(V[8]=[e("div",{class:"loading-spinner"},null,-1),e("p",{class:"loading-text"},"Menginisialisasi kamera...",-1)]))):l("",!0),F.value?(s(),o("div",Xn,[e("div",Qn,[V[9]||(V[9]=e("div",{class:"error-icon"},"âš ï¸",-1)),V[10]||(V[10]=e("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),e("p",es,N(F.value),1),e("button",{onClick:we,class:"retry-button"}," Coba Lagi ")])])):l("",!0)],36),e("div",ts,[e("div",as,[t.settings.enable_flash&&M.value?(s(),o("button",{key:0,onClick:X,class:ae(["control-button",{active:j.value}])},V[11]||(V[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):l("",!0),e("button",{onClick:z,class:"capture-button",disabled:E.value||w.value},[e("div",ss,[E.value?(s(),o("div",os)):(s(),o("div",is,V[12]||(V[12]=[e("div",{class:"camera-lens"},null,-1)])))])],8,ns),t.settings.enable_camera_switch&&I.value?(s(),o("button",{key:1,onClick:Q,class:"control-button",disabled:w.value},V[13]||(V[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,ls)):l("",!0)])])])])):l("",!0)}}},us=De(rs,[["__scopeId","data-v-d96b817e"]]),ds=["accept","multiple","disabled"],cs={class:"text-xs text-gray-500 mb-2"},ps=["disabled"],ms={class:"h-full flex flex-col items-center justify-center p-4 text-center"},gs={class:"text-xs text-gray-400 mt-1"},vs={key:0,class:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},fs={class:"flex items-center justify-between mb-2"},hs={class:"text-xs text-blue-600"},bs={class:"w-full bg-blue-200 rounded-full h-2"},ys={class:"text-xs text-blue-600 mt-1"},xs={key:1,class:"flex items-center gap-4"},ws=["src"],ks={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Is=["disabled"],$s={key:2,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},Ss=["disabled"],_s=["onClick"],As=["src"],Cs={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},Ts={key:0},Ns={key:1,class:"ml-1"},Es={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Vs={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Us={key:2,class:"mt-1 text-xs text-red-600"},Ms={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(t,{emit:W}){const a=t,x=W,r=k(null),v=k(null),f=k(!1),d=k(!1),i=k(!1),y=k([]),$=k(0),I=k(!1),M=k(0),j=k(0),B=k(0),G=kt("imageSourceSetting",k("all")),H=`inspection-${a.inspectionId}-point-${a.pointId}-backup`,E=ne(()=>Number(a.settings.max_files)>1),w=ne(()=>a.settings.allowed_types.map(c=>`.${c}`).join(", ")),F=ne(()=>{const c=a.settings.camera_aspect_ratio.split(":");if(c.length===2){const _=parseFloat(c[0]),h=parseFloat(c[1]);if(!isNaN(_)&&!isNaN(h)&&h!==0)return _/h}return 3/4}),O=ne(()=>{const c=[],_=new Set;for(const h of a.modelValue)h.id&&_.add(h.id),c.push({...h,rotation:h.rotation||0,isNew:!1,isUploaded:!0,preview:h.preview||(h.image_path?`/${h.image_path}`:null)});for(const h of y.value)h.id&&_.add(h.id),c.push({...h,isUploading:h.isUploading||!1});return c}),U=c=>c.preview||(c.image_path?`/${c.image_path}`:""),R=()=>{i.value&&(i.value=!1),G.value==="camera"?ve():G.value==="gallery"?J():f.value=!0},J=()=>{f.value=!1,r.value.click()},ve=()=>{f.value=!1,d.value=!0},C=()=>{f.value=!1,O.value.length>0&&(i.value=!0)},p=()=>{d.value=!1,O.value.length>0&&(i.value=!0)},n=()=>{i.value=!1,I.value||(y.value.forEach(c=>{c.preview&&c.preview.startsWith("blob:")&&URL.revokeObjectURL(c.preview)}),y.value=[])},g=c=>new Promise(_=>{const h=new FileReader;h.onload=T=>{const P=new Image;P.onload=()=>{_({file:c,preview:URL.createObjectURL(c),rotation:0,width:P.naturalWidth,height:P.naturalHeight,isNew:!0})},P.onerror=()=>{console.error("Failed to load image for dimensions:",c.name),_({file:c,preview:URL.createObjectURL(c),rotation:0,width:0,height:0,isNew:!0})},P.src=T.target.result},h.readAsDataURL(c)}),A=c=>{const _=c.name.split(".").pop().toLowerCase();return a.settings.allowed_types.includes(_)},Z=async c=>{const h=(a.settings.max_size||2048)*1024;return new Promise(T=>{const P=new Image,ee=new FileReader;ee.onload=X=>{P.onload=()=>{const Q=document.createElement("canvas"),z=Q.getContext("2d"),re=Math.max(P.width,P.height);Q.width=re,Q.height=re,z.fillStyle="white",z.fillRect(0,0,re,re);const ue=(re-P.width)/2,we=(re-P.height)/2;z.drawImage(P,ue,we,P.width,P.height);let ye=.9;const S=()=>{Q.toBlob(V=>{if(V.size>h&&ye>.1)ye-=.1,S();else{const K=new File([V],c.name,{type:"image/jpeg",lastModified:Date.now()});T(K)}},"image/jpeg",ye)};S()},P.src=X.target.result},ee.readAsDataURL(c)})},pe=async c=>{const _=Array.from(c.target.files);if(!_.length){f.value=!1,O.value.length>0&&(i.value=!0);return}try{const h=_.filter(z=>!A(z));if(h.length>0){const z=h.map(re=>re.name.split(".").pop()).join(", ");alert(`File type not allowed: ${z}. Allowed types: ${a.settings.allowed_types.join(", ")}`),c.target.value="";return}const T=O.value.length,P=a.settings.max_files-T,ee=await Promise.all(_.slice(0,P).map(async z=>await Z(z))),X=await Promise.all(ee.map(g)),Q=E.value?X:X.slice(0,1);E.value?y.value.push(...Q):(y.value.forEach(z=>{z.preview&&z.preview.startsWith("blob:")&&URL.revokeObjectURL(z.preview)}),y.value=Q),f.value=!1,Q.length>0?($.value=Math.max(0,O.value.length-Q.length),i.value=!0):O.value.length>0&&(i.value=!0),c.target.value=""}catch(h){console.error("Error processing selected images:",h),alert("Failed to process selected images. Please try again."),f.value=!1,O.value.length>0&&(i.value=!0)}},me=async c=>{const _=O.value.length;if(!E.value||_<a.settings.max_files)try{const h=await Z(c),T=new Image;T.onload=()=>{const P={file:h,preview:URL.createObjectURL(h),rotation:0,width:T.naturalWidth,height:T.naturalHeight,isNew:!0};E.value?y.value.push(P):(y.value.forEach(ee=>{ee.preview&&ee.preview.startsWith("blob:")&&URL.revokeObjectURL(ee.preview)}),y.value=[P]),d.value=!1,f.value=!1,$.value=O.value.length-1,i.value=!0},T.src=URL.createObjectURL(h)}catch(h){console.error("Error processing captured image:",h),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${a.settings.max_files} files allowed.`),d.value=!1,f.value=!1,O.value.length>0&&(i.value=!0)},ie=(c=0)=>{$.value=c,i.value=!0},xe=c=>new Promise(_=>{if(c.rotation===0||!v.value){if(!c.isNew&&!c.file){_({file:null,width:c.width,height:c.height,isOriginal:!0});return}_({file:c.file,width:c.width,height:c.height});return}const h=new Image;h.onload=async()=>{try{const T=v.value,P=T.getContext("2d"),ee=h.width,X=h.height;let Q,z;c.rotation===90||c.rotation===270?(Q=X,z=ee):(Q=ee,z=X),T.width=Q,T.height=z,P.clearRect(0,0,T.width,T.height),P.translate(T.width/2,T.height/2),P.rotate(c.rotation*Math.PI/180),P.drawImage(h,-ee/2,-X/2,ee,X),P.setTransform(1,0,0,1,0,0);const re=await new Promise(ye=>{T.toBlob(ye,"image/jpeg",.9)}),ue=new File([re],c.file?c.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),we=await Z(ue);_({file:we,width:Q,height:z})}catch(T){console.error("Error processing rotated image:",T),_({file:c.file,width:c.width,height:c.height})}},h.onerror=()=>{console.error("Failed to load image for rotation processing:",c.preview),_({file:c.file,width:c.width,height:c.height})},h.src=c.preview}),ce=c=>{try{const _={images:c.map(h=>{var T;return{fileName:((T=h.file)==null?void 0:T.name)||`image-${Date.now()}.jpg`,rotation:h.rotation||0,width:h.width||0,height:h.height||0,timestamp:Date.now()}}),inspectionId:a.inspectionId,pointId:a.pointId};localStorage.setItem(H,JSON.stringify(_))}catch(_){console.error("Error saving backup:",_)}},de=()=>{localStorage.removeItem(H)},be=async c=>{I.value=!0;const _=[],h=[];if(!a.pointId){alert("Error: Point ID is missing. Cannot upload image."),I.value=!1;return}try{ce(c);for(const T of c){if(!T.isNew&&T.rotation===0&&T.id&&T.image_path){_.push({id:T.id,image_path:T.image_path,width:T.width,height:T.height,rotation:0,preview:T.preview,isUploaded:!0});continue}const{file:P,width:ee,height:X,isOriginal:Q}=await xe(T);if(Q&&!T.isNew){_.push({id:T.id,image_path:T.image_path,width:T.width,height:T.height,rotation:T.rotation||0,preview:T.preview,isUploaded:!0});continue}P&&h.push({file:P,width:ee,height:X,rotation:T.rotation||0,originalImage:T})}n(),h.length>0?await ge(h,_):(x("update:modelValue",_),x("save",a.pointId))}catch(T){console.error("Error during image processing:",T),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{I.value=!1}},ge=async(c,_)=>{B.value=c.length,j.value=0,M.value=0;const h=[..._];let T=0;try{for(let P=0;P<c.length;P++){const ee=c[P],X=new FormData;X.append("inspection_id",a.inspectionId),X.append("point_id",a.pointId),X.append("images[]",ee.file);const Q=y.value.findIndex(z=>{var re;return z.preview===((re=ee.originalImage)==null?void 0:re.preview)});Q!==-1&&(y.value[Q].isUploading=!0,y.value[Q].isFailed=!1);try{const re=(await Ke.post(route("inspections.upload-image"),X,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:ue=>{if(ue.total){const we=Math.round(ue.loaded*100/ue.total);M.value=Math.round((P+ue.loaded/ue.total)/c.length*100),j.value=P+1}}})).data.images;if(re&&re.length>0){const ue=re[0];if(h.push({id:ue.image_id,image_path:ue.path,width:ue.width||ee.width||0,height:ue.height||ee.height||0,rotation:ee.rotation||0,preview:ue.public_url,isUploaded:!0}),Q!==-1){const we=y.value.splice(Q,1)[0];we.preview&&we.preview.startsWith("blob:")&&URL.revokeObjectURL(we.preview)}T++}}catch(z){console.error(`Error uploading image ${P+1}:`,z),Q!==-1&&(y.value[Q].isUploading=!1,y.value[Q].isFailed=!0)}}T>0&&(x("update:modelValue",h),x("save",a.pointId),x("uploaded",{pointId:a.pointId,images:h,newImagesCount:T})),T===c.length&&de(),console.log(`âœ… Successfully uploaded ${T}/${c.length} images`)}catch(P){console.error("Error in upload process:",P),c.forEach(ee=>{const X=y.value.findIndex(Q=>{var z;return Q.preview===((z=ee.originalImage)==null?void 0:z.preview)});X!==-1&&(y.value[X].isUploading=!1,y.value[X].isFailed=!0)})}finally{M.value=0,j.value=0,B.value=0,I.value=!1}},q=async c=>{if(!c||!c.file){console.error("No file to retry upload");return}I.value=!0;const _=[...a.modelValue];try{const h=new FormData;h.append("inspection_id",a.inspectionId),h.append("point_id",a.pointId),h.append("images[]",c.file);const T=y.value.findIndex(X=>X.preview===c.preview);T!==-1&&(y.value[T].isUploading=!0,y.value[T].isFailed=!1);const ee=(await Ke.post(route("inspections.upload-image"),h,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(ee&&ee.length>0){const X=ee[0];if(_.push({id:X.image_id,image_path:X.path,width:X.width||c.width||0,height:X.height||c.height||0,rotation:c.rotation||0,preview:X.public_url,isUploaded:!0}),T!==-1){const z=y.value.splice(T,1)[0];z.preview&&z.preview.startsWith("blob:")&&URL.revokeObjectURL(z.preview)}x("update:modelValue",_),x("save",a.pointId),x("uploaded",{pointId:a.pointId,images:_,newImagesCount:1}),y.value.some(z=>z.isFailed)||de(),console.log("âœ… Successfully retried upload for 1 image")}}catch(h){console.error("Error retrying upload:",h),previewIndex!==-1&&(y.value[previewIndex].isUploading=!1,y.value[previewIndex].isFailed=!0)}finally{I.value=!1}},Ae=c=>{if(c){if(c.id&&!c.isNew)Ne(c);else{const _=y.value.findIndex(h=>h.preview&&h.preview===c.preview&&h.isNew||h.id&&h.id===c.id);if(_!==-1){const h=y.value.splice(_,1)[0];h.preview&&h.preview.startsWith("blob:")&&URL.revokeObjectURL(h.preview)}x("update:modelValue",a.modelValue.filter(h=>!(h.id&&h.id===c.id)&&!(h.preview&&h.preview===c.preview)))}$.value>=O.value.length&&($.value=Math.max(0,O.value.length-1)),O.value.length===0&&n()}},Ne=async c=>{var h,T;if(c.id||c.image_path)try{await Ke.delete(route("inspections.delete-image"),{data:{image_id:c.id,image_path:c.image_path}})}catch(P){console.error("Error deleting image from server:",P),(T=(h=P.response)==null?void 0:h.data)!=null&&T.message?alert(`Failed to delete image from server: ${P.response.data.message}`):alert(`Failed to delete image from server: ${P.message}`);return}c.preview&&c.preview.startsWith("blob:")&&URL.revokeObjectURL(c.preview);const _=a.modelValue.filter(P=>P.id!==c.id);x("update:modelValue",_),y.value=y.value.filter(P=>P.isNew&&c.isNew?P.preview!==c.preview:P.id!==c.id),x("removeImage",{image:c}),i.value&&O.value.length===0?n():i.value&&$.value>=O.value.length&&($.value=Math.max(0,O.value.length-1))};return je(()=>{try{localStorage.getItem(H)&&console.log("Found backup images, ready for recovery if needed")}catch(c){console.error("Error loading backup:",c)}}),(c,_)=>(s(),o("div",null,[e("input",{ref_key:"galleryInput",ref:r,type:"file",accept:w.value,class:"hidden",onChange:pe,multiple:E.value,disabled:I.value},null,40,ds),e("canvas",{ref_key:"processingCanvas",ref:v,class:"hidden"},null,512),e("p",cs,"Foto Maksimal: "+N(t.settings.max_files)+" | Rasio: "+N(t.settings.camera_aspect_ratio),1),O.value.length===0?(s(),o("label",{key:0,onClick:R,class:ae(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:I.value},[e("div",ms,[_[2]||(_[2]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),_[3]||(_[3]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",gs,"Tipe: "+N(w.value),1)])],8,ps)):(s(),o("div",{key:1,class:ae(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":t.settings.max_files==1,"bg-transparent":t.settings.max_files>1}]),"aria-label":"Image gallery"},[I.value?(s(),o("div",vs,[e("div",fs,[_[4]||(_[4]=e("span",{class:"text-sm font-medium text-blue-700"},"Mengupload gambar...",-1)),e("span",hs,N(M.value)+"%",1)]),e("div",bs,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:Le({width:M.value+"%"})},null,4)]),e("p",ys,N(j.value)+"/"+N(B.value)+" gambar terupload",1)])):l("",!0),t.settings.max_files===1?(s(),o("div",xs,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:_[0]||(_[0]=h=>ie(0))},[e("img",{src:U(O.value[0]),class:"w-full h-full object-cover"},null,8,ws),O.value[0].isUploading?(s(),o("div",ks,_[5]||(_[5]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):l("",!0)]),e("button",{onClick:_[1]||(_[1]=Fe(h=>Ne(O.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:I.value},_[6]||(_[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ke(" Hapus Foto ")]),8,Is)])):(s(),o("div",$s,[E.value&&O.value.length<t.settings.max_files?(s(),o("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:R,disabled:I.value},_[7]||(_[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,Ss)):l("",!0),(s(!0),o($e,null,Se(O.value,(h,T)=>(s(),o("div",{key:h.id||h.preview,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:P=>h.isFailed?q(h):ie(T)},[e("img",{src:U(h),class:"w-full h-full object-cover"},null,8,As),h.isNew||h.rotation!==0?(s(),o("div",Cs,[h.isNew?(s(),o("span",Ts,"BARU")):l("",!0),h.rotation!==0?(s(),o("span",Ns,"ROTASI")):l("",!0)])):l("",!0),h.isUploading?(s(),o("div",Es,_[8]||(_[8]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):l("",!0),h.isFailed?(s(),o("div",Vs,_[9]||(_[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"text-xs font-medium"},"Retry",-1)]))):l("",!0)],8,_s))),128))]))],2)),t.error?(s(),o("p",Us,N(t.error),1)):l("",!0),Ie(sn,{show:f.value,settings:t.settings,onClose:C,onOpenWebcam:ve,onTriggerGallery:J},null,8,["show","settings"]),Ie(us,{show:d.value,"aspect-ratio":F.value,settings:t.settings,point:t.point,onClose:p,onPhotoCaptured:me},null,8,["show","aspect-ratio","settings","point"]),Ie(Pn,{show:i.value,images:O.value,point:t.point,"initial-index":$.value,"allow-multiple":E.value,"max-files":t.settings.max_files,"is-uploading":I.value,"aspect-ratio":F.value,"upload-progress":M.value,"current-upload":j.value,"total-upload":B.value,onClose:n,onSaveImages:be,onRemovePreviewImage:Ae,onTriggerAddMorePhotos:R,onRetryImage:q},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},ze=De(Ms,[["__scopeId","data-v-3180dd6e"]]),Ds={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Ps={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Ls={class:"px-4 pb-2 border-b border-gray-200"},Rs={class:"text-lg font-semibold text-gray-900"},Bs={key:0,class:"text-sm text-gray-500 mt-1"},js={class:"flex-1 overflow-y-auto p-4"},Fs={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Os={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(t){return(W,a)=>(s(),_e(Oe,{name:"bottom-sheet"},{default:Me(()=>[t.show?(s(),o("div",Ds,[a[1]||(a[1]=e("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),e("div",Ps,[a[0]||(a[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Ls,[e("h3",Rs,N(t.title),1),t.subtitle?(s(),o("p",Bs,N(t.subtitle),1)):l("",!0)]),e("div",js,[xt(W.$slots,"default",{},void 0,!0)]),W.$slots.footer?(s(),o("div",Fs,[xt(W.$slots,"footer",{},void 0,!0)])):l("",!0)])])):l("",!0)]),_:3}))}},qs=De(Os,[["__scopeId","data-v-fd942535"]]),Ks={class:"space-y-4"},Hs={key:0,class:"mt-2"},Gs={key:1,class:"mt-2"},zs={key:2,class:"mt-2"},Ws={key:3,class:"mt-2"},Js={key:4,class:"mt-2"},Zs={class:"text-sm font-medium text-gray-700 mb-2"},Ys={key:0,class:"text-red-500"},Xs={key:0,class:"text-xs text-red-500"},Qs=["name","value","checked"],eo={key:6,class:"space-y-2"},to={key:0,class:"text-red-500"},ao={key:1,class:"text-xs text-red-500"},no={key:7,class:"mt-4"},so={class:"text-sm font-medium text-gray-700 mb-2"},oo={key:0,class:"text-red-500"},io={key:0,class:"text-xs text-red-500"},lo={class:"flex gap-2"},ro=["disabled"],Tt={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:String,notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(t,{emit:W}){const a=t,x=W,r=d=>x("hapus",d),v=ne(()=>a.options.find(d=>d.value===a.selectedValue)),f=ne(()=>{var i,y,$,I,M,j,B;if(a.point.input_type==="text"&&(!((i=a.notesValue)!=null&&i.trim())||a.point.settings.min_length&&a.notesValue.length<a.point.settings.min_length||a.point.settings.max_length&&a.notesValue.length>a.point.settings.max_length)||a.point.input_type==="number"&&(!((y=a.notesValue)!=null&&y.trim())||a.point.settings.min&&a.notesValue.length<a.point.settings.min||a.point.settings.max&&a.notesValue.length>a.point.settings.max)||a.point.input_type==="account"&&(!(($=a.notesValue)!=null&&$.trim())||a.point.settings.min_value&&a.notesValue.length<a.point.settings.min_value||a.point.settings.max_value&&a.notesValue.length>a.point.settings.max_value)||a.point.input_type==="date"&&(!((I=a.notesValue)!=null&&I.trim())||a.point.settings.min_date&&a.notesValue.length<a.point.settings.min_date||a.point.settings.max_date&&a.notesValue.length>a.point.settings.max_date))return!1;if(a.point.input_type==="imageTOradio"){if(a.imagesValue.length===0)return!1;const G=a.imagesValue.some(E=>E.status==="error"),H=a.imagesValue.some(E=>E.status==="uploading");if(G||H)return!1}if(a.options.length&&!a.selectedValue)return!1;const d=v.value;if(a.showTextarea&&((M=d==null?void 0:d.settings)!=null&&M.show_textarea)&&(!((j=a.notesValue)!=null&&j.trim())||d.settings.min_length&&a.notesValue.length<d.settings.min_length||d.settings.max_length&&a.notesValue.length>d.settings.max_length))return!1;if(a.showImageUpload&&((B=d==null?void 0:d.settings)!=null&&B.show_image_upload)){if(a.imagesValue.length===0||d.settings.max_files&&a.imagesValue.length>d.settings.max_files)return!1;const G=a.imagesValue.some(E=>E.status==="error"),H=a.imagesValue.some(E=>E.status==="uploading");if(G||H)return!1}return!0});return(d,i)=>(s(),_e(qs,{show:t.show,title:t.title,subtitle:t.subtitle,onClose:i[18]||(i[18]=y=>d.$emit("close"))},{footer:Me(()=>[t.selectedPoint?(s(),o("button",{key:0,onClick:i[15]||(i[15]=y=>r(t.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},i[20]||(i[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),ke(" Hapus Data ")]))):l("",!0),e("div",lo,[e("button",{type:"button",onClick:i[16]||(i[16]=y=>d.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:i[17]||(i[17]=y=>d.$emit("save")),disabled:!f.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,ro)])]),default:Me(()=>{var y,$,I,M,j,B,G,H,E,w,F,O,U,R,J,ve,C,p,n,g,A,Z,pe,me,ie,xe,ce,de,be,ge;return[e("div",Ks,[t.point.input_type==="text"?(s(),o("div",Hs,[Ie($t,{"model-value":t.notesValue,required:(y=t.point.settings)==null?void 0:y.is_required,"min-length":($=t.point.settings)==null?void 0:$.min_length,"max-length":(I=t.point.settings)==null?void 0:I.max_length,allowSpace:(M=t.point.settings)==null?void 0:M.allow_space,textTransform:(j=t.point.settings)==null?void 0:j.text_transform,placeholder:((B=t.point.settings)==null?void 0:B.placeholder)||"Masukan text",error:d.error,"onUpdate:modelValue":i[0]||(i[0]=q=>d.$emit("update:notesValue",q)),onSave:i[1]||(i[1]=q=>d.$emit("saveText",q))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):l("",!0),t.point.input_type==="number"?(s(),o("div",Gs,[Ie(St,{"model-value":t.notesValue,required:(G=t.point.settings)==null?void 0:G.is_required,min:(H=t.point.settings)==null?void 0:H.min,max:(E=t.point.settings)==null?void 0:E.max,step:((w=t.point.settings)==null?void 0:w.step)||1,placeholder:((F=t.point.settings)==null?void 0:F.placeholder)||"Masukan number",error:d.error,"onUpdate:modelValue":i[2]||(i[2]=q=>d.$emit("update:notesValue",q)),onSave:i[3]||(i[3]=q=>d.$emit("saveNumber",q))},null,8,["model-value","required","min","max","step","placeholder","error"])])):l("",!0),t.point.input_type==="account"?(s(),o("div",zs,[Ie(At,{"model-value":t.notesValue,required:(O=t.point.settings)==null?void 0:O.is_required,placeholder:((U=t.point.settings)==null?void 0:U.placeholder)||"Masukkan nilai",error:d.error,"point-id":t.pointId,settings:t.point.settings,"onUpdate:modelValue":i[4]||(i[4]=q=>d.$emit("update:notesValue",q)),onSave:i[5]||(i[5]=q=>d.$emit("saveAccount",q))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):l("",!0),t.point.input_type==="date"?(s(),o("div",Ws,[Ie(_t,{"model-value":t.notesValue,required:(R=t.point.settings)==null?void 0:R.is_required,"min-date":(J=t.point.settings)==null?void 0:J.min_date,"max-date":(ve=t.point.settings)==null?void 0:ve.max_date,error:d.error,"onUpdate:modelValue":i[6]||(i[6]=q=>d.$emit("update:notesValue",q)),onSave:i[7]||(i[7]=q=>d.$emit("saveDate",q))},null,8,["model-value","required","min-date","max-date","error"])])):l("",!0),t.point.input_type==="imageTOradio"?(s(),o("div",Js,[e("h4",Zs,[(C=t.point.settings)!=null&&C.required?(s(),o("span",Ys,"*")):l("",!0)]),Ie(ze,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point.inspection_point,"inspection-id":t.inspectionId,settings:t.point.settings,"onUpdate:modelValue":i[8]||(i[8]=q=>d.$emit("update:imagesValue",q)),onSave:i[9]||(i[9]=q=>d.$emit("saveImage",q))},null,8,["model-value","point-id","point","inspection-id","settings"]),(p=t.point.settings)!=null&&p.required&&t.imagesValue.length===0?(s(),o("p",Xs," Foto wajib diupload ")):l("",!0)])):l("",!0),t.options.length?(s(),o("div",{key:5,class:ae(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o($e,null,Se(t.options,(q,Ae)=>(s(),o("label",{key:Ae,class:"cursor-pointer"},[e("input",{type:"radio",name:t.name,value:q.value,checked:t.selectedValue===q.value,onChange:i[10]||(i[10]=Ne=>d.$emit("update:selectedValue",Ne.target.value)),class:"hidden peer"},null,40,Qs),e("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.selectedValue===q.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.selectedValue!==q.value}])},N(q.label),3)]))),128))],2)):l("",!0),t.showTextarea&&((g=(n=v.value)==null?void 0:n.settings)!=null&&g.show_textarea)?(s(),o("div",eo,[(A=v.value.settings)!=null&&A.required?(s(),o("span",to,"*")):l("",!0),Ie(Ct,{"model-value":t.notesValue,"point-id":t.pointId,"inspection-id":t.inspectionId,settings:v.value.settings,required:(Z=v.value.settings)==null?void 0:Z.required,"min-length":(pe=v.value.settings)==null?void 0:pe.min_length,"max-length":(me=v.value.settings)==null?void 0:me.max_length,placeholder:((ie=v.value.settings)==null?void 0:ie.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":i[11]||(i[11]=q=>d.$emit("update:notesValue",q)),onSave:i[12]||(i[12]=q=>d.$emit("saveTextarea",q))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(xe=v.value.settings)!=null&&xe.required&&!t.notesValue?(s(),o("p",ao," Keterangan wajib diisi ")):l("",!0)])):l("",!0),t.showImageUpload&&((de=(ce=v.value)==null?void 0:ce.settings)!=null&&de.show_image_upload)?(s(),o("div",no,[e("h4",so,[i[19]||(i[19]=ke(" Upload Foto ")),(be=v.value.settings)!=null&&be.required?(s(),o("span",oo,"*")):l("",!0)]),Ie(ze,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,settings:v.value.settings,"onUpdate:modelValue":i[13]||(i[13]=q=>d.$emit("update:imagesValue",q)),onSave:i[14]||(i[14]=q=>d.$emit("saveImage",q))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ge=v.value.settings)!=null&&ge.required&&t.imagesValue.length===0?(s(),o("p",io," Foto wajib diupload ")):l("",!0)])):l("",!0)])]}),_:1},8,["show","title","subtitle"]))}},uo={class:"mt-2 space-y-2"},co=["name","value","checked","onChange","required"],po={key:0,class:"p-2 rounded-lg bg-gray-50"},mo={key:0,class:"mt-2"},go={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},vo=["src"],fo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},ho={key:1,class:"mt-2"},bo={class:"text-sm text-gray-600"},yo={key:2,class:"mt-2 text-sm text-red-600"},xo={__name:"InputRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:W}){const a=t,x=W,r=k(a.notes),v=k([...a.images]),f=k(!1),d=k(""),i=k([]),y=k(""),$=k([]),I=ne(()=>a.options.find(U=>U.value===a.modelValue)),M=U=>U.settings&&(U.settings.show_textarea||U.settings.show_image_upload);he(()=>a.notes,U=>{r.value=U}),he(()=>a.images,U=>{v.value=[...U]}),he(()=>a.modelValue,U=>{U&&(y.value=U)});const j=U=>{x("update:modelValue",U.value),M(U)?G():x("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:U.value,notes:"",images:[]})},B=U=>U.preview||(U.image_path?`/${U.image_path}`:U),G=()=>{y.value=a.modelValue,d.value=r.value,i.value=[...v.value],$.value=[...v.value],f.value=!0},H=()=>{d.value="",i.value=[],y.value="",f.value=!1},E=U=>{i.value=U,v.value=[...U],x("update:images",[...U]),x("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:r.value,images:[...U]})},w=U=>{},F=()=>{y.value!==a.modelValue&&x("update:modelValue",y.value),r.value=d.value,x("update:notes",d.value),v.value=[...i.value],x("update:images",[...i.value]),x("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:y.value,notes:d.value,images:i.value}),f.value=!1},O=U=>{y.value="",d.value="",i.value=[],r.value="",v.value=[],x("update:modelValue",""),x("update:notes",""),x("update:images",[]),x("hapus",U),f.value=!1};return(U,R)=>{var J,ve,C;return s(),o("div",uo,[e("div",{class:ae(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o($e,null,Se(t.options,(p,n)=>(s(),o("label",{key:n,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:p.value,checked:t.modelValue===p.value,onChange:g=>j(p),class:"hidden peer",required:t.required},null,40,co),e("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===p.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==p.value}])},N(p.label),3)]))),128))],2),t.modelValue&&I.value&&M(I.value)?(s(),o("div",po,[e("div",{class:"flex justify-between items-start"},[R[4]||(R[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:G,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),t.images.length>0&&((J=I.value.settings)!=null&&J.show_image_upload)?(s(),o("div",mo,[e("div",go,[(s(!0),o($e,null,Se(t.images,(p,n)=>(s(),o("div",{key:n,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:B(p),class:"w-full h-full object-cover rounded"},null,8,vo),n===3&&t.images.length>4?(s(),o("span",fo," +"+N(t.images.length-4),1)):l("",!0)]))),128))])])):l("",!0),t.notes&&((ve=I.value.settings)!=null&&ve.show_textarea)?(s(),o("div",ho,[e("p",bo,N(t.notes),1)])):l("",!0)])):l("",!0),f.value?(s(),_e(Tt,{key:(C=t.selectedPoint)==null?void 0:C.id,show:f.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":y.value,"notes-value":d.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":R[0]||(R[0]=p=>y.value=p),"onUpdate:notesValue":R[1]||(R[1]=p=>d.value=p),"onUpdate:imagesValue":R[2]||(R[2]=p=>E(p)),onClose:H,onSave:F,onSaveTextarea:U.handleTextareaSave,onSaveImage:w,onHapus:R[3]||(R[3]=p=>O(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):l("",!0),t.error?(s(),o("p",yo,N(t.error),1)):l("",!0)])}}},wo={class:"mt-2 space-y-2"},ko={key:0,class:"flex flex-wrap gap-3"},Io={key:1,class:"p-2"},$o={key:0,class:"mt-2"},So={class:"flex gap-2 overflow-x-auto scrollbar-hide"},_o=["src"],Ao={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Co=["name","value","checked"],To={key:1,class:"mt-2"},No={class:"text-sm text-gray-600"},Eo={key:3,class:"mt-2 text-sm text-red-600"},Vo={__name:"InputImageToRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:W}){const a=t,x=W,r=k(a.notes),v=k([...a.images]),f=k(!1),d=k(""),i=k([]),y=k(""),$=k([]),I=ne(()=>a.options.find(w=>w.value===a.modelValue)),M=w=>w.preview||(w.image_path?`/${w.image_path}`:w);he(()=>a.notes,w=>{r.value=w});const j=()=>{y.value=a.modelValue||"",d.value=r.value,i.value=[...v.value],$.value=[...v.value],f.value=!0},B=()=>{d.value="",i.value=[],y.value="",f.value=!1},G=w=>{i.value=w,v.value=[...w],x("update:images",[...w]),x("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:r.value,images:[...w]})},H=()=>{y.value!==a.modelValue&&x("update:modelValue",y.value),r.value=d.value,x("update:notes",d.value),v.value=[...i.value],x("update:images",[...i.value]),x("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:y.value,notes:d.value,images:i.value}),f.value=!1},E=w=>{y.value="",d.value="",i.value=[],r.value="",v.value=[],x("update:modelValue",""),x("update:notes",""),x("update:images",[]),x("hapus",w),f.value=!1};return(w,F)=>{var O,U;return s(),o("div",wo,[!t.modelValue&&v.value.length===0&&!r.value?(s(),o("div",ko,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:j},F[4]||(F[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(s(),o("div",Io,[e("div",{class:"flex justify-between items-start"},[F[5]||(F[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:j,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),v.value.length>0?(s(),o("div",$o,[e("div",So,[(s(!0),o($e,null,Se(v.value,(R,J)=>(s(),o("div",{key:J,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:M(R),class:"w-full h-full object-cover rounded"},null,8,_o),J===3&&v.value.length>4?(s(),o("span",Ao," +"+N(v.value.length-4),1)):l("",!0)]))),128))])])):l("",!0),e("div",{class:ae(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o($e,null,Se(t.options,(R,J)=>(s(),o("label",{key:J,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:R.value,checked:t.modelValue===R.value,disabled:!0,class:"hidden peer"},null,8,Co),e("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===R.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==R.value}])},N(R.label),3)]))),128))],2),r.value&&((O=I.value.settings)!=null&&O.show_textarea)?(s(),o("div",To,[e("p",No,N(r.value),1)])):l("",!0)])),f.value?(s(),_e(Tt,{key:(U=t.selectedPoint)==null?void 0:U.id,show:f.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":y.value,"notes-value":d.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":F[0]||(F[0]=R=>y.value=R),"onUpdate:notesValue":F[1]||(F[1]=R=>d.value=R),"onUpdate:imagesValue":F[2]||(F[2]=R=>G(R)),onClose:B,onSave:H,onHapus:F[3]||(F[3]=R=>E(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):l("",!0),t.error?(s(),o("p",Eo,N(t.error),1)):l("",!0)])}}},Uo={class:"text-base font-semibold text-indigo-700"},Mo={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Do={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Po={class:"text-base font-semibold text-indigo-700"},Lo={class:"p-4 space-y-4"},Ro={key:0,class:"flex justify-end py-1"},Bo=["onClick"],jo={key:1,class:"space-y-2"},Fo={class:"flex items-start justify-between"},Oo={class:"flex-1"},qo={class:"block text-sm font-medium text-gray-700"},Ko={key:0,class:"text-red-500"},Ho={key:1,class:"italic text-xs text-gray-400 ml-2"},Go={key:0,class:"mt-1"},zo={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Wo={key:0},Jo={key:1},Zo={key:2},Yo={key:3},Xo={key:4},Qo={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},ei={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},ti={class:"text-xs mt-1 list-disc list-inside"},ai={key:0},ni={key:1},si={key:2},oi={key:3},ii={key:4},li={key:0,class:"text-center py-8 text-gray-500"},ri={key:0,class:"text-xs text-gray-400"},ui={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(t,{emit:W}){const a=t,x=W,r=kt("vehicleFeatures",k(null));r.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Vt("vehicleFeatures",r);const v=k(!1),f=k([]),d=k(!0),i=k(null),y=Ut(),$={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};je(()=>{const C=new IntersectionObserver(([p])=>{d.value=p.isIntersecting},{threshold:.1});i.value&&C.observe(i.value),qe(()=>{i.value&&C.unobserve(i.value)})});const I=()=>{v.value=!v.value,v.value||(f.value=[])},M=ne(()=>(a.category.points||[]).some(C=>C.is_default===!1)),j=C=>!C||!Array.isArray(C)?[]:C.map(p=>$[p]||p),B=C=>{var A,Z;const p=C.settings;if(!G(C))return!0;const n=(A=a.car)==null?void 0:A.transmission,g=(Z=a.car)==null?void 0:Z.fuel_type;return!(p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0&&n&&!p.transmission.includes(n)||p.fuel_type&&p.fuel_type.trim()!==""&&g&&p.fuel_type!==g||p.rear_door&&(!r.value||!r.value.rear_door)||p.pick_up&&(!r.value||!r.value.pick_up)||p.box&&(!r.value||!r.value.box))},G=C=>{const p=C.settings;return!!(p!=null&&p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0||p!=null&&p.fuel_type&&p.fuel_type.trim()!==""||p!=null&&p.rear_door||p!=null&&p.pick_up||p!=null&&p.box)},H=C=>G(C)&&(v.value||B(C)),E=ne(()=>{const C=a.category.points||[],p=[];let n=[];return v.value?a.category.isDamageMenu?C.filter(g=>{var A;return g.is_default||F((A=g.inspection_point)==null?void 0:A.id)||v.value}):C:a.category.isDamageMenu?C.filter(g=>{var Z;const A=(Z=g.inspection_point)==null?void 0:Z.id;return F(A)||g.is_default||f.value.includes(A)}):(C.forEach(g=>{var ce;const A=(ce=g.inspection_point)==null?void 0:ce.id,Z=F(A),pe=f.value.includes(A),ie=!G(g)||B(g);(g.is_default||Z||pe)&&ie?(n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(de=>de.inspection_point.id)}),n.forEach(de=>{f.value.includes(de.inspection_point.id)&&p.push(de)}),n=[]),p.push(g)):(!G(g)||B(g))&&n.push(g)}),n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(g=>g.inspection_point.id)}),n.forEach(g=>{f.value.includes(g.inspection_point.id)&&p.push(g)})),p.filter(g=>{var A,Z;return g.is_link||g.is_default||F((A=g.inspection_point)==null?void 0:A.id)||f.value.includes((Z=g.inspection_point)==null?void 0:Z.id)}))});ne(()=>E.value.filter(C=>!C.is_link));const w=C=>{v.value=!1,C.forEach(p=>{f.value.includes(p)||f.value.push(p)})},F=C=>{if(!C)return!1;const p=y.props.existingResults[C]!==void 0,n=y.props.existingImages[C]&&y.props.existingImages[C].length>0,g=a.form.results[C]&&(a.form.results[C].status||a.form.results[C].note),A=a.form.images[C]&&a.form.images[C].length>0;return p||n||g||A},O=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],U=C=>{var g,A,Z,pe,me,ie,xe,ce,de;const p=a.form.results[(g=C.inspection_point)==null?void 0:g.id],n=a.form.images[(A=C.inspection_point)==null?void 0:A.id];if(!p)return!1;switch(C.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!p.note;case"select":case"radio":if(!p.status)return!1;const be=(pe=(Z=C.settings)==null?void 0:Z.radios)==null?void 0:pe.find(q=>q.value===p.status);return!(be!=null&&be.settings&&(be.settings.show_textarea&&!((me=p.note)!=null&&me.trim())||be.settings.show_image_upload&&(n==null?void 0:n.length)===0));case"imageTOradio":if((n==null?void 0:n.length)===0||!p.status)return!1;const ge=(xe=(ie=C.settings)==null?void 0:ie.radios)==null?void 0:xe.find(q=>q.value===p.status);return!(ge!=null&&ge.settings&&ge.settings.show_textarea&&!((ce=p.note)!=null&&ce.trim()));case"image":return(n==null?void 0:n.length)>0;default:return!!p.status||!!((de=p.note)!=null&&de.trim())}},R=(C,p,n)=>{x("updateResult",{pointId:C,type:n,value:p})},J=C=>{console.log("Save result for point:",C)},ve=C=>{x("hapusPoint",C)};return he(()=>a.form.results,C=>{},{deep:!0}),he(()=>a.form.images,C=>{},{deep:!0}),he(()=>a.car,C=>{console.log("Car data updated:",C)},{deep:!0}),he(r,C=>{console.log("Vehicle features updated:",C)},{deep:!0}),(C,p)=>(s(),o($e,null,[a.head==="vertical"?(s(),o("div",{key:0,class:ae(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[e("h4",Uo,N(t.category.name),1),M.value?(s(),o("button",{key:0,onClick:I,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},N(v.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):l("",!0)])):l("",!0),e("div",{class:ae(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",a.head==="vertical"?"pt-6":""])},[!d.value&&M.value?(s(),o("button",{key:0,onClick:I,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[v.value?(s(),o("svg",Mo,p[0]||(p[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(s(),o("svg",Do,p[1]||(p[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):l("",!0),a.head==="horizontal"?(s(),o("div",{key:1,ref_key:"categoryHeader",ref:i,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",Po,N(t.category.name),1),M.value?(s(),o("button",{key:0,onClick:I,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},N(v.value?"Sembunyikan":"Tampilkan Point Lain"),1)):l("",!0)],512)):l("",!0),e("div",Lo,[(s(!0),o($e,null,Se(E.value,(n,g)=>{var A,Z,pe,me,ie,xe,ce,de,be,ge,q,Ae,Ne,c,_,h,T,P,ee,X,Q,z,re,ue,we,ye,S,V,K,u,m,Y,D,te,le,oe,se,Ce,Ue,fe,Te,Re,Ee,We,Je,Ze,Ye,Xe,Qe,et,tt,at,nt,st,ot,it,lt,rt,ut,dt,ct,pt,mt,gt,vt,ft,ht,bt,yt;return s(),o("div",{key:g,class:ae(["space-y-2 last:border-0 last:pb-0",n.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[n.is_link?(s(),o("div",Ro,[e("button",{onClick:L=>w(n.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+N(n.count)+" Point Tersembunyi ",9,Bo)])):(s(),o("div",jo,[e("div",Fo,[e("div",Oo,[e("label",qo,[ke(N((A=n.inspection_point)==null?void 0:A.name)+" ",1),(Z=n.settings)!=null&&Z.is_required?(s(),o("span",Ko,"*")):l("",!0),!n.is_default&&!F((pe=n.inspection_point)==null?void 0:pe.id)?(s(),o("span",Ho," (opsional) ")):l("",!0)]),H(n)?(s(),o("div",Go,[G(n)?(s(),o("div",zo,[(me=n.settings)!=null&&me.transmission?(s(),o("div",Wo,N(n.settings.transmission.join(", ")),1)):l("",!0),(ie=n.settings)!=null&&ie.fuel_type?(s(),o("div",Jo,N(n.settings.fuel_type),1)):l("",!0),(xe=n.settings)!=null&&xe.rear_door?(s(),o("div",Zo," Pintu Belakang ")):l("",!0),(ce=n.settings)!=null&&ce.pick_up?(s(),o("div",Yo," Tipe Pick Up ")):l("",!0),(de=n.settings)!=null&&de.box?(s(),o("div",Xo," Memiliki Box ")):l("",!0)])):l("",!0)])):l("",!0)]),U(n)?(s(),o("span",Qo," âœ“ ")):l("",!0)]),n.input_type==="text"&&B(n)?(s(),_e($t,{key:0,modelValue:t.form.results[(be=n.inspection_point)==null?void 0:be.id].note,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"note")}],required:(ge=n.settings)==null?void 0:ge.is_required,"min-length":(q=n.settings)==null?void 0:q.min_length,"max-length":(Ae=n.settings)==null?void 0:Ae.max_length,allowSpace:(Ne=n.settings)==null?void 0:Ne.allow_space,textTransform:(c=n.settings)==null?void 0:c.text_transform,placeholder:((_=n.settings)==null?void 0:_.placeholder)||"Masukan text",error:t.form.errors[`results.${(h=n.inspection_point)==null?void 0:h.id}.note`],onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):l("",!0),n.input_type==="number"&&B(n)?(s(),_e(St,{key:1,modelValue:t.form.results[(T=n.inspection_point)==null?void 0:T.id].note,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"note")}],required:(P=n.settings)==null?void 0:P.is_required,min:(ee=n.settings)==null?void 0:ee.min,max:(X=n.settings)==null?void 0:X.max,step:((Q=n.settings)==null?void 0:Q.step)||1,placeholder:((z=n.settings)==null?void 0:z.placeholder)||"Masukan number",error:t.form.errors[`results.${(re=n.inspection_point)==null?void 0:re.id}.note`],onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):l("",!0),n.input_type==="account"&&B(n)?(s(),_e(At,{key:2,modelValue:t.form.results[(ue=n.inspection_point)==null?void 0:ue.id].note,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"note")}],required:(we=n.settings)==null?void 0:we.is_required,placeholder:((ye=n.settings)==null?void 0:ye.placeholder)||"Masukkan nilai",error:t.form.errors[`results.${(S=n.inspection_point)==null?void 0:S.id}.note`],"point-id":(V=n.inspection_point)==null?void 0:V.id,settings:n.settings,onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):l("",!0),n.input_type==="date"&&B(n)?(s(),_e(_t,{key:3,modelValue:t.form.results[(K=n.inspection_point)==null?void 0:K.id].note,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"note")}],required:(u=n.settings)==null?void 0:u.is_required,"min-date":(m=n.settings)==null?void 0:m.min_date,"max-date":(Y=n.settings)==null?void 0:Y.max_date,error:t.form.errors[`results.${(D=n.inspection_point)==null?void 0:D.id}.note`],onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):l("",!0),n.input_type==="textarea"&&B(n)?(s(),_e(Ct,{key:4,modelValue:t.form.results[(te=n.inspection_point)==null?void 0:te.id].note,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"note")}],required:(le=n.settings)==null?void 0:le.is_required,"min-length":(oe=n.settings)==null?void 0:oe.min_length,"max-length":(se=n.settings)==null?void 0:se.max_length,placeholder:((Ce=n.settings)==null?void 0:Ce.placeholder)||"Masukkan teks di sini",settings:n.settings,error:t.form.errors[`results.${(Ue=n.inspection_point)==null?void 0:Ue.id}.note`],onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):l("",!0),n.input_type==="radio"&&B(n)?(s(),_e(xo,{key:5,modelValue:t.form.results[(fe=n.inspection_point)==null?void 0:fe.id].status,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].status=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"status")}],notes:t.form.results[(Te=n.inspection_point)==null?void 0:Te.id].note,images:t.form.images[(Re=n.inspection_point)==null?void 0:Re.id],required:(Ee=n.settings)==null?void 0:Ee.is_required,"point-id":(We=n.inspection_point)==null?void 0:We.id,point:n.inspection_point,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(Je=n.inspection_point)==null?void 0:Je.name,subtitle:(Ze=n.inspection_point)==null?void 0:Ze.description,"selected-point":n.inspection_point??null,options:((Ye=n.settings)==null?void 0:Ye.radios)||O,error:t.form.errors[`results.${(Xe=n.inspection_point)==null?void 0:Xe.id}.status`],"onUpdate:notes":L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},"onUpdate:images":L=>{var b;return t.form.images[(b=n.inspection_point)==null?void 0:b.id]=L},onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)},onHapus:L=>{var b;return ve((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):l("",!0),n.input_type==="imageTOradio"&&B(n)?(s(),_e(Vo,{key:6,modelValue:t.form.results[(Qe=n.inspection_point)==null?void 0:Qe.id].status,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].status=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"status")}],notes:t.form.results[(et=n.inspection_point)==null?void 0:et.id].note,images:t.form.images[(tt=n.inspection_point)==null?void 0:tt.id],required:(at=n.settings)==null?void 0:at.is_required,"point-id":(nt=n.inspection_point)==null?void 0:nt.id,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(st=n.inspection_point)==null?void 0:st.name,subtitle:(ot=n.inspection_point)==null?void 0:ot.description,point:n,"selected-point":n.inspection_point??null,options:((it=n.settings)==null?void 0:it.radios)||O,error:t.form.errors[`results.${(lt=n.inspection_point)==null?void 0:lt.id}.status`],"onUpdate:notes":L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},"onUpdate:images":L=>{var b;return t.form.images[(b=n.inspection_point)==null?void 0:b.id]=L},onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)},onHapus:L=>{var b;return ve((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):l("",!0),n.input_type==="image"&&B(n)?(s(),_e(ze,{key:7,modelValue:t.form.images[(rt=n.inspection_point)==null?void 0:rt.id],"onUpdate:modelValue":L=>{var b;return t.form.images[(b=n.inspection_point)==null?void 0:b.id]=L},error:t.form.errors[`images.${(ut=n.inspection_point)==null?void 0:ut.id}`],"inspection-id":t.inspectionId,"point-id":(dt=n.inspection_point)==null?void 0:dt.id,point:n.inspection_point,"point-name":(ct=n.inspection_point)==null?void 0:ct.name,settings:n.settings,"onUpdate:notes":L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].note=L},"onUpdate:status":L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].status=L}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):l("",!0),n.input_type==="select"&&B(n)?(s(),_e(Xa,{key:8,modelValue:t.form.results[(pt=n.inspection_point)==null?void 0:pt.id].status,"onUpdate:modelValue":[L=>{var b;return t.form.results[(b=n.inspection_point)==null?void 0:b.id].status=L},L=>{var b;return R((b=n.inspection_point)==null?void 0:b.id,L,"status")}],required:(mt=n.settings)==null?void 0:mt.is_required,error:t.form.errors[`results.${(gt=n.inspection_point)==null?void 0:gt.id}.status`],onSave:L=>{var b;return J((b=n.inspection_point)==null?void 0:b.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):l("",!0),!B(n)&&G(n)?(s(),o("div",ei,[p[2]||(p[2]=e("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),p[3]||(p[3]=e("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),e("ul",ti,[(vt=n.settings)!=null&&vt.transmission?(s(),o("li",ai," Transmisi: "+N(j(n.settings.transmission).join(", ")),1)):l("",!0),(ft=n.settings)!=null&&ft.fuel_type?(s(),o("li",ni," Bahan bakar: "+N(n.settings.fuel_type),1)):l("",!0),(ht=n.settings)!=null&&ht.rear_door?(s(),o("li",si,"Kendaraan dengan pintu belakang")):l("",!0),(bt=n.settings)!=null&&bt.pick_up?(s(),o("li",oi,"Tipe pick up")):l("",!0),(yt=n.settings)!=null&&yt.box?(s(),o("li",ii,"Kendaraan dengan box")):l("",!0)])])):l("",!0)]))],2)}),128)),E.value.filter(n=>!n.is_link).length===0?(s(),o("div",li,[p[4]||(p[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),p[5]||(p[5]=e("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),t.category.isDamageMenu?(s(),o("p",ri,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):l("",!0)])):l("",!0)])],2)],64))}},ji=De(ui,[["__scopeId","data-v-21688412"]]),di={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},ci={class:"p-4 space-y-4-6"},pi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},mi=["value"],gi={class:"p-4 space-y-4-6"},vi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},fi=["value"],hi={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},bi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},yi=["value"],xi={class:"p-4 space-y-2"},wi={class:"flex items-center justify-between mb-2"},ki={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},Ii={class:"flex items-center justify-between mb-3"},$i={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},Si=["onClick"],_i={class:"text-sm font-medium text-gray-800 mb-1"},Ai={class:"text-xs text-gray-600 line-clamp-2"},Ci={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},Ti={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},Ni={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ei={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Vi={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ui={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(t,{emit:W}){const a=t,x=W,r=k(null),v=k(!1),f=k(!1),d=wt({bold:!1,italic:!1,underline:!1}),i=wt({flooded:"",collision:"",collision_severity:"",notes:""}),y=k([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`}]);k(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const $=n=>{if(!n)return{};if(typeof n=="string")try{return JSON.parse(n)||{}}catch(g){return console.error("Error parsing settings JSON:",g),{}}return typeof n=="object"&&n!==null?n:{}};ne(()=>$(a.inspection.settings).conclusion||{});const I=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],M=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],j=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];je(()=>{G(),Ge(()=>{B(),w()})});const B=()=>{r.value&&i.notes&&(r.value.innerHTML=i.notes)},G=()=>{const g=$(a.inspection.settings).conclusion||{},A=a.form.conclusion||{};i.flooded=A.flooded||g.flooded||"",i.collision=A.collision||g.collision||"",i.collision_severity=A.collision_severity||g.collision_severity||"",i.notes=A.notes||a.inspection.notes||""},H=n=>{if(!r.value)return;let g=n.content;g=g.replace(/{PLATE_NUMBER}/g,a.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,a.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,i.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,i.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),r.value.innerHTML=g,i.notes=g,f.value=!1,Ge(()=>{r.value.focus(),p()})},E=()=>{r.value&&(r.value.innerHTML="",i.notes="",p())},w=()=>{if(!r.value)return;const n=window.getSelection();n.rangeCount===0||n.isCollapsed||(d.bold=document.queryCommandState("bold"),d.italic=document.queryCommandState("italic"),d.underline=document.queryCommandState("underline"))},F=n=>{if(!r.value)return;r.value.focus();const g=d[n];switch(n){case"bold":document.execCommand("bold",!1,!g);break;case"italic":document.execCommand("italic",!1,!g);break;case"underline":document.execCommand("underline",!1,!g);break}setTimeout(()=>{w(),O()},10)},O=It.debounce(()=>{r.value&&(i.notes=r.value.innerHTML,p())},200),U=n=>{n.preventDefault(),document.execCommand("insertParagraph",!1,null)},R=n=>{n.preventDefault();const g=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,g)},J=()=>{v.value=!0},ve=()=>{v.value=!1,r.value&&(i.notes=r.value.innerHTML,p())},C=()=>{p()},p=()=>{const n={flooded:i.flooded,collision:i.collision,collision_severity:i.collision==="yes"?i.collision_severity:null,notes:i.notes};x("updateConclusion",n)};return he(()=>a.form.conclusion,n=>{n&&(i.flooded=n.flooded!==void 0?n.flooded:i.flooded,i.collision=n.collision!==void 0?n.collision:i.collision,i.collision_severity=n.collision_severity!==void 0?n.collision_severity:i.collision_severity,i.notes=n.notes!==void 0?n.notes:i.notes,r.value&&n.notes!==void 0&&r.value.innerHTML!==n.notes&&(r.value.innerHTML=n.notes))},{deep:!0,immediate:!0}),he([()=>i.flooded,()=>i.collision,()=>i.collision_severity,()=>i.notes],()=>{p()},{deep:!0}),(n,g)=>(s(),o("div",di,[g[21]||(g[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),e("div",ci,[g[10]||(g[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ke(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",pi,[(s(),o($e,null,Se(I,A=>e("label",{key:A.value,class:"cursor-pointer"},[Ve(e("input",{type:"radio","onUpdate:modelValue":g[0]||(g[0]=Z=>i.flooded=Z),value:A.value,class:"hidden peer",onChange:C},null,40,mi),[[He,i.flooded]]),e("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.flooded===A.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.flooded!==A.value}])},N(A.label),3)])),64))])]),e("div",gi,[g[12]||(g[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ke(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",vi,[(s(),o($e,null,Se(M,A=>e("label",{key:A.value,class:"cursor-pointer"},[Ve(e("input",{type:"radio","onUpdate:modelValue":g[1]||(g[1]=Z=>i.collision=Z),value:A.value,class:"hidden peer",onChange:C},null,40,fi),[[He,i.collision]]),e("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.collision===A.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.collision!==A.value}])},N(A.label),3)])),64))]),Ie(Oe,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Me(()=>[i.collision==="yes"?(s(),o("div",hi,[g[11]||(g[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ke("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",bi,[(s(),o($e,null,Se(j,A=>e("label",{key:A.value,class:"cursor-pointer"},[Ve(e("input",{type:"radio","onUpdate:modelValue":g[2]||(g[2]=Z=>i.collision_severity=Z),value:A.value,class:"hidden peer",onChange:C},null,40,yi),[[He,i.collision_severity]]),e("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":i.collision_severity===A.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":i.collision_severity!==A.value}])},N(A.label),3)])),64))])])):l("",!0)]),_:1})]),e("div",xi,[e("div",wi,[g[14]||(g[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),e("button",{type:"button",onClick:g[3]||(g[3]=A=>f.value=!f.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},g[13]||(g[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),ke(" Template ")]))]),Ie(Oe,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Me(()=>[f.value?(s(),o("div",ki,[e("div",Ii,[g[16]||(g[16]=e("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),e("button",{onClick:g[4]||(g[4]=A=>f.value=!1),class:"text-gray-400 hover:text-gray-600"},g[15]||(g[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",$i,[(s(!0),o($e,null,Se(y.value,A=>(s(),o("button",{key:A.id,onClick:Z=>H(A),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[e("div",_i,N(A.name),1),e("div",Ai,N(A.description),1)],8,Si))),128))])])):l("",!0)]),_:1}),e("div",Ci,[e("button",{type:"button",onClick:g[5]||(g[5]=A=>F("bold")),class:ae(["p-2 rounded transition-all duration-150 ease-in-out font-medium",d.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},g[17]||(g[17]=[e("strong",null,"B",-1)]),2),e("button",{type:"button",onClick:g[6]||(g[6]=A=>F("italic")),class:ae(["p-2 rounded transition-all duration-150 ease-in-out font-medium",d.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},g[18]||(g[18]=[e("em",null,"I",-1)]),2),e("button",{type:"button",onClick:g[7]||(g[7]=A=>F("underline")),class:ae(["p-2 rounded transition-all duration-150 ease-in-out font-medium",d.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},g[19]||(g[19]=[e("u",null,"U",-1)]),2),e("button",{type:"button",onClick:g[8]||(g[8]=A=>E()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," ðŸ—‘ï¸ Clear ")]),Ie(Oe,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Me(()=>[Object.values(d).some(A=>A)?(s(),o("div",Ti,[g[20]||(g[20]=ke(" Format aktif: ")),d.bold?(s(),o("span",Ni,"Bold")):l("",!0),d.italic?(s(),o("span",Ei,"Italic")):l("",!0),d.underline?(s(),o("span",Vi,"Underline")):l("",!0)])):l("",!0)]),_:1}),e("div",{ref_key:"editorRef",ref:r,contenteditable:"true",class:ae(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!v.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":v.value}]),onInput:g[9]||(g[9]=(...A)=>Pe(O)&&Pe(O)(...A)),onBlur:ve,onFocus:J,onKeydown:Mt(U,["enter"]),onPaste:R,onMouseup:w,onKeyup:w,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},Fi=De(Ui,[["__scopeId","data-v-e09db1bd"]]);export{qs as B,ji as C,Bi as V,Tt as _,Fi as a};
