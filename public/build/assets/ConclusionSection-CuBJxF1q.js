import{x as Nt,r as $,g as De,q as ee,E as Le,G as me,c as o,o as s,d as e,b as r,k as we,z as Ce,A as Me,n as Q,t as U,u as Ee,e as Et,F as Ie,m as $e,f as ye,y as Pe,w as Te,N as Ve,D as Fe,L as wt,a as Be,j as Se,l as xt,T as Re,M as Vt,p as Ut,O as kt,J as je,B as Mt}from"./vendor-g77w9U1W.js";import{l as It}from"./lodash-CGXsUT3p.js";import{_ as Dt}from"./PrimaryButton-CrKKsBb9.js";import{_ as Pt}from"./ActionMessage-C9w22vKV.js";import{_ as Ne}from"./app-Phoo9i5a.js";const Rt={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Lt={key:0,class:"p-4 space-y-2"},Bt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},jt={class:"flex items-center space-x-2"},Ft={key:0,class:"text-xs text-red-500 font-normal ml-2"},qt={key:1,class:"text-xs text-red-500 font-normal ml-2"},Ot={key:2,class:"text-xs text-green-500 font-normal ml-2"},Kt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ht={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},zt={class:"col-span-2 flex space-x-3"},Gt={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Wt={class:"flex items-start"},Zt={class:"text-sm text-blue-700"},Jt={class:"mt-1"},Yt={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Xt={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},Qt={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},ea={key:3,class:"text-blue-600"},ta={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},aa={class:"relative"},na={key:0,class:"absolute right-3 top-3"},sa={key:1,class:"text-xs text-red-500 font-normal ml-2"},oa={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ia={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},la={key:0},ra=["onMousedown"],ua={class:"font-medium text-gray-900"},da={class:"text-sm text-gray-500"},ca={key:1,class:"p-4 text-sm text-gray-500 text-center"},ga={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},pa={key:0,class:"mb-4"},ma=["innerHTML"],va={key:1},fa={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ha=["onClick"],ba=["src","alt"],ya={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},xa={class:"text-white text-xs text-center"},ka={key:2,class:"text-center py-4 text-gray-500 text-sm"},wa={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},Ia=["src","alt"],$a={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Sa={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},Aa={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},_a={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(t,{emit:Z}){var X,ne,de,xe,ke,he;const a=t,k=Z,u=Nt({plate_number:((X=a.inspection)==null?void 0:X.plate_number)||"",car_id:((ne=a.inspection)==null?void 0:ne.car_id)||null,car_name:((de=a.inspection)==null?void 0:de.car_name)||""}),m=$(((xe=a.inspection)==null?void 0:xe.plate_number)||""),v=$(((ke=a.inspection)==null?void 0:ke.car_id)||null),d=$(((he=a.inspection)==null?void 0:he.car_name)||""),i=$(""),x=$(""),A=$(""),I=$(null),P=$({rear_door:!1}),q=$(!1),L=$(""),G=$(""),z=$(u.car_name),V=$(!1),w=$(!1),F=$([]),O=$(null),D=$([]),B=$(!1),W=$(0);De(()=>{var S,h,ae,K,oe;if(N((S=a.inspection)==null?void 0:S.plate_number),(h=a.inspection)!=null&&h.car_id&&((ae=a.CarDetail)==null?void 0:ae.length)>0){const fe=a.CarDetail.find(be=>be.id===a.inspection.car_id);fe&&c(fe)}else!((K=a.inspection)!=null&&K.car_id)&&((oe=a.inspection)!=null&&oe.car_name)&&(z.value=a.inspection.car_name,u.car_id=null);window.addEventListener("keydown",E),ie(),k("update:hasUnsavedChanges",te.value),k("update:validation",se.value)}),Le(()=>{window.removeEventListener("keydown",E)});const ie=()=>{try{const S=localStorage.getItem("vehicle_features");if(S){const h=JSON.parse(S);P.value.rear_door=h.rear_door||!1,h.pick_up?I.value="pick_up":h.box?I.value="box":I.value=null}else P.value.rear_door=!1,I.value=null;g()}catch(S){console.error("Error loading vehicle type from localStorage:",S),P.value.rear_door=!1,I.value=null,g()}},_=()=>{P.value.rear_door=!P.value.rear_door,n()},p=S=>{I.value===S?I.value=null:I.value=S,n()},n=()=>{try{const S={rear_door:P.value.rear_door,pick_up:I.value==="pick_up",box:I.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(S)),g(),console.log("Vehicle features saved to localStorage:",S)}catch(S){console.error("Error saving vehicle type to localStorage:",S)}},g=()=>{const S={rear_door:P.value.rear_door,pick_up:I.value==="pick_up",box:I.value==="box"};k("update:vehicle-type",S)},N=S=>{if(!S){i.value="",x.value="",A.value="";return}const h=S.toUpperCase().trim(),ae=h.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(ae)i.value=ae[1]||"",x.value=ae[2]||"",A.value=ae[3]||"";else{let K="area",oe="",fe="",be="";for(const pe of h)K==="area"&&/[A-Z]/.test(pe)?oe+=pe:K==="area"&&/[0-9]/.test(pe)?(K="number",fe+=pe):K==="number"&&/[0-9]/.test(pe)?fe+=pe:K==="number"&&/[A-Z]/.test(pe)?(K="suffix",be+=pe):K==="suffix"&&/[A-Z]/.test(pe)&&(be+=pe);i.value=oe,x.value=fe,A.value=be}J()},J=()=>{const S=`${i.value}${x.value}${A.value}`;u.plate_number=S,j()},le=S=>{S==="area"?i.value=i.value.toUpperCase().replace(/[^A-Z]/g,""):S==="number"?x.value=x.value.replace(/[^0-9]/g,""):S==="suffix"&&(A.value=A.value.toUpperCase().replace(/[^A-Z]/g,"")),J()},re=ee(()=>{const S=u.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(S)}),ce=ee(()=>!z.value||z.value.trim()===""),ve=ee(()=>u.plate_number.length>0&&!re.value?"Format plat nomor tidak valid.":null),se=ee(()=>{const S=!u.plate_number||u.plate_number.trim()==="",h=!z.value||z.value.trim()==="";return S||h||!re.value||q.value}),te=ee(()=>{const S=u.plate_number!==m.value,h=u.car_id!==v.value||z.value!==d.value;return S||h}),ge=ee(()=>te.value&&!se.value),ue=S=>{var ae,K,oe;if(!S)return"";const h=[];return(ae=S.brand)!=null&&ae.name&&h.push(S.brand.name),(K=S.model)!=null&&K.name&&h.push(S.model.name),(oe=S.type)!=null&&oe.name&&h.push(S.type.name),S.cc&&h.push((S.cc/1e3).toFixed(1)),S.transmission&&h.push(S.transmission),S.year&&h.push(S.year.toString()),S.fuel_type&&h.push(S.fuel_type),S.production_period&&h.push(`(${S.production_period})`),h.join(" ")},H=()=>{u.car_id&&(u.car_id=null,O.value=null,D.value=[]),_e()},_e=It.debounce(()=>{if(!z.value.trim()){F.value=[],V.value=!1;return}w.value=!0;try{const S=z.value.toLowerCase().trim();F.value=a.CarDetail.filter(h=>ue(h).toLowerCase().includes(S)),V.value=!0}finally{w.value=!1}},300),Ae=()=>{setTimeout(()=>{V.value=!1,u.car_name=z.value,j()},200)},c=async S=>{O.value=S,z.value=ue(S),u.car_id=S.id,u.car_name=ue(S),V.value=!1,await b(S.id),j(),k("update:hasUnsavedChanges",te.value),k("update:validation",se.value)},C=S=>!S||!S.file_path?"":`/storage/${S.file_path}`,b=async S=>{try{const h=await fetch(`/api/cars/${S}/images`);if(h.ok){const ae=await h.json();D.value=Array.isArray(ae)?ae:[]}else D.value=[]}catch(h){console.error("Error loading car images:",h),D.value=[]}},T=S=>{W.value=S,B.value=!0,document.body.style.overflow="hidden"},l=()=>{B.value=!1,document.body.style.overflow=""},f=()=>{W.value=(W.value+1)%D.value.length},M=()=>{W.value=(W.value-1+D.value.length)%D.value.length},E=S=>{if(B.value)switch(S.key){case"Escape":l();break;case"ArrowRight":f();break;case"ArrowLeft":M();break}},j=()=>{const S={plate_number:u.plate_number,car_id:u.car_id,car_name:u.car_name};k("update-vehicle",S)},Y=()=>{a.inspection&&u.post(route("inspections.updateVehicleDetails",{inspection:a.inspection.id}),{preserveScroll:!0,onSuccess:()=>{m.value=u.plate_number,v.value=u.car_id,d.value=u.car_name,k("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:S=>{console.error("Gagal menyimpan data:",S)}})};return me([()=>u.plate_number,()=>u.car_name],S=>{L.value="",q.value=!1,G.value="";const h=S[0];if(h&&h.length>=6){const ae=a.allInspections.filter(K=>{var oe;return K.plate_number===h&&K.id!==((oe=a.inspection)==null?void 0:oe.id)});if(ae.length>0){const K=["draft","in_progress","pending","pending_review","revision"],oe=ae.find(fe=>K.includes(fe.status));if(oe)q.value=!0,L.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${oe.status.replace(/_/g," ").toUpperCase()}.`;else{const fe=ae.filter(be=>["approved","rejected","completed","cancelled"].includes(be.status));if(fe.length>0){fe.sort((pe,Ue)=>new Date(Ue.created_at)-new Date(pe.created_at));const be=fe[0];if(be.car_id){const pe=a.CarDetail.find(Ue=>Ue.id===be.car_id);pe&&c(pe)}else be.car_name&&(z.value=be.car_name,u.car_name=be.car_name,u.car_id=null);G.value=`Nomor plat ini sudah pernah diperiksa ${fe.length} kali sebelumnya.`}}}}k("update:hasUnsavedChanges",te.value),k("update:validation",se.value)},{deep:!0}),me([()=>P.value.rear_door,()=>I.value],()=>{n()}),(S,h)=>{var ae;return s(),o("div",Rt,[h[27]||(h[27]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),t.inspection?(s(),o("div",Lt,[e("div",Bt,[h[11]||(h[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",jt,[Ce(e("input",{"onUpdate:modelValue":h[0]||(h[0]=K=>i.value=K),type:"text",placeholder:"Contoh: B",class:Q(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!re.value||q.value}]),onInput:h[1]||(h[1]=K=>le("area")),maxlength:"2"},null,34),[[Me,i.value]]),Ce(e("input",{"onUpdate:modelValue":h[2]||(h[2]=K=>x.value=K),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:Q(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!re.value||q.value}]),onInput:h[3]||(h[3]=K=>le("number")),maxlength:"4"},null,34),[[Me,x.value]]),Ce(e("input",{"onUpdate:modelValue":h[4]||(h[4]=K=>A.value=K),type:"text",placeholder:"ABC",class:Q(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!re.value||q.value}]),onInput:h[5]||(h[5]=K=>le("suffix")),maxlength:"3"},null,34),[[Me,A.value]])]),ve.value?(s(),o("span",Ft,U(ve.value),1)):r("",!0),L.value?(s(),o("span",qt,U(L.value),1)):r("",!0),G.value?(s(),o("span",Ot,U(G.value),1)):r("",!0)]),e("div",Kt,[h[15]||(h[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),e("div",Ht,[e("div",{class:Q(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":P.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!P.value.rear_door}]),onClick:_},h[12]||(h[12]=[e("span",null,"Pintu Belakang",-1)]),2),e("div",zt,[e("div",{class:Q(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":I.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.value!=="pick_up"}]),onClick:h[6]||(h[6]=K=>p("pick_up"))}," Pick Up ",2),e("div",{class:Q(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":I.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.value!=="box"}]),onClick:h[7]||(h[7]=K=>p("box"))}," Box ",2)])]),e("div",Gt,[e("div",Wt,[h[14]||(h[14]=e("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",Zt,[h[13]||(h[13]=e("p",{class:"font-medium"},"Status Kendaraan:",-1)),e("p",Jt,[P.value.rear_door?(s(),o("span",Yt," ✓ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):r("",!0),I.value==="pick_up"?(s(),o("span",Xt," ✓ Pick Up ")):r("",!0),I.value==="box"?(s(),o("span",Qt," ✓ Box ")):r("",!0),!P.value.rear_door&&!I.value?(s(),o("span",ea," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):r("",!0)])])])])]),e("div",ta,[h[19]||(h[19]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",aa,[Ce(e("input",{"onUpdate:modelValue":h[8]||(h[8]=K=>z.value=K),type:"text",placeholder:"Cari atau ketik nama mobil...",class:Q(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ce.value}]),onInput:H,onFocus:h[9]||(h[9]=K=>V.value=!0),onBlur:Ae},null,34),[[Me,z.value]]),w.value?(s(),o("div",na,h[16]||(h[16]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):r("",!0),ce.value?(s(),o("span",sa,"Nama mobil tidak boleh kosong.")):r("",!0),!Ee(u).car_id&&z.value?(s(),o("div",oa,h[17]||(h[17]=[Et('<div class="flex items-start" data-v-93565d5f><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-93565d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-93565d5f></path></svg><div data-v-93565d5f><p class="text-yellow-800 font-medium mb-1" data-v-93565d5f>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-93565d5f>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-93565d5f> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-93565d5f>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-93565d5f>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):r("",!0),V.value?(s(),o("div",ia,[F.value.length>0?(s(),o("div",la,[(s(!0),o(Ie,null,$e(F.value,K=>(s(),o("div",{key:K.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:oe=>c(K)},[e("div",ua,U(ue(K)),1),e("div",da,U(K.year)+" • "+U(K.cc)+"cc • "+U(K.transmission)+" • "+U(K.fuel_type),1)],40,ra))),128))])):(s(),o("div",ca,h[18]||(h[18]=[ye(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),ye(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):r("",!0)])]),Ee(u).car_id&&O.value?(s(),o("div",ga,[O.value.description?(s(),o("div",pa,[h[20]||(h[20]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:O.value.description},null,8,ma)])):r("",!0),D.value.length>0?(s(),o("div",va,[h[21]||(h[21]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",fa,[(s(!0),o(Ie,null,$e(D.value,(K,oe)=>(s(),o("div",{key:K.id||oe,class:"relative group cursor-pointer",onClick:fe=>T(oe)},[e("img",{src:C(K),alt:K.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ba),K.note?(s(),o("div",ya,[e("p",xa,U(K.note),1)])):r("",!0)],8,ha))),128))])])):(s(),o("div",ka," Tidak ada gambar tersedia untuk mobil ini "))])):r("",!0),B.value?(s(),o("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:l},[e("div",wa,[e("button",{onClick:l,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},h[22]||(h[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),D.value.length>1?(s(),o("button",{key:0,onClick:Pe(M,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},h[23]||(h[23]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):r("",!0),D.value.length>1?(s(),o("button",{key:1,onClick:Pe(f,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},h[24]||(h[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):r("",!0),e("img",{src:C(D.value[W.value]),alt:"Car Image "+(W.value+1),class:"max-w-full max-h-full object-contain",onClick:h[10]||(h[10]=Pe(()=>{},["stop"]))},null,8,Ia),D.value.length>1?(s(),o("div",$a,U(W.value+1)+" / "+U(D.value.length),1)):r("",!0),(ae=D.value[W.value])!=null&&ae.note?(s(),o("div",Sa,U(D.value[W.value].note),1)):r("",!0)])])):r("",!0),we(Dt,{type:"button",onClick:Y,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!ge.value},{default:Te(()=>[Ee(u).processing?(s(),o("svg",Aa,h[25]||(h[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):r("",!0),e("span",null,U(Ee(u).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),we(Pt,{on:Ee(u).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Te(()=>h[26]||(h[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),ye(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):r("",!0)])}}},Di=Ne(_a,[["__scopeId","data-v-93565d5f"]]),Ca={class:"mt-1"},Ta=["value","required","minlength","maxlength","allowSpace","placeholder"],Na={key:0,class:"mt-2 text-sm text-red-600"},$t={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,k=Z,u=ee(()=>{if(!a.modelValue)return"";let v=a.modelValue;switch(a.allowSpace||(v=v.replace(/\s+/g,"")),a.textTransform){case"uppercase":return v.toUpperCase();case"lowercase":return v.toLowerCase();case"capitalize":return v.replace(/\b\w/g,d=>d.toUpperCase());default:return v}}),m=v=>{let d=v.target.value;switch(a.allowSpace||(d=d.replace(/\s+/g,"")),a.textTransform){case"uppercase":d=d.toUpperCase();break;case"lowercase":d=d.toLowerCase();break;case"capitalize":d=d.replace(/\b\w/g,i=>i.toUpperCase());break}k("update:modelValue",d),k("save",a.pointId)};return(v,d)=>(s(),o("div",Ca,[e("input",{value:u.value,onInput:m,type:"text",required:t.required,minlength:t.minLength,maxlength:t.maxLength,allowSpace:t.allowSpace,placeholder:t.placeholder,class:Q(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:t.textTransform==="uppercase",lowercase:t.textTransform==="lowercase",capitalize:t.textTransform==="capitalize"}])},null,42,Ta),t.error?(s(),o("p",Na,U(t.error),1)):r("",!0)]))}},Ea={class:"mt-1"},Va=["value","required","min","max","step","placeholder"],Ua={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputNumber",props:{modelValue:[String,Number],required:Boolean,min:[String,Number],max:[String,Number],step:[String,Number],placeholder:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,k=Z,u=m=>{const v=m.target.value;k("update:modelValue",v),k("save",a.pointId)};return(m,v)=>(s(),o("div",Ea,[e("input",{value:t.modelValue,onInput:u,type:"number",required:t.required,min:t.min,max:t.max,step:t.step,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Va),t.error?(s(),o("p",Ua,U(t.error),1)):r("",!0)]))}},Ma={class:"mt-1"},Da=["value","required","min","max"],Pa={key:0,class:"mt-2 text-sm text-red-600"},At={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,k=Z,u=m=>{k("update:modelValue",m.target.value),k("save",a.pointId)};return(m,v)=>(s(),o("div",Ma,[e("input",{value:t.modelValue,onChange:u,type:"date",required:t.required,min:t.minDate,max:t.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Da),t.error?(s(),o("p",Pa,U(t.error),1)):r("",!0)]))}},Ra={class:"mt-1"},La=["value","required","placeholder"],Ba={key:0,class:"mt-2 text-sm text-red-600"},_t={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,k=Z,u=$(""),m=ee(()=>{var A,I,P,q;return{currency_symbol:((A=a.settings)==null?void 0:A.currency_symbol)||"Rp",thousands_separator:((I=a.settings)==null?void 0:I.thousands_separator)||",",min_value:((P=a.settings)==null?void 0:P.min_value)!==void 0?Number(a.settings.min_value):0,max_value:((q=a.settings)==null?void 0:q.max_value)!==void 0?Number(a.settings.max_value):1e9}}),v=A=>{if(A==null||A==="")return"";const I=Number(A);if(isNaN(I))return"";let P=I.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return m.value.thousands_separator!==","&&(P=P.replace(/,/g,m.value.thousands_separator)),P},d=A=>A?A.replace(/[^\d]/g,""):"",i=ee(()=>u.value?`${m.value.currency_symbol} ${v(u.value)}`:""),x=A=>{let I=d(A.target.value),P=Number(I);m.value.min_value!==void 0&&P<m.value.min_value&&(I=m.value.min_value.toString()),m.value.max_value!==void 0&&P>m.value.max_value&&(I=m.value.max_value.toString()),u.value=I,k("update:modelValue",I),k("save",a.pointId)};return me(()=>a.modelValue,A=>{A!=null&&(u.value=A.toString())},{immediate:!0}),(A,I)=>(s(),o("div",Ra,[e("input",{value:i.value,onInput:x,type:"text",required:t.required,placeholder:t.placeholder,class:Q(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",t.error?"border-red-300":"border-gray-300"])},null,42,La),t.error?(s(),o("p",Ba,U(t.error),1)):r("",!0)]))}},ja={class:"mt-1 space-y-3"},Fa={key:0,class:"space-y-2"},qa={class:"flex flex-wrap gap-2"},Oa=["onClick"],Ka=["value","required","minlength","maxlength","placeholder"],Ha={class:"flex justify-between items-center mt-1"},za={class:"text-xs text-gray-500"},Ga={key:0,class:"text-xs text-red-600"},Ct={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,k=Z,u=$([]),m=$(""),v=A=>u.value.some(I=>I.value===A),d=A=>{v(A.value)?u.value=u.value.filter(L=>L.value!==A.value):u.value.push(A);const P=[...u.value.map(L=>L.value)];m.value.trim()&&P.push(m.value.trim());const q=P.join(", ");k("update:modelValue",q),k("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:q})},i=A=>{const I=A.target.value;k("update:modelValue",I),k("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:I}),x(I)},x=A=>{var L,G,z,V;if(!A){u.value=[],m.value="";return}const I=A.split(",").map(w=>w.trim()).filter(w=>w),P=((G=(L=a.settings)==null?void 0:L.damage_options)==null?void 0:G.map(w=>w.value))||[];u.value=((V=(z=a.settings)==null?void 0:z.damage_options)==null?void 0:V.filter(w=>I.includes(w.value)))||[];const q=I.filter(w=>!P.includes(w));m.value=q.join(", ")};return me(()=>a.modelValue,A=>{A!=null&&x(A)},{immediate:!0}),(A,I)=>{var P,q,L;return s(),o("div",ja,[(P=t.settings)!=null&&P.enable_damage&&((q=t.settings)!=null&&q.damage_options)?(s(),o("div",Fa,[I[0]||(I[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",qa,[(s(!0),o(Ie,null,$e(t.settings.damage_options,(G,z)=>(s(),o("button",{key:z,type:"button",onClick:V=>d(G),class:Q(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":v(G.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!v(G.value)}])},U(G.label),11,Oa))),128))])])):r("",!0),e("div",null,[e("textarea",{value:t.modelValue,onInput:i,required:t.required,minlength:t.minLength,maxlength:t.maxLength,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ka),e("div",Ha,[e("span",za,U(((L=t.modelValue)==null?void 0:L.length)||0)+"/"+U(t.maxLength||400),1),t.error?(s(),o("p",Ga,U(t.error),1)):r("",!0)])])])}}},Wa={class:"mt-1"},Za=["value","required"],Ja={key:0,class:"mt-2 text-sm text-red-600"},Ya={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,k=Z,u=m=>{k("update:modelValue",m.target.value),k("save",a.pointId)};return(m,v)=>(s(),o("div",Wa,[e("select",{value:t.modelValue,onChange:u,required:t.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},v[0]||(v[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Za),t.error?(s(),o("p",Ja,U(t.error),1)):r("",!0)]))}},Xa=Ne(Ya,[["__scopeId","data-v-1b6c0201"]]),Qa={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},en={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},tn={class:"text-xs text-gray-500 mt-2 text-center"},an={class:"flex flex-row space-x-4 mb-6"},nn={class:"mt-4 text-right"},sn={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(t){return(Z,a)=>t.show?(s(),o("div",Qa,[e("div",en,[a[7]||(a[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",tn,[a[3]||(a[3]=ye("Ambil Foto Maksimal: ")),e("b",null,U(t.settings.max_files),1),a[4]||(a[4]=ye(" Dengan Rasio & Ukuran: ")),e("b",null,U(t.settings.camera_aspect_ratio),1)]),e("div",an,[e("button",{onClick:a[0]||(a[0]=k=>Z.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[5]||(a[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Kamera",-1)])),e("button",{onClick:a[1]||(a[1]=k=>Z.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[6]||(a[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",nn,[e("button",{onClick:a[2]||(a[2]=k=>Z.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):r("",!0)}},on={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ln={class:"w-full h-full flex flex-col"},rn={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},un=["disabled"],dn={class:"text-lg font-semibold"},cn={class:"flex items-center gap-2"},gn=["disabled"],pn=["disabled"],mn={key:0,class:"bg-blue-900 bg-opacity-50 text-white p-3"},vn={class:"flex items-center justify-between mb-2"},fn={class:"text-xs"},hn={class:"w-full bg-blue-700 bg-opacity-50 rounded-full h-2"},bn={class:"text-xs mt-1 text-blue-300"},yn={class:"flex-1 flex items-center justify-center overflow-hidden relative"},xn=["src"],kn={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},wn={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},In=["disabled"],$n=["disabled"],Sn=["disabled"],An={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},_n={class:"flex justify-between items-center w-full"},Cn=["disabled"],Tn={key:1,class:"flex-1"},Nn=["disabled"],En={class:"flex gap-3 w-full"},Vn={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},Un={class:"flex items-center gap-2"},Mn={key:0,class:"text-center"},Dn={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(t,{emit:Z}){const a=t,k=Z,u=$(0),m=$([]),v=ee(()=>m.value.length>0?m.value[u.value]:null);me(()=>a.images,V=>{m.value=V.map(w=>({...w,rotation:w.rotation||0})),V.length===0&&a.show&&P()},{deep:!0,immediate:!0}),me(()=>a.show,V=>{V&&a.images.length>0&&(u.value=a.initialIndex)}),me(()=>a.uploadProgress,V=>{V===100&&console.log("Upload completed")});const d=V=>V.preview||(V.image_path?`/${V.image_path}`:""),i=()=>{if(v.value&&!a.isUploading){const V=(v.value.rotation+90)%360;m.value[u.value].rotation=V,k("update:images",m.value)}},x=()=>{a.isUploading||(u.value=u.value<m.value.length-1?u.value+1:0)},A=()=>{a.isUploading||(u.value=u.value>0?u.value-1:m.value.length-1)},I=()=>{a.isUploading||k("saveImages",m.value)},P=()=>{a.isUploading||k("close")},q=()=>{if(v.value&&!a.isUploading){const V=v.value,w=m.value.findIndex(F=>F.isNew&&V.isNew&&F.preview===V.preview||!F.isNew&&!V.isNew&&F.id===V.id);w!==-1&&(k("removePreviewImage",V),m.value.splice(w,1),k("update:images",m.value)),u.value>=m.value.length&&(u.value=Math.max(0,m.value.length-1)),m.value.length===0&&k("close")}},L=()=>{a.isUploading||k("triggerAddMorePhotos")},G=()=>{v.value&&!a.isUploading&&k("retryImage",v.value)},z=V=>{V.key==="Escape"&&!a.isUploading&&P()};return De(()=>{document.addEventListener("keydown",z)}),Le(()=>{document.removeEventListener("keydown",z)}),(V,w)=>{var F;return t.show?(s(),o("div",on,[e("div",ln,[e("div",rn,[e("button",{onClick:P,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},w[0]||(w[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,un),e("div",dn,U(((F=t.point)==null?void 0:F.name)||"Preview")+" ("+U(u.value+1)+"/"+U(m.value.length)+") ",1),e("div",cn,[v.value&&v.value.isNew?(s(),o("button",{key:0,onClick:q,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:t.isUploading},w[1]||(w[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,gn)):r("",!0),v.value&&v.value.isNew?(s(),o("button",{key:1,onClick:i,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},w[2]||(w[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]),8,pn)):r("",!0)])]),t.isUploading?(s(),o("div",mn,[e("div",vn,[w[3]||(w[3]=e("span",{class:"text-sm font-medium"},"Mengupload gambar...",-1)),e("span",fn,U(t.uploadProgress)+"%",1)]),e("div",hn,[e("div",{class:"bg-blue-400 h-2 rounded-full transition-all duration-300",style:Ve({width:t.uploadProgress+"%"})},null,4)]),e("p",bn,U(t.currentUpload)+"/"+U(t.totalUpload)+" gambar terupload",1)])):r("",!0),e("div",yn,[e("div",{class:"relative w-full max-w-full",style:Ve({paddingTop:t.aspectRatio?100/t.aspectRatio+"%":"75%"})},[v.value?(s(),o("img",{key:0,src:d(v.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:Ve({transform:`rotate(${v.value.rotation}deg)`})},null,12,xn)):r("",!0),v.value&&v.value.isUploading?(s(),o("div",kn,w[4]||(w[4]=[e("div",{class:"text-center text-white"},[e("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e("p",{class:"text-sm"},"Mengupload...")],-1)]))):r("",!0),v.value&&v.value.isFailed?(s(),o("div",wn,[w[5]||(w[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),w[6]||(w[6]=e("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),e("button",{onClick:G,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:t.isUploading}," Coba Lagi ",8,In)])):r("",!0)],4),m.value.length>1&&!t.isUploading?(s(),o("button",{key:0,onClick:A,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},w[7]||(w[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,$n)):r("",!0),m.value.length>1&&!t.isUploading?(s(),o("button",{key:1,onClick:x,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},w[8]||(w[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Sn)):r("",!0)]),e("div",An,[e("div",_n,[v.value&&!v.value.isNew?(s(),o("button",{key:0,onClick:q,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:t.isUploading},w[9]||(w[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ye(" Hapus Foto ")]),8,Cn)):(s(),o("div",Tn)),t.allowMultiple&&m.value.length<t.maxFiles&&!t.isUploading?(s(),o("button",{key:2,onClick:L,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:t.isUploading},w[10]||(w[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ye(" Tambah Foto ")]),8,Nn)):r("",!0)]),e("div",En,[t.isUploading?(s(),o("button",Vn,[e("div",Un,[w[11]||(w[11]=e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),e("span",null,"Mengupload... "+U(t.uploadProgress)+"%",1)])])):(s(),o("button",{key:0,onClick:I,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),t.isUploading?(s(),o("div",Mn,w[12]||(w[12]=[e("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):r("",!0)])])])):r("",!0)}}},Pn=Ne(Dn,[["__scopeId","data-v-581782f4"]]),Rn={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},Ln={class:"webcam-content-box"},Bn={class:"webcam-header"},jn={class:"rounded-full text-white hover:bg-gray-700 transition-colors"},Fn={class:"inspection-point-name"},qn={key:0,class:"screen-flash-overlay"},On={key:2,class:"zoom-controls"},Kn=["max"],Hn={key:3,class:"loading-overlay"},zn={key:4,class:"error-overlay"},Gn={class:"error-content"},Wn={class:"error-message"},Zn={class:"webcam-footer"},Jn={class:"camera-controls"},Yn=["disabled"],Xn={class:"camera-icon-container"},Qn={key:0,class:"camera-spinner"},es={key:1,class:"camera-body"},ts=["disabled"],as={key:0,class:"focus-controls"},ns=["min","max"],ss={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(t,{emit:Z}){const a=t,k=Z,u=$(null),m=$(null);let v=null,d=null;const i=$("environment"),x=$(null),A=$([]),I=$(!1),P=$(!1),q=$(!1),L=$(!1),G=$(!1),z=$({}),V=$(!1),w=$(!1),F=$(null),O=$(1),D=$(1),B=$(!1),W=$("continuous"),ie=$(0),_=$(0),p=$(10),n=$(!1),g=ee(()=>{var l;return((l=a.settings)==null?void 0:l.max_size)||2048}),N=ee(()=>a.aspectRatio?{aspectRatio:`${a.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),J=ee(()=>{if(!a.aspectRatio)return{};const l=a.aspectRatio,f=l>1?80:60,M=l>1?80/l:60*l;return{width:`${f}%`,height:`${M}%`}}),le=async()=>{v&&v.getTracks().forEach(l=>l.stop()),w.value=!0,F.value=null;try{await ce();const l={deviceId:x.value?{exact:x.value}:void 0,facingMode:x.value?void 0:{ideal:i.value},width:{ideal:3840,min:1920},height:{ideal:2160,min:1080},aspectRatio:{ideal:a.aspectRatio||4/3},frameRate:{ideal:60,min:30},resizeMode:"crop-and-scale",advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{whiteBalanceMode:"continuous"},{brightness:{ideal:0}},{contrast:{ideal:0}},{saturation:{ideal:0}},{sharpness:{ideal:0}}]};console.log("Initializing RTC camera with constraints:",l),v=await navigator.mediaDevices.getUserMedia({video:l,audio:!1}),d=v.getVideoTracks()[0],u.value.srcObject=v,await new Promise((f,M)=>{u.value.onloadedmetadata=()=>f(),u.value.onerror=M,setTimeout(f,1e3)}),await u.value.play(),await te(),console.log("RTC Camera initialized successfully")}catch(l){console.error("RTC Error accessing camera: ",l),F.value=ve(l),(l.name==="OverconstrainedError"||l.name==="ConstraintNotSatisfiedError")&&await re()}finally{w.value=!1}},re=async()=>{try{console.log("Trying fallback camera constraints...");const l={video:{deviceId:x.value?{exact:x.value}:void 0,facingMode:x.value?void 0:{ideal:i.value},width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}},audio:!1};v=await navigator.mediaDevices.getUserMedia(l),d=v.getVideoTracks()[0],u.value.srcObject=v,await u.value.play(),await te(),console.log("Fallback camera initialized successfully"),F.value=null}catch(l){console.error("Fallback camera also failed: ",l),F.value=ve(l)}},ce=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(M=>M.stop());const f=await navigator.mediaDevices.enumerateDevices();if(A.value=f.filter(M=>M.kind==="videoinput"),I.value=A.value.length>1,!x.value&&A.value.length>0){const M=A.value.find(E=>E.label.toLowerCase().includes("back")||E.label.toLowerCase().includes("rear")||E.label.toLowerCase().includes("environment"));x.value=M?M.deviceId:A.value[0].deviceId}console.log(`Found ${A.value.length} cameras:`,A.value)}catch(l){console.error("Error getting camera devices:",l)}},ve=l=>{switch(l.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan. Pastikan kamera terpasang dan tidak digunakan aplikasi lain.";case"NotSupportedError":return"Browser tidak mendukung akses kamera. Gunakan browser modern seperti Chrome, Firefox, atau Safari.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain. Tutup aplikasi lain yang menggunakan kamera.";case"OverconstrainedError":case"ConstraintNotSatisfiedError":return"Kamera tidak mendukung mode yang diminta. Menggunakan mode alternatif...";default:return`Error: ${l.message||"Tidak dapat mengakses kamera"}`}},se=()=>{v&&v.getTracks().forEach(l=>l.stop()),k("close")},te=async()=>{if(d)try{const l=d.getCapabilities(),f=d.getSettings();console.log("Camera Capabilities:",l),console.log("Camera Settings:",f),l.zoom&&(B.value=!0,D.value=l.zoom.max,O.value=f.zoom||1,console.log(`Zoom supported. Range: ${l.zoom.min} - ${l.zoom.max}`)),P.value=!!l.torch,l.focusMode&&l.focusMode.includes("manual")&&(n.value=!0,l.focusDistance&&(_.value=l.focusDistance.min,p.value=l.focusDistance.max,ie.value=f.focusDistance||_.value)),l.exposureMode&&console.log("Exposure modes:",l.exposureMode),l.whiteBalanceMode&&console.log("White balance modes:",l.whiteBalanceMode)}catch(l){console.error("Error checking camera capabilities:",l)}},ge=async l=>{if(!d||!n.value)return;const f=u.value.getBoundingClientRect(),M=l.clientX-f.left,E=l.clientY-f.top;G.value=!0,z.value={left:`${M}px`,top:`${E}px`,transform:"translate(-50%, -50%)"};try{if(d.getCapabilities().pointsOfInterest){const Y=M/f.width,X=E/f.height;await d.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:Y,y:X}]}]}),console.log(`Manual focus set at: ${Y.toFixed(2)}, ${X.toFixed(2)}`)}}catch(j){console.warn("Manual focus failed:",j)}setTimeout(()=>{G.value=!1},2e3)},ue=async l=>{if(!d||!B.value)return;const f=Math.min(Math.max(l,1),D.value);O.value=f;try{await d.applyConstraints({advanced:[{zoom:f}]}),console.log(`Zoom set to: ${f}`)}catch(M){console.error("Failed to set zoom:",M)}},H=async l=>{if(!(!d||!n.value)){W.value=l;try{l==="continuous"?await d.applyConstraints({advanced:[{focusMode:"continuous"}]}):await d.applyConstraints({advanced:[{focusMode:"manual"}]}),console.log(`Focus mode set to: ${l}`)}catch(f){console.error("Failed to set focus mode:",f),W.value="continuous"}}},_e=async l=>{if(!(!d||W.value!=="manual")){ie.value=l;try{await d.applyConstraints({advanced:[{focusDistance:l}]})}catch(f){console.warn("Manual focus distance adjustment failed:",f)}}},Ae=async()=>{if(!(!d||!P.value))try{i.value==="user"?(q.value=!q.value,L.value=q.value):(await d.applyConstraints({advanced:[{torch:!q.value}]}),q.value=!q.value),console.log(`Flash ${q.value?"ON":"OFF"}`)}catch(l){console.error("Flash toggle failed:",l)}},c=async()=>{if(!I.value||w.value)return;w.value=!0,v&&v.getTracks().forEach(E=>E.stop());const f=(A.value.findIndex(E=>E.deviceId===x.value)+1)%A.value.length;x.value=A.value[f].deviceId;const M=A.value[f];M.label.toLowerCase().includes("front")||M.label.toLowerCase().includes("user")?i.value="user":i.value="environment",console.log(`Switching to camera: ${M.label}`),await le()},C=async()=>{F.value=null,await le()},b=async l=>new Promise(f=>{const M=g.value*1024;if(l.size<=M){f(l);return}const E=new Image,j=new FileReader;j.onload=Y=>{E.onload=()=>{const X=document.createElement("canvas"),ne=X.getContext("2d");let de=Math.sqrt(M/l.size),xe=Math.floor(E.width*de),ke=Math.floor(E.height*de);xe<800&&(xe=800,ke=Math.floor(800/E.width*E.height),de=800/E.width),X.width=xe,X.height=ke,ne.imageSmoothingEnabled=!0,ne.imageSmoothingQuality="high",ne.drawImage(E,0,0,xe,ke);let he=.92;const S=()=>{X.toBlob(h=>{h.size>M&&he>.4?(he-=.08,S()):(console.log(`Image compressed: ${l.size} -> ${h.size} bytes, quality: ${he}`),f(h))},"image/jpeg",he)};S()},E.src=Y.target.result},j.readAsDataURL(l)}),T=async()=>{if(!(V.value||!u.value||!m.value||w.value)){V.value=!0;try{const l=u.value,f=m.value,M=l.videoWidth,E=l.videoHeight;let j,Y,X,ne;M/E>a.aspectRatio?(Y=E,j=E*a.aspectRatio,X=(M-j)/2,ne=0):(j=M,Y=M/a.aspectRatio,X=0,ne=(E-Y)/2),f.width=j,f.height=Y;const de=f.getContext("2d");de.imageSmoothingEnabled=!0,de.imageSmoothingQuality="high",de.drawImage(l,X,ne,j,Y,0,0,j,Y);const xe=await new Promise(he=>{f.toBlob(he,"image/jpeg",1)}),ke=await b(xe);if(ke){const he=new File([ke],`capture_${Date.now()}.jpeg`,{type:"image/jpeg",lastModified:Date.now()});k("photoCaptured",he),L.value=!0,setTimeout(()=>{L.value=!1},100)}}catch(l){console.error("Error capturing photo:",l)}finally{V.value=!1}}};return me(()=>a.show,async l=>{l?(await Fe(),await le()):se()}),Le(()=>{v&&v.getTracks().forEach(l=>l.stop())}),(l,f)=>{var M;return t.show?(s(),o("div",Rn,[e("div",Ln,[e("div",Bn,[e("p",jn,U(t.settings.camera_aspect_ratio),1),e("div",Fn,U(((M=t.point)==null?void 0:M.name)||"Camera"),1),e("button",{onClick:se,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},f[6]||(f[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:Ve(N.value),onClick:ge,onTouchstart:ge},[e("video",{ref_key:"webcamVideo",ref:u,autoplay:"",playsinline:"",class:"webcam-video"},null,512),e("canvas",{ref_key:"webcamCanvas",ref:m,class:"hidden"},null,512),L.value?(s(),o("div",qn)):r("",!0),e("div",{class:"aspect-ratio-guide",style:Ve(J.value)},null,4),G.value?(s(),o("div",{key:1,class:"focus-indicator",style:Ve(z.value)},f[7]||(f[7]=[e("div",{class:"focus-ring"},null,-1)]),4)):r("",!0),f[11]||(f[11]=e("div",{class:"hd-badge"},[e("span",{class:"hd-text"},"HD")],-1)),B.value?(s(),o("div",On,[Ce(e("input",{type:"range",min:"1",max:D.value,step:"0.1","onUpdate:modelValue":f[0]||(f[0]=E=>O.value=E),onInput:f[1]||(f[1]=E=>ue(parseFloat(E.target.value))),class:"zoom-slider"},null,40,Kn),[[Me,O.value]])])):r("",!0),w.value?(s(),o("div",Hn,f[8]||(f[8]=[e("div",{class:"loading-spinner"},null,-1),e("p",{class:"loading-text"},"Menginisialisasi kamera...",-1)]))):r("",!0),F.value?(s(),o("div",zn,[e("div",Gn,[f[9]||(f[9]=e("div",{class:"error-icon"},"⚠️",-1)),f[10]||(f[10]=e("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),e("p",Wn,U(F.value),1),e("button",{onClick:C,class:"retry-button"}," Coba Lagi ")])])):r("",!0)],36),e("div",Zn,[e("div",Jn,[t.settings.enable_flash&&P.value?(s(),o("button",{key:0,onClick:Ae,class:Q(["control-button",{active:q.value,disabled:!P.value}])},f[12]||(f[12]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):r("",!0),e("button",{onClick:T,class:"capture-button",disabled:V.value||w.value},[e("div",Xn,[V.value?(s(),o("div",Qn)):(s(),o("div",es,f[13]||(f[13]=[e("div",{class:"camera-lens"},null,-1),e("div",{class:"camera-flash"},null,-1)])))])],8,Yn),t.settings.enable_camera_switch&&I.value?(s(),o("button",{key:1,onClick:c,class:"control-button",disabled:w.value},f[14]||(f[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,ts)):r("",!0)]),n.value?(s(),o("div",as,[e("button",{onClick:f[2]||(f[2]=E=>H("continuous")),class:Q(["focus-btn",{active:W.value==="continuous"}])}," Auto ",2),e("button",{onClick:f[3]||(f[3]=E=>H("manual")),class:Q(["focus-btn",{active:W.value==="manual"}])}," Manual ",2),W.value==="manual"?Ce((s(),o("input",{key:0,type:"range",min:_.value,max:p.value,step:"0.1","onUpdate:modelValue":f[4]||(f[4]=E=>ie.value=E),onInput:f[5]||(f[5]=E=>_e(parseFloat(E.target.value))),class:"focus-slider"},null,40,ns)),[[Me,ie.value]]):r("",!0)])):r("",!0)])])])):r("",!0)}}},os=Ne(ss,[["__scopeId","data-v-16aaf8f4"]]),is=["accept","multiple","disabled"],ls={class:"text-xs text-gray-500 mb-2"},rs=["disabled"],us={class:"h-full flex flex-col items-center justify-center p-4 text-center"},ds={class:"text-xs text-gray-400 mt-1"},cs={key:0,class:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},gs={class:"flex items-center justify-between mb-2"},ps={class:"text-xs text-blue-600"},ms={class:"w-full bg-blue-200 rounded-full h-2"},vs={class:"text-xs text-blue-600 mt-1"},fs={key:1,class:"flex items-center gap-4"},hs=["src"],bs={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},ys=["disabled"],xs={key:2,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},ks=["disabled"],ws=["onClick"],Is=["src"],$s={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},Ss={key:0},As={key:1,class:"ml-1"},_s={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Cs={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Ts={key:2,class:"mt-1 text-xs text-red-600"},Ns={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(t,{emit:Z}){const a=t,k=Z,u=$(null),m=$(null),v=$(!1),d=$(!1),i=$(!1),x=$([]),A=$(0),I=$(!1),P=$(0),q=$(0),L=$(0),G=wt("imageSourceSetting",$("all")),z=`inspection-${a.inspectionId}-point-${a.pointId}-backup`,V=ee(()=>Number(a.settings.max_files)>1),w=ee(()=>a.settings.allowed_types.map(c=>`.${c}`).join(", ")),F=ee(()=>{const c=a.settings.camera_aspect_ratio.split(":");if(c.length===2){const C=parseFloat(c[0]),b=parseFloat(c[1]);if(!isNaN(C)&&!isNaN(b)&&b!==0)return C/b}return 3/4}),O=ee(()=>{const c=[],C=new Set;for(const b of a.modelValue)b.id&&C.add(b.id),c.push({...b,rotation:b.rotation||0,isNew:!1,isUploaded:!0,preview:b.preview||(b.image_path?`/${b.image_path}`:null)});for(const b of x.value)b.id&&C.add(b.id),c.push({...b,isUploading:b.isUploading||!1});return c}),D=c=>c.preview||(c.image_path?`/${c.image_path}`:""),B=()=>{i.value&&(i.value=!1),G.value==="camera"?ie():G.value==="gallery"?W():v.value=!0},W=()=>{v.value=!1,u.value.click()},ie=()=>{v.value=!1,d.value=!0},_=()=>{v.value=!1,O.value.length>0&&(i.value=!0)},p=()=>{d.value=!1,O.value.length>0&&(i.value=!0)},n=()=>{i.value=!1,I.value||(x.value.forEach(c=>{c.preview&&c.preview.startsWith("blob:")&&URL.revokeObjectURL(c.preview)}),x.value=[])},g=c=>new Promise(C=>{const b=new FileReader;b.onload=T=>{const l=new Image;l.onload=()=>{C({file:c,preview:URL.createObjectURL(c),rotation:0,width:l.naturalWidth,height:l.naturalHeight,isNew:!0})},l.onerror=()=>{console.error("Failed to load image for dimensions:",c.name),C({file:c,preview:URL.createObjectURL(c),rotation:0,width:0,height:0,isNew:!0})},l.src=T.target.result},b.readAsDataURL(c)}),N=c=>{const C=c.name.split(".").pop().toLowerCase();return a.settings.allowed_types.includes(C)},J=async c=>{const b=(a.settings.max_size||2048)*1024;return new Promise(T=>{const l=new Image,f=new FileReader;f.onload=M=>{l.onload=()=>{const E=document.createElement("canvas"),j=E.getContext("2d"),Y=Math.max(l.width,l.height);E.width=Y,E.height=Y,j.fillStyle="white",j.fillRect(0,0,Y,Y);const X=(Y-l.width)/2,ne=(Y-l.height)/2;j.drawImage(l,X,ne,l.width,l.height);let de=.9;const xe=()=>{E.toBlob(ke=>{if(ke.size>b&&de>.1)de-=.1,xe();else{const he=new File([ke],c.name,{type:"image/jpeg",lastModified:Date.now()});T(he)}},"image/jpeg",de)};xe()},l.src=M.target.result},f.readAsDataURL(c)})},le=async c=>{const C=Array.from(c.target.files);if(!C.length){v.value=!1,O.value.length>0&&(i.value=!0);return}try{const b=C.filter(j=>!N(j));if(b.length>0){const j=b.map(Y=>Y.name.split(".").pop()).join(", ");alert(`File type not allowed: ${j}. Allowed types: ${a.settings.allowed_types.join(", ")}`),c.target.value="";return}const T=O.value.length,l=a.settings.max_files-T,f=await Promise.all(C.slice(0,l).map(async j=>await J(j))),M=await Promise.all(f.map(g)),E=V.value?M:M.slice(0,1);V.value?x.value.push(...E):(x.value.forEach(j=>{j.preview&&j.preview.startsWith("blob:")&&URL.revokeObjectURL(j.preview)}),x.value=E),v.value=!1,E.length>0?(A.value=Math.max(0,O.value.length-E.length),i.value=!0):O.value.length>0&&(i.value=!0),c.target.value=""}catch(b){console.error("Error processing selected images:",b),alert("Failed to process selected images. Please try again."),v.value=!1,O.value.length>0&&(i.value=!0)}},re=async c=>{const C=O.value.length;if(!V.value||C<a.settings.max_files)try{const b=await J(c),T=new Image;T.onload=()=>{const l={file:b,preview:URL.createObjectURL(b),rotation:0,width:T.naturalWidth,height:T.naturalHeight,isNew:!0};V.value?x.value.push(l):(x.value.forEach(f=>{f.preview&&f.preview.startsWith("blob:")&&URL.revokeObjectURL(f.preview)}),x.value=[l]),d.value=!1,v.value=!1,A.value=O.value.length-1,i.value=!0},T.src=URL.createObjectURL(b)}catch(b){console.error("Error processing captured image:",b),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${a.settings.max_files} files allowed.`),d.value=!1,v.value=!1,O.value.length>0&&(i.value=!0)},ce=(c=0)=>{A.value=c,i.value=!0},ve=c=>new Promise(C=>{if(c.rotation===0||!m.value){if(!c.isNew&&!c.file){C({file:null,width:c.width,height:c.height,isOriginal:!0});return}C({file:c.file,width:c.width,height:c.height});return}const b=new Image;b.onload=async()=>{try{const T=m.value,l=T.getContext("2d"),f=b.width,M=b.height;let E,j;c.rotation===90||c.rotation===270?(E=M,j=f):(E=f,j=M),T.width=E,T.height=j,l.clearRect(0,0,T.width,T.height),l.translate(T.width/2,T.height/2),l.rotate(c.rotation*Math.PI/180),l.drawImage(b,-f/2,-M/2,f,M),l.setTransform(1,0,0,1,0,0);const Y=await new Promise(de=>{T.toBlob(de,"image/jpeg",.9)}),X=new File([Y],c.file?c.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),ne=await J(X);C({file:ne,width:E,height:j})}catch(T){console.error("Error processing rotated image:",T),C({file:c.file,width:c.width,height:c.height})}},b.onerror=()=>{console.error("Failed to load image for rotation processing:",c.preview),C({file:c.file,width:c.width,height:c.height})},b.src=c.preview}),se=c=>{try{const C={images:c.map(b=>{var T;return{fileName:((T=b.file)==null?void 0:T.name)||`image-${Date.now()}.jpg`,rotation:b.rotation||0,width:b.width||0,height:b.height||0,timestamp:Date.now()}}),inspectionId:a.inspectionId,pointId:a.pointId};localStorage.setItem(z,JSON.stringify(C))}catch(C){console.error("Error saving backup:",C)}},te=()=>{localStorage.removeItem(z)},ge=async c=>{I.value=!0;const C=[],b=[];if(!a.pointId){alert("Error: Point ID is missing. Cannot upload image."),I.value=!1;return}try{se(c);for(const T of c){if(!T.isNew&&T.rotation===0&&T.id&&T.image_path){C.push({id:T.id,image_path:T.image_path,width:T.width,height:T.height,rotation:0,preview:T.preview,isUploaded:!0});continue}const{file:l,width:f,height:M,isOriginal:E}=await ve(T);if(E&&!T.isNew){C.push({id:T.id,image_path:T.image_path,width:T.width,height:T.height,rotation:T.rotation||0,preview:T.preview,isUploaded:!0});continue}l&&b.push({file:l,width:f,height:M,rotation:T.rotation||0,originalImage:T})}n(),b.length>0?await ue(b,C):(k("update:modelValue",C),k("save",a.pointId))}catch(T){console.error("Error during image processing:",T),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{I.value=!1}},ue=async(c,C)=>{L.value=c.length,q.value=0,P.value=0;const b=[...C];let T=0;try{for(let l=0;l<c.length;l++){const f=c[l],M=new FormData;M.append("inspection_id",a.inspectionId),M.append("point_id",a.pointId),M.append("images[]",f.file);const E=x.value.findIndex(j=>{var Y;return j.preview===((Y=f.originalImage)==null?void 0:Y.preview)});E!==-1&&(x.value[E].isUploading=!0,x.value[E].isFailed=!1);try{const Y=(await Be.post(route("inspections.upload-image"),M,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:X=>{if(X.total){const ne=Math.round(X.loaded*100/X.total);P.value=Math.round((l+X.loaded/X.total)/c.length*100),q.value=l+1}}})).data.images;if(Y&&Y.length>0){const X=Y[0];if(b.push({id:X.image_id,image_path:X.path,width:X.width||f.width||0,height:X.height||f.height||0,rotation:f.rotation||0,preview:X.public_url,isUploaded:!0}),E!==-1){const ne=x.value.splice(E,1)[0];ne.preview&&ne.preview.startsWith("blob:")&&URL.revokeObjectURL(ne.preview)}T++}}catch(j){console.error(`Error uploading image ${l+1}:`,j),E!==-1&&(x.value[E].isUploading=!1,x.value[E].isFailed=!0)}}T>0&&(k("update:modelValue",b),k("save",a.pointId),k("uploaded",{pointId:a.pointId,images:b,newImagesCount:T})),T===c.length&&te(),console.log(`✅ Successfully uploaded ${T}/${c.length} images`)}catch(l){console.error("Error in upload process:",l),c.forEach(f=>{const M=x.value.findIndex(E=>{var j;return E.preview===((j=f.originalImage)==null?void 0:j.preview)});M!==-1&&(x.value[M].isUploading=!1,x.value[M].isFailed=!0)})}finally{P.value=0,q.value=0,L.value=0,I.value=!1}},H=async c=>{if(!c||!c.file){console.error("No file to retry upload");return}I.value=!0;const C=[...a.modelValue];try{const b=new FormData;b.append("inspection_id",a.inspectionId),b.append("point_id",a.pointId),b.append("images[]",c.file);const T=x.value.findIndex(M=>M.preview===c.preview);T!==-1&&(x.value[T].isUploading=!0,x.value[T].isFailed=!1);const f=(await Be.post(route("inspections.upload-image"),b,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(f&&f.length>0){const M=f[0];if(C.push({id:M.image_id,image_path:M.path,width:M.width||c.width||0,height:M.height||c.height||0,rotation:c.rotation||0,preview:M.public_url,isUploaded:!0}),T!==-1){const j=x.value.splice(T,1)[0];j.preview&&j.preview.startsWith("blob:")&&URL.revokeObjectURL(j.preview)}k("update:modelValue",C),k("save",a.pointId),k("uploaded",{pointId:a.pointId,images:C,newImagesCount:1}),x.value.some(j=>j.isFailed)||te(),console.log("✅ Successfully retried upload for 1 image")}}catch(b){console.error("Error retrying upload:",b),previewIndex!==-1&&(x.value[previewIndex].isUploading=!1,x.value[previewIndex].isFailed=!0)}finally{I.value=!1}},_e=c=>{if(c){if(c.id&&!c.isNew)Ae(c);else{const C=x.value.findIndex(b=>b.preview&&b.preview===c.preview&&b.isNew||b.id&&b.id===c.id);if(C!==-1){const b=x.value.splice(C,1)[0];b.preview&&b.preview.startsWith("blob:")&&URL.revokeObjectURL(b.preview)}k("update:modelValue",a.modelValue.filter(b=>!(b.id&&b.id===c.id)&&!(b.preview&&b.preview===c.preview)))}A.value>=O.value.length&&(A.value=Math.max(0,O.value.length-1)),O.value.length===0&&n()}},Ae=async c=>{var b,T;if(c.id||c.image_path)try{await Be.delete(route("inspections.delete-image"),{data:{image_id:c.id,image_path:c.image_path}})}catch(l){console.error("Error deleting image from server:",l),(T=(b=l.response)==null?void 0:b.data)!=null&&T.message?alert(`Failed to delete image from server: ${l.response.data.message}`):alert(`Failed to delete image from server: ${l.message}`);return}c.preview&&c.preview.startsWith("blob:")&&URL.revokeObjectURL(c.preview);const C=a.modelValue.filter(l=>l.id!==c.id);k("update:modelValue",C),x.value=x.value.filter(l=>l.isNew&&c.isNew?l.preview!==c.preview:l.id!==c.id),k("removeImage",{image:c}),i.value&&O.value.length===0?n():i.value&&A.value>=O.value.length&&(A.value=Math.max(0,O.value.length-1))};return De(()=>{try{localStorage.getItem(z)&&console.log("Found backup images, ready for recovery if needed")}catch(c){console.error("Error loading backup:",c)}}),(c,C)=>(s(),o("div",null,[e("input",{ref_key:"galleryInput",ref:u,type:"file",accept:w.value,class:"hidden",onChange:le,multiple:V.value,disabled:I.value},null,40,is),e("canvas",{ref_key:"processingCanvas",ref:m,class:"hidden"},null,512),e("p",ls,"Foto Maksimal: "+U(t.settings.max_files)+" | Rasio: "+U(t.settings.camera_aspect_ratio),1),O.value.length===0?(s(),o("label",{key:0,onClick:B,class:Q(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:I.value},[e("div",us,[C[2]||(C[2]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),C[3]||(C[3]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",ds,"Tipe: "+U(w.value),1)])],8,rs)):(s(),o("div",{key:1,class:Q(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":t.settings.max_files==1,"bg-transparent":t.settings.max_files>1}]),"aria-label":"Image gallery"},[I.value?(s(),o("div",cs,[e("div",gs,[C[4]||(C[4]=e("span",{class:"text-sm font-medium text-blue-700"},"Mengupload gambar...",-1)),e("span",ps,U(P.value)+"%",1)]),e("div",ms,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:Ve({width:P.value+"%"})},null,4)]),e("p",vs,U(q.value)+"/"+U(L.value)+" gambar terupload",1)])):r("",!0),t.settings.max_files===1?(s(),o("div",fs,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:C[0]||(C[0]=b=>ce(0))},[e("img",{src:D(O.value[0]),class:"w-full h-full object-cover"},null,8,hs),O.value[0].isUploading?(s(),o("div",bs,C[5]||(C[5]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):r("",!0)]),e("button",{onClick:C[1]||(C[1]=Pe(b=>Ae(O.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:I.value},C[6]||(C[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ye(" Hapus Foto ")]),8,ys)])):(s(),o("div",xs,[V.value&&O.value.length<t.settings.max_files?(s(),o("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:B,disabled:I.value},C[7]||(C[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,ks)):r("",!0),(s(!0),o(Ie,null,$e(O.value,(b,T)=>(s(),o("div",{key:b.id||b.preview,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:l=>b.isFailed?H(b):ce(T)},[e("img",{src:D(b),class:"w-full h-full object-cover"},null,8,Is),b.isNew||b.rotation!==0?(s(),o("div",$s,[b.isNew?(s(),o("span",Ss,"BARU")):r("",!0),b.rotation!==0?(s(),o("span",As,"ROTASI")):r("",!0)])):r("",!0),b.isUploading?(s(),o("div",_s,C[8]||(C[8]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):r("",!0),b.isFailed?(s(),o("div",Cs,C[9]||(C[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"text-xs font-medium"},"Retry",-1)]))):r("",!0)],8,ws))),128))]))],2)),t.error?(s(),o("p",Ts,U(t.error),1)):r("",!0),we(sn,{show:v.value,settings:t.settings,onClose:_,onOpenWebcam:ie,onTriggerGallery:W},null,8,["show","settings"]),we(os,{show:d.value,"aspect-ratio":F.value,settings:t.settings,point:t.point,onClose:p,onPhotoCaptured:re},null,8,["show","aspect-ratio","settings","point"]),we(Pn,{show:i.value,images:O.value,point:t.point,"initial-index":A.value,"allow-multiple":V.value,"max-files":t.settings.max_files,"is-uploading":I.value,"aspect-ratio":F.value,"upload-progress":P.value,"current-upload":q.value,"total-upload":L.value,onClose:n,onSaveImages:ge,onRemovePreviewImage:_e,onTriggerAddMorePhotos:B,onRetryImage:H},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},qe=Ne(Ns,[["__scopeId","data-v-3180dd6e"]]),Es={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Vs={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Us={class:"px-4 pb-2 border-b border-gray-200"},Ms={class:"text-lg font-semibold text-gray-900"},Ds={key:0,class:"text-sm text-gray-500 mt-1"},Ps={class:"flex-1 overflow-y-auto p-4"},Rs={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Ls={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(t){return(Z,a)=>(s(),Se(Re,{name:"bottom-sheet"},{default:Te(()=>[t.show?(s(),o("div",Es,[a[1]||(a[1]=e("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),e("div",Vs,[a[0]||(a[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Us,[e("h3",Ms,U(t.title),1),t.subtitle?(s(),o("p",Ds,U(t.subtitle),1)):r("",!0)]),e("div",Ps,[xt(Z.$slots,"default",{},void 0,!0)]),Z.$slots.footer?(s(),o("div",Rs,[xt(Z.$slots,"footer",{},void 0,!0)])):r("",!0)])])):r("",!0)]),_:3}))}},Bs=Ne(Ls,[["__scopeId","data-v-fd942535"]]),js={class:"space-y-4"},Fs={key:0,class:"mt-2"},qs={key:1,class:"mt-2"},Os={key:2,class:"mt-2"},Ks={key:3,class:"mt-2"},Hs={key:4,class:"mt-2"},zs={class:"text-sm font-medium text-gray-700 mb-2"},Gs={key:0,class:"text-red-500"},Ws={key:0,class:"text-xs text-red-500"},Zs=["name","value","checked"],Js={key:6,class:"space-y-2"},Ys={key:0,class:"text-red-500"},Xs={key:1,class:"text-xs text-red-500"},Qs={key:7,class:"mt-4"},eo={class:"text-sm font-medium text-gray-700 mb-2"},to={key:0,class:"text-red-500"},ao={key:0,class:"text-xs text-red-500"},no={class:"flex gap-2"},so=["disabled"],Tt={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:String,notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(t,{emit:Z}){const a=t,k=Z,u=d=>k("hapus",d),m=ee(()=>a.options.find(d=>d.value===a.selectedValue)),v=ee(()=>{var i,x,A,I,P,q,L;if(a.point.input_type==="text"&&(!((i=a.notesValue)!=null&&i.trim())||a.point.settings.min_length&&a.notesValue.length<a.point.settings.min_length||a.point.settings.max_length&&a.notesValue.length>a.point.settings.max_length)||a.point.input_type==="number"&&(!((x=a.notesValue)!=null&&x.trim())||a.point.settings.min&&a.notesValue.length<a.point.settings.min||a.point.settings.max&&a.notesValue.length>a.point.settings.max)||a.point.input_type==="account"&&(!((A=a.notesValue)!=null&&A.trim())||a.point.settings.min_value&&a.notesValue.length<a.point.settings.min_value||a.point.settings.max_value&&a.notesValue.length>a.point.settings.max_value)||a.point.input_type==="date"&&(!((I=a.notesValue)!=null&&I.trim())||a.point.settings.min_date&&a.notesValue.length<a.point.settings.min_date||a.point.settings.max_date&&a.notesValue.length>a.point.settings.max_date))return!1;if(a.point.input_type==="imageTOradio"){if(a.imagesValue.length===0)return!1;const G=a.imagesValue.some(V=>V.status==="error"),z=a.imagesValue.some(V=>V.status==="uploading");if(G||z)return!1}if(a.options.length&&!a.selectedValue)return!1;const d=m.value;if(a.showTextarea&&((P=d==null?void 0:d.settings)!=null&&P.show_textarea)&&(!((q=a.notesValue)!=null&&q.trim())||d.settings.min_length&&a.notesValue.length<d.settings.min_length||d.settings.max_length&&a.notesValue.length>d.settings.max_length))return!1;if(a.showImageUpload&&((L=d==null?void 0:d.settings)!=null&&L.show_image_upload)){if(a.imagesValue.length===0||d.settings.max_files&&a.imagesValue.length>d.settings.max_files)return!1;const G=a.imagesValue.some(V=>V.status==="error"),z=a.imagesValue.some(V=>V.status==="uploading");if(G||z)return!1}return!0});return(d,i)=>(s(),Se(Bs,{show:t.show,title:t.title,subtitle:t.subtitle,onClose:i[18]||(i[18]=x=>d.$emit("close"))},{footer:Te(()=>[t.selectedPoint?(s(),o("button",{key:0,onClick:i[15]||(i[15]=x=>u(t.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},i[20]||(i[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),ye(" Hapus Data ")]))):r("",!0),e("div",no,[e("button",{type:"button",onClick:i[16]||(i[16]=x=>d.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:i[17]||(i[17]=x=>d.$emit("save")),disabled:!v.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,so)])]),default:Te(()=>{var x,A,I,P,q,L,G,z,V,w,F,O,D,B,W,ie,_,p,n,g,N,J,le,re,ce,ve,se,te,ge,ue;return[e("div",js,[t.point.input_type==="text"?(s(),o("div",Fs,[we($t,{"model-value":t.notesValue,required:(x=t.point.settings)==null?void 0:x.is_required,"min-length":(A=t.point.settings)==null?void 0:A.min_length,"max-length":(I=t.point.settings)==null?void 0:I.max_length,allowSpace:(P=t.point.settings)==null?void 0:P.allow_space,textTransform:(q=t.point.settings)==null?void 0:q.text_transform,placeholder:((L=t.point.settings)==null?void 0:L.placeholder)||"Masukan text",error:d.error,"onUpdate:modelValue":i[0]||(i[0]=H=>d.$emit("update:notesValue",H)),onSave:i[1]||(i[1]=H=>d.$emit("saveText",H))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):r("",!0),t.point.input_type==="number"?(s(),o("div",qs,[we(St,{"model-value":t.notesValue,required:(G=t.point.settings)==null?void 0:G.is_required,min:(z=t.point.settings)==null?void 0:z.min,max:(V=t.point.settings)==null?void 0:V.max,step:((w=t.point.settings)==null?void 0:w.step)||1,placeholder:((F=t.point.settings)==null?void 0:F.placeholder)||"Masukan number",error:d.error,"onUpdate:modelValue":i[2]||(i[2]=H=>d.$emit("update:notesValue",H)),onSave:i[3]||(i[3]=H=>d.$emit("saveNumber",H))},null,8,["model-value","required","min","max","step","placeholder","error"])])):r("",!0),t.point.input_type==="account"?(s(),o("div",Os,[we(_t,{"model-value":t.notesValue,required:(O=t.point.settings)==null?void 0:O.is_required,placeholder:((D=t.point.settings)==null?void 0:D.placeholder)||"Masukkan nilai",error:d.error,"point-id":t.pointId,settings:t.point.settings,"onUpdate:modelValue":i[4]||(i[4]=H=>d.$emit("update:notesValue",H)),onSave:i[5]||(i[5]=H=>d.$emit("saveAccount",H))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):r("",!0),t.point.input_type==="date"?(s(),o("div",Ks,[we(At,{"model-value":t.notesValue,required:(B=t.point.settings)==null?void 0:B.is_required,"min-date":(W=t.point.settings)==null?void 0:W.min_date,"max-date":(ie=t.point.settings)==null?void 0:ie.max_date,error:d.error,"onUpdate:modelValue":i[6]||(i[6]=H=>d.$emit("update:notesValue",H)),onSave:i[7]||(i[7]=H=>d.$emit("saveDate",H))},null,8,["model-value","required","min-date","max-date","error"])])):r("",!0),t.point.input_type==="imageTOradio"?(s(),o("div",Hs,[e("h4",zs,[(_=t.point.settings)!=null&&_.required?(s(),o("span",Gs,"*")):r("",!0)]),we(qe,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point.inspection_point,"inspection-id":t.inspectionId,settings:t.point.settings,"onUpdate:modelValue":i[8]||(i[8]=H=>d.$emit("update:imagesValue",H)),onSave:i[9]||(i[9]=H=>d.$emit("saveImage",H))},null,8,["model-value","point-id","point","inspection-id","settings"]),(p=t.point.settings)!=null&&p.required&&t.imagesValue.length===0?(s(),o("p",Ws," Foto wajib diupload ")):r("",!0)])):r("",!0),t.options.length?(s(),o("div",{key:5,class:Q(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ie,null,$e(t.options,(H,_e)=>(s(),o("label",{key:_e,class:"cursor-pointer"},[e("input",{type:"radio",name:t.name,value:H.value,checked:t.selectedValue===H.value,onChange:i[10]||(i[10]=Ae=>d.$emit("update:selectedValue",Ae.target.value)),class:"hidden peer"},null,40,Zs),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.selectedValue===H.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.selectedValue!==H.value}])},U(H.label),3)]))),128))],2)):r("",!0),t.showTextarea&&((g=(n=m.value)==null?void 0:n.settings)!=null&&g.show_textarea)?(s(),o("div",Js,[(N=m.value.settings)!=null&&N.required?(s(),o("span",Ys,"*")):r("",!0),we(Ct,{"model-value":t.notesValue,"point-id":t.pointId,"inspection-id":t.inspectionId,settings:m.value.settings,required:(J=m.value.settings)==null?void 0:J.required,"min-length":(le=m.value.settings)==null?void 0:le.min_length,"max-length":(re=m.value.settings)==null?void 0:re.max_length,placeholder:((ce=m.value.settings)==null?void 0:ce.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":i[11]||(i[11]=H=>d.$emit("update:notesValue",H)),onSave:i[12]||(i[12]=H=>d.$emit("saveTextarea",H))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(ve=m.value.settings)!=null&&ve.required&&!t.notesValue?(s(),o("p",Xs," Keterangan wajib diisi ")):r("",!0)])):r("",!0),t.showImageUpload&&((te=(se=m.value)==null?void 0:se.settings)!=null&&te.show_image_upload)?(s(),o("div",Qs,[e("h4",eo,[i[19]||(i[19]=ye(" Upload Foto ")),(ge=m.value.settings)!=null&&ge.required?(s(),o("span",to,"*")):r("",!0)]),we(qe,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,settings:m.value.settings,"onUpdate:modelValue":i[13]||(i[13]=H=>d.$emit("update:imagesValue",H)),onSave:i[14]||(i[14]=H=>d.$emit("saveImage",H))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ue=m.value.settings)!=null&&ue.required&&t.imagesValue.length===0?(s(),o("p",ao," Foto wajib diupload ")):r("",!0)])):r("",!0)])]}),_:1},8,["show","title","subtitle"]))}},oo={class:"mt-2 space-y-2"},io=["name","value","checked","onChange","required"],lo={key:0,class:"p-2 rounded-lg bg-gray-50"},ro={key:0,class:"mt-2"},uo={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},co=["src"],go={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},po={key:1,class:"mt-2"},mo={class:"text-sm text-gray-600"},vo={key:2,class:"mt-2 text-sm text-red-600"},fo={__name:"InputRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:Z}){const a=t,k=Z,u=$(a.notes),m=$([...a.images]),v=$(!1),d=$(""),i=$([]),x=$(""),A=$([]),I=ee(()=>a.options.find(D=>D.value===a.modelValue)),P=D=>D.settings&&(D.settings.show_textarea||D.settings.show_image_upload);me(()=>a.notes,D=>{u.value=D}),me(()=>a.images,D=>{m.value=[...D]}),me(()=>a.modelValue,D=>{D&&(x.value=D)});const q=D=>{k("update:modelValue",D.value),P(D)?G():k("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:D.value,notes:"",images:[]})},L=D=>D.preview||(D.image_path?`/${D.image_path}`:D),G=()=>{x.value=a.modelValue,d.value=u.value,i.value=[...m.value],A.value=[...m.value],v.value=!0},z=()=>{d.value="",i.value=[],x.value="",v.value=!1},V=D=>{i.value=D,m.value=[...D],k("update:images",[...D]),k("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:u.value,images:[...D]})},w=D=>{},F=()=>{x.value!==a.modelValue&&k("update:modelValue",x.value),u.value=d.value,k("update:notes",d.value),m.value=[...i.value],k("update:images",[...i.value]),k("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:x.value,notes:d.value,images:i.value}),v.value=!1},O=D=>{x.value="",d.value="",i.value=[],u.value="",m.value=[],k("update:modelValue",""),k("update:notes",""),k("update:images",[]),k("hapus",D),v.value=!1};return(D,B)=>{var W,ie,_;return s(),o("div",oo,[e("div",{class:Q(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ie,null,$e(t.options,(p,n)=>(s(),o("label",{key:n,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:p.value,checked:t.modelValue===p.value,onChange:g=>q(p),class:"hidden peer",required:t.required},null,40,io),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===p.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==p.value}])},U(p.label),3)]))),128))],2),t.modelValue&&I.value&&P(I.value)?(s(),o("div",lo,[e("div",{class:"flex justify-between items-start"},[B[4]||(B[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:G,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),t.images.length>0&&((W=I.value.settings)!=null&&W.show_image_upload)?(s(),o("div",ro,[e("div",uo,[(s(!0),o(Ie,null,$e(t.images,(p,n)=>(s(),o("div",{key:n,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:L(p),class:"w-full h-full object-cover rounded"},null,8,co),n===3&&t.images.length>4?(s(),o("span",go," +"+U(t.images.length-4),1)):r("",!0)]))),128))])])):r("",!0),t.notes&&((ie=I.value.settings)!=null&&ie.show_textarea)?(s(),o("div",po,[e("p",mo,U(t.notes),1)])):r("",!0)])):r("",!0),v.value?(s(),Se(Tt,{key:(_=t.selectedPoint)==null?void 0:_.id,show:v.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":x.value,"notes-value":d.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":B[0]||(B[0]=p=>x.value=p),"onUpdate:notesValue":B[1]||(B[1]=p=>d.value=p),"onUpdate:imagesValue":B[2]||(B[2]=p=>V(p)),onClose:z,onSave:F,onSaveTextarea:D.handleTextareaSave,onSaveImage:w,onHapus:B[3]||(B[3]=p=>O(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):r("",!0),t.error?(s(),o("p",vo,U(t.error),1)):r("",!0)])}}},ho={class:"mt-2 space-y-2"},bo={key:0,class:"flex flex-wrap gap-3"},yo={key:1,class:"p-2"},xo={key:0,class:"mt-2"},ko={class:"flex gap-2 overflow-x-auto scrollbar-hide"},wo=["src"],Io={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},$o=["name","value","checked"],So={key:1,class:"mt-2"},Ao={class:"text-sm text-gray-600"},_o={key:3,class:"mt-2 text-sm text-red-600"},Co={__name:"InputImageToRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:Z}){const a=t,k=Z,u=$(a.notes),m=$([...a.images]),v=$(!1),d=$(""),i=$([]),x=$(""),A=$([]),I=ee(()=>a.options.find(w=>w.value===a.modelValue)),P=w=>w.preview||(w.image_path?`/${w.image_path}`:w);me(()=>a.notes,w=>{u.value=w});const q=()=>{x.value=a.modelValue||"",d.value=u.value,i.value=[...m.value],A.value=[...m.value],v.value=!0},L=()=>{d.value="",i.value=[],x.value="",v.value=!1},G=w=>{i.value=w,m.value=[...w],k("update:images",[...w]),k("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:u.value,images:[...w]})},z=()=>{x.value!==a.modelValue&&k("update:modelValue",x.value),u.value=d.value,k("update:notes",d.value),m.value=[...i.value],k("update:images",[...i.value]),k("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:x.value,notes:d.value,images:i.value}),v.value=!1},V=w=>{x.value="",d.value="",i.value=[],u.value="",m.value=[],k("update:modelValue",""),k("update:notes",""),k("update:images",[]),k("hapus",w),v.value=!1};return(w,F)=>{var O,D;return s(),o("div",ho,[!t.modelValue&&m.value.length===0&&!u.value?(s(),o("div",bo,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:q},F[4]||(F[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(s(),o("div",yo,[e("div",{class:"flex justify-between items-start"},[F[5]||(F[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:q,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),m.value.length>0?(s(),o("div",xo,[e("div",ko,[(s(!0),o(Ie,null,$e(m.value,(B,W)=>(s(),o("div",{key:W,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:P(B),class:"w-full h-full object-cover rounded"},null,8,wo),W===3&&m.value.length>4?(s(),o("span",Io," +"+U(m.value.length-4),1)):r("",!0)]))),128))])])):r("",!0),e("div",{class:Q(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ie,null,$e(t.options,(B,W)=>(s(),o("label",{key:W,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:B.value,checked:t.modelValue===B.value,disabled:!0,class:"hidden peer"},null,8,$o),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===B.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==B.value}])},U(B.label),3)]))),128))],2),u.value&&((O=I.value.settings)!=null&&O.show_textarea)?(s(),o("div",So,[e("p",Ao,U(u.value),1)])):r("",!0)])),v.value?(s(),Se(Tt,{key:(D=t.selectedPoint)==null?void 0:D.id,show:v.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":x.value,"notes-value":d.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":F[0]||(F[0]=B=>x.value=B),"onUpdate:notesValue":F[1]||(F[1]=B=>d.value=B),"onUpdate:imagesValue":F[2]||(F[2]=B=>G(B)),onClose:L,onSave:z,onHapus:F[3]||(F[3]=B=>V(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):r("",!0),t.error?(s(),o("p",_o,U(t.error),1)):r("",!0)])}}},To={class:"text-base font-semibold text-indigo-700"},No={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Eo={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Vo={class:"text-base font-semibold text-indigo-700"},Uo={class:"p-4 space-y-4"},Mo={key:0,class:"flex justify-end py-1"},Do=["onClick"],Po={key:1,class:"space-y-2"},Ro={class:"flex items-start justify-between"},Lo={class:"flex-1"},Bo={class:"block text-sm font-medium text-gray-700"},jo={key:0,class:"text-red-500"},Fo={key:1,class:"italic text-xs text-gray-400 ml-2"},qo={key:0,class:"mt-1"},Oo={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Ko={key:0},Ho={key:1},zo={key:2},Go={key:3},Wo={key:4},Zo={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},Jo={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},Yo={class:"text-xs mt-1 list-disc list-inside"},Xo={key:0},Qo={key:1},ei={key:2},ti={key:3},ai={key:4},ni={key:0,class:"text-center py-8 text-gray-500"},si={key:0,class:"text-xs text-gray-400"},oi={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(t,{emit:Z}){const a=t,k=Z,u=wt("vehicleFeatures",$(null));u.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Vt("vehicleFeatures",u);const m=$(!1),v=$([]),d=$(!0),i=$(null),x=Ut(),A={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};De(()=>{const _=new IntersectionObserver(([p])=>{d.value=p.isIntersecting},{threshold:.1});i.value&&_.observe(i.value),Le(()=>{i.value&&_.unobserve(i.value)})});const I=()=>{m.value=!m.value,m.value||(v.value=[])},P=ee(()=>(a.category.points||[]).some(_=>_.is_default===!1)),q=_=>!_||!Array.isArray(_)?[]:_.map(p=>A[p]||p),L=_=>{var N,J;const p=_.settings;if(!G(_))return!0;const n=(N=a.car)==null?void 0:N.transmission,g=(J=a.car)==null?void 0:J.fuel_type;return!(p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0&&n&&!p.transmission.includes(n)||p.fuel_type&&p.fuel_type.trim()!==""&&g&&p.fuel_type!==g||p.rear_door&&(!u.value||!u.value.rear_door)||p.pick_up&&(!u.value||!u.value.pick_up)||p.box&&(!u.value||!u.value.box))},G=_=>{const p=_.settings;return!!(p!=null&&p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0||p!=null&&p.fuel_type&&p.fuel_type.trim()!==""||p!=null&&p.rear_door||p!=null&&p.pick_up||p!=null&&p.box)},z=_=>G(_)&&(m.value||L(_)),V=ee(()=>{const _=a.category.points||[],p=[];let n=[];return m.value?a.category.isDamageMenu?_.filter(g=>{var N;return g.is_default||F((N=g.inspection_point)==null?void 0:N.id)||m.value}):_:a.category.isDamageMenu?_.filter(g=>{var J;const N=(J=g.inspection_point)==null?void 0:J.id;return F(N)||g.is_default||v.value.includes(N)}):(_.forEach(g=>{var se;const N=(se=g.inspection_point)==null?void 0:se.id,J=F(N),le=v.value.includes(N),ce=!G(g)||L(g);(g.is_default||J||le)&&ce?(n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(te=>te.inspection_point.id)}),n.forEach(te=>{v.value.includes(te.inspection_point.id)&&p.push(te)}),n=[]),p.push(g)):(!G(g)||L(g))&&n.push(g)}),n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(g=>g.inspection_point.id)}),n.forEach(g=>{v.value.includes(g.inspection_point.id)&&p.push(g)})),p.filter(g=>{var N,J;return g.is_link||g.is_default||F((N=g.inspection_point)==null?void 0:N.id)||v.value.includes((J=g.inspection_point)==null?void 0:J.id)}))});ee(()=>V.value.filter(_=>!_.is_link));const w=_=>{m.value=!1,_.forEach(p=>{v.value.includes(p)||v.value.push(p)})},F=_=>{if(!_)return!1;const p=x.props.existingResults[_]!==void 0,n=x.props.existingImages[_]&&x.props.existingImages[_].length>0,g=a.form.results[_]&&(a.form.results[_].status||a.form.results[_].note),N=a.form.images[_]&&a.form.images[_].length>0;return p||n||g||N},O=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],D=_=>{var g,N,J,le,re,ce,ve,se,te;const p=a.form.results[(g=_.inspection_point)==null?void 0:g.id],n=a.form.images[(N=_.inspection_point)==null?void 0:N.id];if(!p)return!1;switch(_.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!p.note;case"select":case"radio":if(!p.status)return!1;const ge=(le=(J=_.settings)==null?void 0:J.radios)==null?void 0:le.find(H=>H.value===p.status);return!(ge!=null&&ge.settings&&(ge.settings.show_textarea&&!((re=p.note)!=null&&re.trim())||ge.settings.show_image_upload&&(n==null?void 0:n.length)===0));case"imageTOradio":if((n==null?void 0:n.length)===0||!p.status)return!1;const ue=(ve=(ce=_.settings)==null?void 0:ce.radios)==null?void 0:ve.find(H=>H.value===p.status);return!(ue!=null&&ue.settings&&ue.settings.show_textarea&&!((se=p.note)!=null&&se.trim()));case"image":return(n==null?void 0:n.length)>0;default:return!!p.status||!!((te=p.note)!=null&&te.trim())}},B=(_,p,n)=>{k("updateResult",{pointId:_,type:n,value:p})},W=_=>{console.log("Save result for point:",_)},ie=_=>{k("hapusPoint",_)};return me(()=>a.form.results,_=>{},{deep:!0}),me(()=>a.form.images,_=>{},{deep:!0}),me(()=>a.car,_=>{console.log("Car data updated:",_)},{deep:!0}),me(u,_=>{console.log("Vehicle features updated:",_)},{deep:!0}),(_,p)=>(s(),o(Ie,null,[a.head==="vertical"?(s(),o("div",{key:0,class:Q(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[e("h4",To,U(t.category.name),1),P.value?(s(),o("button",{key:0,onClick:I,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},U(m.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):r("",!0)])):r("",!0),e("div",{class:Q(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",a.head==="vertical"?"pt-6":""])},[!d.value&&P.value?(s(),o("button",{key:0,onClick:I,class:"fixed top-3 right-2 z-50 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[m.value?(s(),o("svg",No,p[0]||(p[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(s(),o("svg",Eo,p[1]||(p[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):r("",!0),a.head==="horizontal"?(s(),o("div",{key:1,ref_key:"categoryHeader",ref:i,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",Vo,U(t.category.name),1),P.value?(s(),o("button",{key:0,onClick:I,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},U(m.value?"Sembunyikan":"Tampilkan Point Lain"),1)):r("",!0)],512)):r("",!0),e("div",Uo,[(s(!0),o(Ie,null,$e(V.value,(n,g)=>{var N,J,le,re,ce,ve,se,te,ge,ue,H,_e,Ae,c,C,b,T,l,f,M,E,j,Y,X,ne,de,xe,ke,he,S,h,ae,K,oe,fe,be,pe,Ue,Oe,Ke,He,ze,Ge,We,Ze,Je,Ye,Xe,Qe,et,tt,at,nt,st,ot,it,lt,rt,ut,dt,ct,gt,pt,mt,vt,ft,ht,bt,yt;return s(),o("div",{key:g,class:Q(["space-y-2 last:border-0 last:pb-0",n.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[n.is_link?(s(),o("div",Mo,[e("button",{onClick:R=>w(n.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+U(n.count)+" Point Tersembunyi ",9,Do)])):(s(),o("div",Po,[e("div",Ro,[e("div",Lo,[e("label",Bo,[ye(U((N=n.inspection_point)==null?void 0:N.name)+" ",1),(J=n.settings)!=null&&J.is_required?(s(),o("span",jo,"*")):r("",!0),!n.is_default&&!F((le=n.inspection_point)==null?void 0:le.id)?(s(),o("span",Fo," (opsional) ")):r("",!0)]),z(n)?(s(),o("div",qo,[G(n)?(s(),o("div",Oo,[(re=n.settings)!=null&&re.transmission?(s(),o("div",Ko,U(n.settings.transmission.join(", ")),1)):r("",!0),(ce=n.settings)!=null&&ce.fuel_type?(s(),o("div",Ho,U(n.settings.fuel_type),1)):r("",!0),(ve=n.settings)!=null&&ve.rear_door?(s(),o("div",zo," Pintu Belakang ")):r("",!0),(se=n.settings)!=null&&se.pick_up?(s(),o("div",Go," Tipe Pick Up ")):r("",!0),(te=n.settings)!=null&&te.box?(s(),o("div",Wo," Memiliki Box ")):r("",!0)])):r("",!0)])):r("",!0)]),D(n)?(s(),o("span",Zo," ✓ ")):r("",!0)]),n.input_type==="text"&&L(n)?(s(),Se($t,{key:0,modelValue:t.form.results[(ge=n.inspection_point)==null?void 0:ge.id].note,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(ue=n.settings)==null?void 0:ue.is_required,"min-length":(H=n.settings)==null?void 0:H.min_length,"max-length":(_e=n.settings)==null?void 0:_e.max_length,allowSpace:(Ae=n.settings)==null?void 0:Ae.allow_space,textTransform:(c=n.settings)==null?void 0:c.text_transform,placeholder:((C=n.settings)==null?void 0:C.placeholder)||"Masukan text",error:t.form.errors[`results.${(b=n.inspection_point)==null?void 0:b.id}.note`],onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):r("",!0),n.input_type==="number"&&L(n)?(s(),Se(St,{key:1,modelValue:t.form.results[(T=n.inspection_point)==null?void 0:T.id].note,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(l=n.settings)==null?void 0:l.is_required,min:(f=n.settings)==null?void 0:f.min,max:(M=n.settings)==null?void 0:M.max,step:((E=n.settings)==null?void 0:E.step)||1,placeholder:((j=n.settings)==null?void 0:j.placeholder)||"Masukan number",error:t.form.errors[`results.${(Y=n.inspection_point)==null?void 0:Y.id}.note`],onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):r("",!0),n.input_type==="account"&&L(n)?(s(),Se(_t,{key:2,modelValue:t.form.results[(X=n.inspection_point)==null?void 0:X.id].note,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(ne=n.settings)==null?void 0:ne.is_required,placeholder:((de=n.settings)==null?void 0:de.placeholder)||"Masukkan nilai",error:t.form.errors[`results.${(xe=n.inspection_point)==null?void 0:xe.id}.note`],"point-id":(ke=n.inspection_point)==null?void 0:ke.id,settings:n.settings,onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):r("",!0),n.input_type==="date"&&L(n)?(s(),Se(At,{key:3,modelValue:t.form.results[(he=n.inspection_point)==null?void 0:he.id].note,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(S=n.settings)==null?void 0:S.is_required,"min-date":(h=n.settings)==null?void 0:h.min_date,"max-date":(ae=n.settings)==null?void 0:ae.max_date,error:t.form.errors[`results.${(K=n.inspection_point)==null?void 0:K.id}.note`],onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):r("",!0),n.input_type==="textarea"&&L(n)?(s(),Se(Ct,{key:4,modelValue:t.form.results[(oe=n.inspection_point)==null?void 0:oe.id].note,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(fe=n.settings)==null?void 0:fe.is_required,"min-length":(be=n.settings)==null?void 0:be.min_length,"max-length":(pe=n.settings)==null?void 0:pe.max_length,placeholder:((Ue=n.settings)==null?void 0:Ue.placeholder)||"Masukkan teks di sini",settings:n.settings,error:t.form.errors[`results.${(Oe=n.inspection_point)==null?void 0:Oe.id}.note`],onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):r("",!0),n.input_type==="radio"&&L(n)?(s(),Se(fo,{key:5,modelValue:t.form.results[(Ke=n.inspection_point)==null?void 0:Ke.id].status,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"status")}],notes:t.form.results[(He=n.inspection_point)==null?void 0:He.id].note,images:t.form.images[(ze=n.inspection_point)==null?void 0:ze.id],required:(Ge=n.settings)==null?void 0:Ge.is_required,"point-id":(We=n.inspection_point)==null?void 0:We.id,point:n.inspection_point,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(Ze=n.inspection_point)==null?void 0:Ze.name,subtitle:(Je=n.inspection_point)==null?void 0:Je.description,"selected-point":n.inspection_point??null,options:((Ye=n.settings)==null?void 0:Ye.radios)||O,error:t.form.errors[`results.${(Xe=n.inspection_point)==null?void 0:Xe.id}.status`],"onUpdate:notes":R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},"onUpdate:images":R=>{var y;return t.form.images[(y=n.inspection_point)==null?void 0:y.id]=R},onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)},onHapus:R=>{var y;return ie((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):r("",!0),n.input_type==="imageTOradio"&&L(n)?(s(),Se(Co,{key:6,modelValue:t.form.results[(Qe=n.inspection_point)==null?void 0:Qe.id].status,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"status")}],notes:t.form.results[(et=n.inspection_point)==null?void 0:et.id].note,images:t.form.images[(tt=n.inspection_point)==null?void 0:tt.id],required:(at=n.settings)==null?void 0:at.is_required,"point-id":(nt=n.inspection_point)==null?void 0:nt.id,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(st=n.inspection_point)==null?void 0:st.name,subtitle:(ot=n.inspection_point)==null?void 0:ot.description,point:n,"selected-point":n.inspection_point??null,options:((it=n.settings)==null?void 0:it.radios)||O,error:t.form.errors[`results.${(lt=n.inspection_point)==null?void 0:lt.id}.status`],"onUpdate:notes":R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},"onUpdate:images":R=>{var y;return t.form.images[(y=n.inspection_point)==null?void 0:y.id]=R},onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)},onHapus:R=>{var y;return ie((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):r("",!0),n.input_type==="image"&&L(n)?(s(),Se(qe,{key:7,modelValue:t.form.images[(rt=n.inspection_point)==null?void 0:rt.id],"onUpdate:modelValue":R=>{var y;return t.form.images[(y=n.inspection_point)==null?void 0:y.id]=R},error:t.form.errors[`images.${(ut=n.inspection_point)==null?void 0:ut.id}`],"inspection-id":t.inspectionId,"point-id":(dt=n.inspection_point)==null?void 0:dt.id,point:n.inspection_point,"point-name":(ct=n.inspection_point)==null?void 0:ct.name,settings:n.settings,"onUpdate:notes":R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},"onUpdate:status":R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):r("",!0),n.input_type==="select"&&L(n)?(s(),Se(Xa,{key:8,modelValue:t.form.results[(gt=n.inspection_point)==null?void 0:gt.id].status,"onUpdate:modelValue":[R=>{var y;return t.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R},R=>{var y;return B((y=n.inspection_point)==null?void 0:y.id,R,"status")}],required:(pt=n.settings)==null?void 0:pt.is_required,error:t.form.errors[`results.${(mt=n.inspection_point)==null?void 0:mt.id}.status`],onSave:R=>{var y;return W((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):r("",!0),!L(n)&&G(n)?(s(),o("div",Jo,[p[2]||(p[2]=e("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),p[3]||(p[3]=e("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),e("ul",Yo,[(vt=n.settings)!=null&&vt.transmission?(s(),o("li",Xo," Transmisi: "+U(q(n.settings.transmission).join(", ")),1)):r("",!0),(ft=n.settings)!=null&&ft.fuel_type?(s(),o("li",Qo," Bahan bakar: "+U(n.settings.fuel_type),1)):r("",!0),(ht=n.settings)!=null&&ht.rear_door?(s(),o("li",ei,"Kendaraan dengan pintu belakang")):r("",!0),(bt=n.settings)!=null&&bt.pick_up?(s(),o("li",ti,"Tipe pick up")):r("",!0),(yt=n.settings)!=null&&yt.box?(s(),o("li",ai,"Kendaraan dengan box")):r("",!0)])])):r("",!0)]))],2)}),128)),V.value.filter(n=>!n.is_link).length===0?(s(),o("div",ni,[p[4]||(p[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),p[5]||(p[5]=e("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),t.category.isDamageMenu?(s(),o("p",si,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):r("",!0)])):r("",!0)])],2)],64))}},Pi=Ne(oi,[["__scopeId","data-v-3faa49ae"]]),ii={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},li={class:"p-4 space-y-4-6"},ri={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},ui=["value"],di={class:"p-4 space-y-4-6"},ci={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},gi=["value"],pi={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},mi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},vi=["value"],fi={class:"p-4 space-y-2"},hi={class:"flex items-center justify-between mb-2"},bi={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},yi={class:"flex items-center justify-between mb-3"},xi={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},ki=["onClick"],wi={class:"text-sm font-medium text-gray-800 mb-1"},Ii={class:"text-xs text-gray-600 line-clamp-2"},$i={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},Si={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},Ai={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},_i={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ci={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ti={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(t,{emit:Z}){const a=t,k=Z,u=$(null),m=$(!1),v=$(!1),d=kt({bold:!1,italic:!1,underline:!1}),i=kt({flooded:"",collision:"",collision_severity:"",notes:""}),x=$([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`}]);$(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const A=n=>{if(!n)return{};if(typeof n=="string")try{return JSON.parse(n)||{}}catch(g){return console.error("Error parsing settings JSON:",g),{}}return typeof n=="object"&&n!==null?n:{}};ee(()=>A(a.inspection.settings).conclusion||{});const I=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],P=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],q=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];De(()=>{G(),Fe(()=>{L(),w()})});const L=()=>{u.value&&i.notes&&(u.value.innerHTML=i.notes)},G=()=>{const g=A(a.inspection.settings).conclusion||{},N=a.form.conclusion||{};i.flooded=N.flooded||g.flooded||"",i.collision=N.collision||g.collision||"",i.collision_severity=N.collision_severity||g.collision_severity||"",i.notes=N.notes||a.inspection.notes||""},z=n=>{if(!u.value)return;let g=n.content;g=g.replace(/{PLATE_NUMBER}/g,a.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,a.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,i.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,i.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),u.value.innerHTML=g,i.notes=g,v.value=!1,Fe(()=>{u.value.focus(),p()})},V=()=>{u.value&&(u.value.innerHTML="",i.notes="",p())},w=()=>{if(!u.value)return;const n=window.getSelection();n.rangeCount===0||n.isCollapsed||(d.bold=document.queryCommandState("bold"),d.italic=document.queryCommandState("italic"),d.underline=document.queryCommandState("underline"))},F=n=>{if(!u.value)return;u.value.focus();const g=d[n];switch(n){case"bold":document.execCommand("bold",!1,!g);break;case"italic":document.execCommand("italic",!1,!g);break;case"underline":document.execCommand("underline",!1,!g);break}setTimeout(()=>{w(),O()},10)},O=It.debounce(()=>{u.value&&(i.notes=u.value.innerHTML,p())},200),D=n=>{n.preventDefault(),document.execCommand("insertParagraph",!1,null)},B=n=>{n.preventDefault();const g=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,g)},W=()=>{m.value=!0},ie=()=>{m.value=!1,u.value&&(i.notes=u.value.innerHTML,p())},_=()=>{p()},p=()=>{const n={flooded:i.flooded,collision:i.collision,collision_severity:i.collision==="yes"?i.collision_severity:null,notes:i.notes};k("updateConclusion",n)};return me(()=>a.form.conclusion,n=>{n&&(i.flooded=n.flooded!==void 0?n.flooded:i.flooded,i.collision=n.collision!==void 0?n.collision:i.collision,i.collision_severity=n.collision_severity!==void 0?n.collision_severity:i.collision_severity,i.notes=n.notes!==void 0?n.notes:i.notes,u.value&&n.notes!==void 0&&u.value.innerHTML!==n.notes&&(u.value.innerHTML=n.notes))},{deep:!0,immediate:!0}),me([()=>i.flooded,()=>i.collision,()=>i.collision_severity,()=>i.notes],()=>{p()},{deep:!0}),(n,g)=>(s(),o("div",ii,[g[21]||(g[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),e("div",li,[g[10]||(g[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ye(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ri,[(s(),o(Ie,null,$e(I,N=>e("label",{key:N.value,class:"cursor-pointer"},[Ce(e("input",{type:"radio","onUpdate:modelValue":g[0]||(g[0]=J=>i.flooded=J),value:N.value,class:"hidden peer",onChange:_},null,40,ui),[[je,i.flooded]]),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.flooded===N.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.flooded!==N.value}])},U(N.label),3)])),64))])]),e("div",di,[g[12]||(g[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ye(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ci,[(s(),o(Ie,null,$e(P,N=>e("label",{key:N.value,class:"cursor-pointer"},[Ce(e("input",{type:"radio","onUpdate:modelValue":g[1]||(g[1]=J=>i.collision=J),value:N.value,class:"hidden peer",onChange:_},null,40,gi),[[je,i.collision]]),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.collision===N.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.collision!==N.value}])},U(N.label),3)])),64))]),we(Re,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Te(()=>[i.collision==="yes"?(s(),o("div",pi,[g[11]||(g[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[ye("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",mi,[(s(),o(Ie,null,$e(q,N=>e("label",{key:N.value,class:"cursor-pointer"},[Ce(e("input",{type:"radio","onUpdate:modelValue":g[2]||(g[2]=J=>i.collision_severity=J),value:N.value,class:"hidden peer",onChange:_},null,40,vi),[[je,i.collision_severity]]),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":i.collision_severity===N.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":i.collision_severity!==N.value}])},U(N.label),3)])),64))])])):r("",!0)]),_:1})]),e("div",fi,[e("div",hi,[g[14]||(g[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),e("button",{type:"button",onClick:g[3]||(g[3]=N=>v.value=!v.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},g[13]||(g[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),ye(" Template ")]))]),we(Re,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Te(()=>[v.value?(s(),o("div",bi,[e("div",yi,[g[16]||(g[16]=e("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),e("button",{onClick:g[4]||(g[4]=N=>v.value=!1),class:"text-gray-400 hover:text-gray-600"},g[15]||(g[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",xi,[(s(!0),o(Ie,null,$e(x.value,N=>(s(),o("button",{key:N.id,onClick:J=>z(N),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[e("div",wi,U(N.name),1),e("div",Ii,U(N.description),1)],8,ki))),128))])])):r("",!0)]),_:1}),e("div",$i,[e("button",{type:"button",onClick:g[5]||(g[5]=N=>F("bold")),class:Q(["p-2 rounded transition-all duration-150 ease-in-out font-medium",d.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},g[17]||(g[17]=[e("strong",null,"B",-1)]),2),e("button",{type:"button",onClick:g[6]||(g[6]=N=>F("italic")),class:Q(["p-2 rounded transition-all duration-150 ease-in-out font-medium",d.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},g[18]||(g[18]=[e("em",null,"I",-1)]),2),e("button",{type:"button",onClick:g[7]||(g[7]=N=>F("underline")),class:Q(["p-2 rounded transition-all duration-150 ease-in-out font-medium",d.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},g[19]||(g[19]=[e("u",null,"U",-1)]),2),e("button",{type:"button",onClick:g[8]||(g[8]=N=>V()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," 🗑️ Clear ")]),we(Re,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Te(()=>[Object.values(d).some(N=>N)?(s(),o("div",Si,[g[20]||(g[20]=ye(" Format aktif: ")),d.bold?(s(),o("span",Ai,"Bold")):r("",!0),d.italic?(s(),o("span",_i,"Italic")):r("",!0),d.underline?(s(),o("span",Ci,"Underline")):r("",!0)])):r("",!0)]),_:1}),e("div",{ref_key:"editorRef",ref:u,contenteditable:"true",class:Q(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!m.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":m.value}]),onInput:g[9]||(g[9]=(...N)=>Ee(O)&&Ee(O)(...N)),onBlur:ie,onFocus:W,onKeydown:Mt(D,["enter"]),onPaste:B,onMouseup:w,onKeyup:w,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},Ri=Ne(Ti,[["__scopeId","data-v-e09db1bd"]]);export{Bs as B,Pi as C,Di as V,Tt as _,Ri as a};
