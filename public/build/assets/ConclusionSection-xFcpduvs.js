import{x as Nt,r as y,g as We,q as ne,E as Ye,G as ye,c as o,o as s,d as e,b as l,k as Te,z as Fe,A as Ge,n as J,t as _,u as ze,e as Et,F as Ne,m as Ee,f as Se,y as Ze,w as He,N as qe,D as et,I as Vt,L as wt,a as Xe,j as Me,l as xt,T as Je,M as Ut,p as Mt,O as kt,J as Qe,B as Dt}from"./vendor-g77w9U1W.js";import{l as It}from"./lodash-CGXsUT3p.js";import{_ as Pt}from"./PrimaryButton-CrKKsBb9.js";import{_ as Rt}from"./ActionMessage-C9w22vKV.js";import{_ as Ke}from"./app-Wakejqzl.js";const Lt={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Bt={key:0,class:"p-4 space-y-2"},jt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ft={class:"flex items-center space-x-2"},Ot={key:0,class:"text-xs text-red-500 font-normal ml-2"},qt={key:1,class:"text-xs text-red-500 font-normal ml-2"},Ht={key:2,class:"text-xs text-green-500 font-normal ml-2"},Kt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},zt={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Gt={class:"col-span-2 flex space-x-3"},Wt={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Zt={class:"flex items-start"},Jt={class:"text-sm text-blue-700"},Yt={class:"mt-1"},Xt={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Qt={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},ea={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},ta={key:3,class:"text-blue-600"},aa={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},na={class:"relative"},sa={key:0,class:"absolute right-3 top-3"},oa={key:1,class:"text-xs text-red-500 font-normal ml-2"},ia={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},la={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},ra={key:0},ua=["onMousedown"],da={class:"font-medium text-gray-900"},ca={class:"text-sm text-gray-500"},pa={key:1,class:"p-4 text-sm text-gray-500 text-center"},ga={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ma={key:0,class:"mb-4"},va=["innerHTML"],fa={key:1},ha={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ba=["onClick"],ya=["src","alt"],xa={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},ka={class:"text-white text-xs text-center"},wa={key:2,class:"text-center py-4 text-gray-500 text-sm"},Ia={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},$a=["src","alt"],Sa={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Ca={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},Aa={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},_a={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(t,{emit:Y}){var re,we,Ve,Pe,je,Oe;const a=t,w=Y,r=Nt({plate_number:((re=a.inspection)==null?void 0:re.plate_number)||"",car_id:((we=a.inspection)==null?void 0:we.car_id)||null,car_name:((Ve=a.inspection)==null?void 0:Ve.car_name)||""}),m=y(((Pe=a.inspection)==null?void 0:Pe.plate_number)||""),v=y(((je=a.inspection)==null?void 0:je.car_id)||null),u=y(((Oe=a.inspection)==null?void 0:Oe.car_name)||""),i=y(""),x=y(""),C=y(""),I=y(null),M=y({rear_door:!1}),O=y(!1),j=y(""),G=y(""),K=y(r.car_name),U=y(!1),$=y(!1),R=y([]),L=y(null),V=y([]),B=y(!1),Z=y(0);We(()=>{var S,b,oe,F,ue;if(A((S=a.inspection)==null?void 0:S.plate_number),(b=a.inspection)!=null&&b.car_id&&((oe=a.CarDetail)==null?void 0:oe.length)>0){const me=a.CarDetail.find(be=>be.id===a.inspection.car_id);me&&d(me)}else!((F=a.inspection)!=null&&F.car_id)&&((ue=a.inspection)!=null&&ue.car_name)&&(K.value=a.inspection.car_name,r.car_id=null);window.addEventListener("keydown",Q),pe(),w("update:hasUnsavedChanges",te.value),w("update:validation",se.value)}),Ye(()=>{window.removeEventListener("keydown",Q)});const pe=()=>{try{const S=localStorage.getItem("vehicle_features");if(S){const b=JSON.parse(S);M.value.rear_door=b.rear_door||!1,b.pick_up?I.value="pick_up":b.box?I.value="box":I.value=null}else M.value.rear_door=!1,I.value=null;p()}catch(S){console.error("Error loading vehicle type from localStorage:",S),M.value.rear_door=!1,I.value=null,p()}},N=()=>{M.value.rear_door=!M.value.rear_door,n()},g=S=>{I.value===S?I.value=null:I.value=S,n()},n=()=>{try{const S={rear_door:M.value.rear_door,pick_up:I.value==="pick_up",box:I.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(S)),p(),console.log("Vehicle features saved to localStorage:",S)}catch(S){console.error("Error saving vehicle type to localStorage:",S)}},p=()=>{const S={rear_door:M.value.rear_door,pick_up:I.value==="pick_up",box:I.value==="box"};w("update:vehicle-type",S)},A=S=>{if(!S){i.value="",x.value="",C.value="";return}const b=S.toUpperCase().trim(),oe=b.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(oe)i.value=oe[1]||"",x.value=oe[2]||"",C.value=oe[3]||"";else{let F="area",ue="",me="",be="";for(const c of b)F==="area"&&/[A-Z]/.test(c)?ue+=c:F==="area"&&/[0-9]/.test(c)?(F="number",me+=c):F==="number"&&/[0-9]/.test(c)?me+=c:F==="number"&&/[A-Z]/.test(c)?(F="suffix",be+=c):F==="suffix"&&/[A-Z]/.test(c)&&(be+=c);i.value=ue,x.value=me,C.value=be}z()},z=()=>{const S=`${i.value}${x.value}${C.value}`;r.plate_number=S,W()},ge=S=>{S==="area"?i.value=i.value.toUpperCase().replace(/[^A-Z]/g,""):S==="number"?x.value=x.value.replace(/[^0-9]/g,""):S==="suffix"&&(C.value=C.value.toUpperCase().replace(/[^A-Z]/g,"")),z()},ce=ne(()=>{const S=r.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(S)}),ie=ne(()=>!K.value||K.value.trim()===""),fe=ne(()=>r.plate_number.length>0&&!ce.value?"Format plat nomor tidak valid.":null),se=ne(()=>{const S=!r.plate_number||r.plate_number.trim()==="",b=!K.value||K.value.trim()==="";return S||b||!ce.value||O.value}),te=ne(()=>{const S=r.plate_number!==m.value,b=r.car_id!==v.value||K.value!==u.value;return S||b}),he=ne(()=>te.value&&!se.value),ve=S=>{var oe,F,ue;if(!S)return"";const b=[];return(oe=S.brand)!=null&&oe.name&&b.push(S.brand.name),(F=S.model)!=null&&F.name&&b.push(S.model.name),(ue=S.type)!=null&&ue.name&&b.push(S.type.name),S.cc&&b.push((S.cc/1e3).toFixed(1)),S.transmission&&b.push(S.transmission),S.year&&b.push(S.year.toString()),S.fuel_type&&b.push(S.fuel_type),S.production_period&&b.push(`(${S.production_period})`),b.join(" ")},q=()=>{r.car_id&&(r.car_id=null,L.value=null,V.value=[]),Be()},Be=It.debounce(()=>{if(!K.value.trim()){R.value=[],U.value=!1;return}$.value=!0;try{const S=K.value.toLowerCase().trim();R.value=a.CarDetail.filter(b=>ve(b).toLowerCase().includes(S)),U.value=!0}finally{$.value=!1}},300),De=()=>{setTimeout(()=>{U.value=!1,r.car_name=K.value,W()},200)},d=async S=>{L.value=S,K.value=ve(S),r.car_id=S.id,r.car_name=ve(S),U.value=!1,await f(S.id),W(),w("update:hasUnsavedChanges",te.value),w("update:validation",se.value)},T=S=>!S||!S.file_path?"":`/storage/${S.file_path}`,f=async S=>{try{const b=await fetch(`/api/cars/${S}/images`);if(b.ok){const oe=await b.json();V.value=Array.isArray(oe)?oe:[]}else V.value=[]}catch(b){console.error("Error loading car images:",b),V.value=[]}},E=S=>{Z.value=S,B.value=!0,document.body.style.overflow="hidden"},D=()=>{B.value=!1,document.body.style.overflow=""},ae=()=>{Z.value=(Z.value+1)%V.value.length},X=()=>{Z.value=(Z.value-1+V.value.length)%V.value.length},Q=S=>{if(B.value)switch(S.key){case"Escape":D();break;case"ArrowRight":ae();break;case"ArrowLeft":X();break}},W=()=>{const S={plate_number:r.plate_number,car_id:r.car_id,car_name:r.car_name};w("update-vehicle",S)},le=()=>{a.inspection&&r.post(route("inspections.updateVehicleDetails",{inspection:a.inspection.id}),{preserveScroll:!0,onSuccess:()=>{m.value=r.plate_number,v.value=r.car_id,u.value=r.car_name,w("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:S=>{console.error("Gagal menyimpan data:",S)}})};return ye([()=>r.plate_number,()=>r.car_name],S=>{j.value="",O.value=!1,G.value="";const b=S[0];if(b&&b.length>=6){const oe=a.allInspections.filter(F=>{var ue;return F.plate_number===b&&F.id!==((ue=a.inspection)==null?void 0:ue.id)});if(oe.length>0){const F=["draft","in_progress","pending","pending_review","revision"],ue=oe.find(me=>F.includes(me.status));if(ue)O.value=!0,j.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${ue.status.replace(/_/g," ").toUpperCase()}.`;else{const me=oe.filter(be=>["approved","rejected","completed","cancelled"].includes(be.status));if(me.length>0){me.sort((c,k)=>new Date(k.created_at)-new Date(c.created_at));const be=me[0];if(be.car_id){const c=a.CarDetail.find(k=>k.id===be.car_id);c&&d(c)}else be.car_name&&(K.value=be.car_name,r.car_name=be.car_name,r.car_id=null);G.value=`Nomor plat ini sudah pernah diperiksa ${me.length} kali sebelumnya.`}}}}w("update:hasUnsavedChanges",te.value),w("update:validation",se.value)},{deep:!0}),ye([()=>M.value.rear_door,()=>I.value],()=>{n()}),(S,b)=>{var oe;return s(),o("div",Lt,[b[27]||(b[27]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),t.inspection?(s(),o("div",Bt,[e("div",jt,[b[11]||(b[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",Ft,[Fe(e("input",{"onUpdate:modelValue":b[0]||(b[0]=F=>i.value=F),type:"text",placeholder:"Contoh: B",class:J(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!ce.value||O.value}]),onInput:b[1]||(b[1]=F=>ge("area")),maxlength:"2"},null,34),[[Ge,i.value]]),Fe(e("input",{"onUpdate:modelValue":b[2]||(b[2]=F=>x.value=F),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:J(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!ce.value||O.value}]),onInput:b[3]||(b[3]=F=>ge("number")),maxlength:"4"},null,34),[[Ge,x.value]]),Fe(e("input",{"onUpdate:modelValue":b[4]||(b[4]=F=>C.value=F),type:"text",placeholder:"ABC",class:J(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!ce.value||O.value}]),onInput:b[5]||(b[5]=F=>ge("suffix")),maxlength:"3"},null,34),[[Ge,C.value]])]),fe.value?(s(),o("span",Ot,_(fe.value),1)):l("",!0),j.value?(s(),o("span",qt,_(j.value),1)):l("",!0),G.value?(s(),o("span",Ht,_(G.value),1)):l("",!0)]),e("div",Kt,[b[15]||(b[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),e("div",zt,[e("div",{class:J(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":M.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!M.value.rear_door}]),onClick:N},b[12]||(b[12]=[e("span",null,"Pintu Belakang",-1)]),2),e("div",Gt,[e("div",{class:J(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":I.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.value!=="pick_up"}]),onClick:b[6]||(b[6]=F=>g("pick_up"))}," Pick Up ",2),e("div",{class:J(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":I.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.value!=="box"}]),onClick:b[7]||(b[7]=F=>g("box"))}," Box ",2)])]),e("div",Wt,[e("div",Zt,[b[14]||(b[14]=e("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",Jt,[b[13]||(b[13]=e("p",{class:"font-medium"},"Status Kendaraan:",-1)),e("p",Yt,[M.value.rear_door?(s(),o("span",Xt," ✓ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):l("",!0),I.value==="pick_up"?(s(),o("span",Qt," ✓ Pick Up ")):l("",!0),I.value==="box"?(s(),o("span",ea," ✓ Box ")):l("",!0),!M.value.rear_door&&!I.value?(s(),o("span",ta," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):l("",!0)])])])])]),e("div",aa,[b[19]||(b[19]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",na,[Fe(e("input",{"onUpdate:modelValue":b[8]||(b[8]=F=>K.value=F),type:"text",placeholder:"Cari atau ketik nama mobil...",class:J(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ie.value}]),onInput:q,onFocus:b[9]||(b[9]=F=>U.value=!0),onBlur:De},null,34),[[Ge,K.value]]),$.value?(s(),o("div",sa,b[16]||(b[16]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):l("",!0),ie.value?(s(),o("span",oa,"Nama mobil tidak boleh kosong.")):l("",!0),!ze(r).car_id&&K.value?(s(),o("div",ia,b[17]||(b[17]=[Et('<div class="flex items-start" data-v-93565d5f><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-93565d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-93565d5f></path></svg><div data-v-93565d5f><p class="text-yellow-800 font-medium mb-1" data-v-93565d5f>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-93565d5f>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-93565d5f> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-93565d5f>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-93565d5f>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):l("",!0),U.value?(s(),o("div",la,[R.value.length>0?(s(),o("div",ra,[(s(!0),o(Ne,null,Ee(R.value,F=>(s(),o("div",{key:F.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:ue=>d(F)},[e("div",da,_(ve(F)),1),e("div",ca,_(F.year)+" • "+_(F.cc)+"cc • "+_(F.transmission)+" • "+_(F.fuel_type),1)],40,ua))),128))])):(s(),o("div",pa,b[18]||(b[18]=[Se(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),Se(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):l("",!0)])]),ze(r).car_id&&L.value?(s(),o("div",ga,[L.value.description?(s(),o("div",ma,[b[20]||(b[20]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:L.value.description},null,8,va)])):l("",!0),V.value.length>0?(s(),o("div",fa,[b[21]||(b[21]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",ha,[(s(!0),o(Ne,null,Ee(V.value,(F,ue)=>(s(),o("div",{key:F.id||ue,class:"relative group cursor-pointer",onClick:me=>E(ue)},[e("img",{src:T(F),alt:F.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ya),F.note?(s(),o("div",xa,[e("p",ka,_(F.note),1)])):l("",!0)],8,ba))),128))])])):(s(),o("div",wa," Tidak ada gambar tersedia untuk mobil ini "))])):l("",!0),B.value?(s(),o("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:D},[e("div",Ia,[e("button",{onClick:D,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},b[22]||(b[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),V.value.length>1?(s(),o("button",{key:0,onClick:Ze(X,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},b[23]||(b[23]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):l("",!0),V.value.length>1?(s(),o("button",{key:1,onClick:Ze(ae,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},b[24]||(b[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):l("",!0),e("img",{src:T(V.value[Z.value]),alt:"Car Image "+(Z.value+1),class:"max-w-full max-h-full object-contain",onClick:b[10]||(b[10]=Ze(()=>{},["stop"]))},null,8,$a),V.value.length>1?(s(),o("div",Sa,_(Z.value+1)+" / "+_(V.value.length),1)):l("",!0),(oe=V.value[Z.value])!=null&&oe.note?(s(),o("div",Ca,_(V.value[Z.value].note),1)):l("",!0)])])):l("",!0),Te(Pt,{type:"button",onClick:le,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!he.value},{default:He(()=>[ze(r).processing?(s(),o("svg",Aa,b[25]||(b[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):l("",!0),e("span",null,_(ze(r).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),Te(Rt,{on:ze(r).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:He(()=>b[26]||(b[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),Se(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):l("",!0)])}}},Hi=Ke(_a,[["__scopeId","data-v-93565d5f"]]),Ta={class:"mt-1"},Na=["value","required","minlength","maxlength","allowSpace","placeholder"],Ea={key:0,class:"mt-2 text-sm text-red-600"},$t={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(t,{emit:Y}){const a=t,w=Y,r=ne(()=>{if(!a.modelValue)return"";let v=a.modelValue;switch(a.allowSpace||(v=v.replace(/\s+/g,"")),a.textTransform){case"uppercase":return v.toUpperCase();case"lowercase":return v.toLowerCase();case"capitalize":return v.replace(/\b\w/g,u=>u.toUpperCase());default:return v}}),m=v=>{let u=v.target.value;switch(a.allowSpace||(u=u.replace(/\s+/g,"")),a.textTransform){case"uppercase":u=u.toUpperCase();break;case"lowercase":u=u.toLowerCase();break;case"capitalize":u=u.replace(/\b\w/g,i=>i.toUpperCase());break}w("update:modelValue",u),w("save",a.pointId)};return(v,u)=>(s(),o("div",Ta,[e("input",{value:r.value,onInput:m,type:"text",required:t.required,minlength:t.minLength,maxlength:t.maxLength,allowSpace:t.allowSpace,placeholder:t.placeholder,class:J(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:t.textTransform==="uppercase",lowercase:t.textTransform==="lowercase",capitalize:t.textTransform==="capitalize"}])},null,42,Na),t.error?(s(),o("p",Ea,_(t.error),1)):l("",!0)]))}},Va={class:"mt-1"},Ua=["value","required","min","max","step","placeholder"],Ma={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputNumber",props:{modelValue:[String,Number],required:Boolean,min:[String,Number],max:[String,Number],step:[String,Number],placeholder:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Y}){const a=t,w=Y,r=m=>{const v=m.target.value;w("update:modelValue",v),w("save",a.pointId)};return(m,v)=>(s(),o("div",Va,[e("input",{value:t.modelValue,onInput:r,type:"number",required:t.required,min:t.min,max:t.max,step:t.step,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Ua),t.error?(s(),o("p",Ma,_(t.error),1)):l("",!0)]))}},Da={class:"mt-1"},Pa=["value","required","min","max"],Ra={key:0,class:"mt-2 text-sm text-red-600"},Ct={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Y}){const a=t,w=Y,r=m=>{w("update:modelValue",m.target.value),w("save",a.pointId)};return(m,v)=>(s(),o("div",Da,[e("input",{value:t.modelValue,onChange:r,type:"date",required:t.required,min:t.minDate,max:t.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Pa),t.error?(s(),o("p",Ra,_(t.error),1)):l("",!0)]))}},La={class:"mt-1"},Ba=["value","required","placeholder"],ja={key:0,class:"mt-2 text-sm text-red-600"},At={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(t,{emit:Y}){const a=t,w=Y,r=y(""),m=ne(()=>{var C,I,M,O;return{currency_symbol:((C=a.settings)==null?void 0:C.currency_symbol)||"Rp",thousands_separator:((I=a.settings)==null?void 0:I.thousands_separator)||",",min_value:((M=a.settings)==null?void 0:M.min_value)!==void 0?Number(a.settings.min_value):0,max_value:((O=a.settings)==null?void 0:O.max_value)!==void 0?Number(a.settings.max_value):1e9}}),v=C=>{if(C==null||C==="")return"";const I=Number(C);if(isNaN(I))return"";let M=I.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return m.value.thousands_separator!==","&&(M=M.replace(/,/g,m.value.thousands_separator)),M},u=C=>C?C.replace(/[^\d]/g,""):"",i=ne(()=>r.value?`${m.value.currency_symbol} ${v(r.value)}`:""),x=C=>{let I=u(C.target.value),M=Number(I);m.value.min_value!==void 0&&M<m.value.min_value&&(I=m.value.min_value.toString()),m.value.max_value!==void 0&&M>m.value.max_value&&(I=m.value.max_value.toString()),r.value=I,w("update:modelValue",I),w("save",a.pointId)};return ye(()=>a.modelValue,C=>{C!=null&&(r.value=C.toString())},{immediate:!0}),(C,I)=>(s(),o("div",La,[e("input",{value:i.value,onInput:x,type:"text",required:t.required,placeholder:t.placeholder,class:J(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",t.error?"border-red-300":"border-gray-300"])},null,42,Ba),t.error?(s(),o("p",ja,_(t.error),1)):l("",!0)]))}},Fa={class:"mt-1 space-y-3"},Oa={key:0,class:"space-y-2"},qa={class:"flex flex-wrap gap-2"},Ha=["onClick"],Ka=["value","required","minlength","maxlength","placeholder"],za={class:"flex justify-between items-center mt-1"},Ga={class:"text-xs text-gray-500"},Wa={key:0,class:"text-xs text-red-600"},_t={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(t,{emit:Y}){const a=t,w=Y,r=y([]),m=y(""),v=C=>r.value.some(I=>I.value===C),u=C=>{v(C.value)?r.value=r.value.filter(j=>j.value!==C.value):r.value.push(C);const M=[...r.value.map(j=>j.value)];m.value.trim()&&M.push(m.value.trim());const O=M.join(", ");w("update:modelValue",O),w("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:O})},i=C=>{const I=C.target.value;w("update:modelValue",I),w("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:I}),x(I)},x=C=>{var j,G,K,U;if(!C){r.value=[],m.value="";return}const I=C.split(",").map($=>$.trim()).filter($=>$),M=((G=(j=a.settings)==null?void 0:j.damage_options)==null?void 0:G.map($=>$.value))||[];r.value=((U=(K=a.settings)==null?void 0:K.damage_options)==null?void 0:U.filter($=>I.includes($.value)))||[];const O=I.filter($=>!M.includes($));m.value=O.join(", ")};return ye(()=>a.modelValue,C=>{C!=null&&x(C)},{immediate:!0}),(C,I)=>{var M,O,j;return s(),o("div",Fa,[(M=t.settings)!=null&&M.enable_damage&&((O=t.settings)!=null&&O.damage_options)?(s(),o("div",Oa,[I[0]||(I[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",qa,[(s(!0),o(Ne,null,Ee(t.settings.damage_options,(G,K)=>(s(),o("button",{key:K,type:"button",onClick:U=>u(G),class:J(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":v(G.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!v(G.value)}])},_(G.label),11,Ha))),128))])])):l("",!0),e("div",null,[e("textarea",{value:t.modelValue,onInput:i,required:t.required,minlength:t.minLength,maxlength:t.maxLength,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ka),e("div",za,[e("span",Ga,_(((j=t.modelValue)==null?void 0:j.length)||0)+"/"+_(t.maxLength||400),1),t.error?(s(),o("p",Wa,_(t.error),1)):l("",!0)])])])}}},Za={class:"mt-1"},Ja=["value","required"],Ya={key:0,class:"mt-2 text-sm text-red-600"},Xa={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Y}){const a=t,w=Y,r=m=>{w("update:modelValue",m.target.value),w("save",a.pointId)};return(m,v)=>(s(),o("div",Za,[e("select",{value:t.modelValue,onChange:r,required:t.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},v[0]||(v[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Ja),t.error?(s(),o("p",Ya,_(t.error),1)):l("",!0)]))}},Qa=Ke(Xa,[["__scopeId","data-v-1b6c0201"]]),en={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},tn={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},an={class:"text-xs text-gray-500 mt-2 text-center"},nn={class:"flex flex-row space-x-4 mb-6"},sn={class:"mt-4 text-right"},on={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(t){return(Y,a)=>t.show?(s(),o("div",en,[e("div",tn,[a[7]||(a[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",an,[a[3]||(a[3]=Se("Ambil Foto Maksimal: ")),e("b",null,_(t.settings.max_files),1),a[4]||(a[4]=Se(" Dengan Rasio & Ukuran: ")),e("b",null,_(t.settings.camera_aspect_ratio),1)]),e("div",nn,[e("button",{onClick:a[0]||(a[0]=w=>Y.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[5]||(a[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Kamera",-1)])),e("button",{onClick:a[1]||(a[1]=w=>Y.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[6]||(a[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",sn,[e("button",{onClick:a[2]||(a[2]=w=>Y.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):l("",!0)}},ln={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},rn={class:"w-full h-full flex flex-col"},un={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},dn=["disabled"],cn={class:"text-lg font-semibold"},pn={class:"flex items-center gap-2"},gn=["disabled"],mn=["disabled"],vn={key:0,class:"bg-blue-900 bg-opacity-50 text-white p-3"},fn={class:"flex items-center justify-between mb-2"},hn={class:"text-xs"},bn={class:"w-full bg-blue-700 bg-opacity-50 rounded-full h-2"},yn={class:"text-xs mt-1 text-blue-300"},xn={class:"flex-1 flex items-center justify-center overflow-hidden relative"},kn=["src"],wn={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},In={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},$n=["disabled"],Sn=["disabled"],Cn=["disabled"],An={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},_n={class:"flex justify-between items-center w-full"},Tn=["disabled"],Nn={key:1,class:"flex-1"},En=["disabled"],Vn={class:"flex gap-3 w-full"},Un={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},Mn={class:"flex items-center gap-2"},Dn={key:0,class:"text-center"},Pn={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(t,{emit:Y}){const a=t,w=Y,r=y(0),m=y([]),v=ne(()=>m.value.length>0?m.value[r.value]:null);ye(()=>a.images,U=>{m.value=U.map($=>({...$,rotation:$.rotation||0})),U.length===0&&a.show&&M()},{deep:!0,immediate:!0}),ye(()=>a.show,U=>{U&&a.images.length>0&&(r.value=a.initialIndex)}),ye(()=>a.uploadProgress,U=>{U===100&&console.log("Upload completed")});const u=U=>U.preview||(U.image_path?`/${U.image_path}`:""),i=()=>{if(v.value&&!a.isUploading){const U=(v.value.rotation+90)%360;m.value[r.value].rotation=U,w("update:images",m.value)}},x=()=>{a.isUploading||(r.value=r.value<m.value.length-1?r.value+1:0)},C=()=>{a.isUploading||(r.value=r.value>0?r.value-1:m.value.length-1)},I=()=>{a.isUploading||w("saveImages",m.value)},M=()=>{a.isUploading||w("close")},O=()=>{if(v.value&&!a.isUploading){const U=v.value,$=m.value.findIndex(R=>R.isNew&&U.isNew&&R.preview===U.preview||!R.isNew&&!U.isNew&&R.id===U.id);$!==-1&&(w("removePreviewImage",U),m.value.splice($,1),w("update:images",m.value)),r.value>=m.value.length&&(r.value=Math.max(0,m.value.length-1)),m.value.length===0&&w("close")}},j=()=>{a.isUploading||w("triggerAddMorePhotos")},G=()=>{v.value&&!a.isUploading&&w("retryImage",v.value)},K=U=>{U.key==="Escape"&&!a.isUploading&&M()};return We(()=>{document.addEventListener("keydown",K)}),Ye(()=>{document.removeEventListener("keydown",K)}),(U,$)=>{var R;return t.show?(s(),o("div",ln,[e("div",rn,[e("div",un,[e("button",{onClick:M,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},$[0]||($[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,dn),e("div",cn,_(((R=t.point)==null?void 0:R.name)||"Preview")+" ("+_(r.value+1)+"/"+_(m.value.length)+") ",1),e("div",pn,[v.value&&v.value.isNew?(s(),o("button",{key:0,onClick:O,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:t.isUploading},$[1]||($[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,gn)):l("",!0),v.value&&v.value.isNew?(s(),o("button",{key:1,onClick:i,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},$[2]||($[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]),8,mn)):l("",!0)])]),t.isUploading?(s(),o("div",vn,[e("div",fn,[$[3]||($[3]=e("span",{class:"text-sm font-medium"},"Mengupload gambar...",-1)),e("span",hn,_(t.uploadProgress)+"%",1)]),e("div",bn,[e("div",{class:"bg-blue-400 h-2 rounded-full transition-all duration-300",style:qe({width:t.uploadProgress+"%"})},null,4)]),e("p",yn,_(t.currentUpload)+"/"+_(t.totalUpload)+" gambar terupload",1)])):l("",!0),e("div",xn,[e("div",{class:"relative w-full max-w-full",style:qe({paddingTop:t.aspectRatio?100/t.aspectRatio+"%":"75%"})},[v.value?(s(),o("img",{key:0,src:u(v.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:qe({transform:`rotate(${v.value.rotation}deg)`})},null,12,kn)):l("",!0),v.value&&v.value.isUploading?(s(),o("div",wn,$[4]||($[4]=[e("div",{class:"text-center text-white"},[e("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e("p",{class:"text-sm"},"Mengupload...")],-1)]))):l("",!0),v.value&&v.value.isFailed?(s(),o("div",In,[$[5]||($[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),$[6]||($[6]=e("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),e("button",{onClick:G,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:t.isUploading}," Coba Lagi ",8,$n)])):l("",!0)],4),m.value.length>1&&!t.isUploading?(s(),o("button",{key:0,onClick:C,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},$[7]||($[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,Sn)):l("",!0),m.value.length>1&&!t.isUploading?(s(),o("button",{key:1,onClick:x,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},$[8]||($[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Cn)):l("",!0)]),e("div",An,[e("div",_n,[v.value&&!v.value.isNew?(s(),o("button",{key:0,onClick:O,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:t.isUploading},$[9]||($[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Se(" Hapus Foto ")]),8,Tn)):(s(),o("div",Nn)),t.allowMultiple&&m.value.length<t.maxFiles&&!t.isUploading?(s(),o("button",{key:2,onClick:j,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:t.isUploading},$[10]||($[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Se(" Tambah Foto ")]),8,En)):l("",!0)]),e("div",Vn,[t.isUploading?(s(),o("button",Un,[e("div",Mn,[$[11]||($[11]=e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),e("span",null,"Mengupload... "+_(t.uploadProgress)+"%",1)])])):(s(),o("button",{key:0,onClick:I,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),t.isUploading?(s(),o("div",Dn,$[12]||($[12]=[e("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):l("",!0)])])])):l("",!0)}}},Rn=Ke(Pn,[["__scopeId","data-v-581782f4"]]),Ln={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},Bn={class:"webcam-content-box"},jn={class:"webcam-header"},Fn={class:"camera-settings-info"},On={class:"settings-badge aspect-ratio"},qn={class:"inspection-point-name"},Hn={key:1,class:"backlight-warning"},Kn={class:"hd-badge"},zn={key:3,class:"zoom-controls"},Gn={class:"zoom-label"},Wn=["max"],Zn={key:4,class:"loading-overlay"},Jn={key:5,class:"error-overlay"},Yn={class:"error-content"},Xn={class:"error-message"},Qn={class:"webcam-footer"},es={class:"advanced-controls"},ts={key:0,class:"control-group"},as=["min","max"],ns={class:"control-value"},ss={key:1,class:"control-group"},os={key:2,class:"control-group"},is={class:"camera-controls"},ls=["disabled"],rs={class:"camera-icon-container"},us={key:0,class:"camera-spinner"},ds={key:1,class:"camera-body"},cs=["disabled"],ps={key:0,class:"manual-controls"},gs={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(t,{emit:Y}){const a=t,w=Y,r=y(null),m=y(null);let v=null,u=null;const i=y("environment"),x=y(null),C=y([]),I=y(!1),M=y(!1),O=y(!1),j=y(!1),G=y(!1),K=y(!1),U=y({}),$=y(!1),R=y(!1),L=y(null),V=y(1),B=y(1),Z=y(!1),pe=y("continuous"),N=y(0),g=y(0),n=y(10),p=y(!1),A=y("continuous"),z=y(0),ge=y(-3),ce=y(3),ie=y(!1),fe=y(!1),se=y(!1),te=y("off"),he=y(.8),ve=ne(()=>{var c;return((c=a.settings)==null?void 0:c.max_size)||2048}),q=ne(()=>a.aspectRatio?{aspectRatio:`${a.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),Be=ne(()=>{if(!a.aspectRatio)return{};const c=a.aspectRatio,k=c>1?80:60,ee=c>1?80/c:60*c;return{width:`${k}%`,height:`${ee}%`}}),De=ne(()=>({opacity:he.value})),d=ne(()=>A.value==="manual"?"M-Expo":"A-Expo"),T=ne(()=>({off:"No Flash",on:"Flash On",auto:"Auto Flash",fill:"Fill Flash"})[te.value]),f=ne(()=>({"badge-auto":A.value==="continuous","badge-manual":A.value==="manual"})),E=ne(()=>({"badge-flash-off":te.value==="off","badge-flash-on":te.value==="on","badge-flash-auto":te.value==="auto","badge-flash-fill":te.value==="fill"})),D=async()=>{v&&v.getTracks().forEach(c=>c.stop()),R.value=!0,L.value=null;try{await Ve();const c={deviceId:x.value?{exact:x.value}:void 0,facingMode:x.value?void 0:{ideal:i.value},width:{ideal:3840,min:1920},height:{ideal:2160,min:1080},aspectRatio:{ideal:a.aspectRatio||4/3},frameRate:{ideal:60,min:30},resizeMode:"crop-and-scale",advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{exposureCompensation:{ideal:0}},{whiteBalanceMode:"continuous"},{brightness:{ideal:0}},{contrast:{ideal:0}},{saturation:{ideal:0}},{sharpness:{ideal:0}},{exposureTime:{ideal:1/60}},{iso:{ideal:100}}]};v=await navigator.mediaDevices.getUserMedia({video:c,audio:!1}),u=v.getVideoTracks()[0],r.value.srcObject=v,await new Promise((k,ee)=>{r.value.onloadedmetadata=()=>k(),r.value.onerror=ee,setTimeout(k,1e3)}),await r.value.play(),await re(),ae(),console.log("Enhanced RTC Camera initialized successfully")}catch(c){console.error("RTC Error accessing camera: ",c),L.value=Pe(c),await je()}finally{R.value=!1}},ae=()=>{if(!r.value)return;const c=document.createElement("canvas"),k=c.getContext("2d");setInterval(()=>{if(!(!r.value||r.value.readyState!==r.value.HAVE_ENOUGH_DATA))try{const H=r.value;c.width=H.videoWidth,c.height=H.videoHeight,k.drawImage(H,0,0,c.width,c.height);const de=k.getImageData(0,0,c.width,c.height).data;let Ie=0,Ue=0,Ce=0;for(let Ae=0;Ae<de.length;Ae+=4){const _e=(de[Ae]+de[Ae+1]+de[Ae+2])/3;Ce+=_e,_e>200&&Ie++,_e<50&&Ue++}const Re=Ce/(de.length/4),Le=Ie/(de.length/4),ke=Ue/(de.length/4),$e=Re>180&&Le>.3&&ke>.4;K.value=$e,$e&&A.value==="continuous"&&Q(1)}catch(H){console.warn("Backlight detection error:",H)}},2e3)},X=async()=>{if(u)try{switch(te.value){case"off":O.value=!1,i.value!=="user"&&await u.applyConstraints({advanced:[{torch:!1}]});break;case"on":O.value=!0,i.value!=="user"&&await u.applyConstraints({advanced:[{torch:!0}]});break;case"auto":const c=K.value;O.value=c,i.value!=="user"&&c&&await u.applyConstraints({advanced:[{torch:!0}]});break;case"fill":O.value=!0,he.value=.4,i.value!=="user"&&await u.applyConstraints({advanced:[{torch:!0}]});break}}catch(c){console.error("Flash mode change failed:",c)}},Q=async c=>{if(!(!u||!ie.value)){z.value=Math.max(ge.value,Math.min(ce.value,c));try{await u.applyConstraints({advanced:[{exposureCompensation:z.value}]}),console.log(`Exposure compensation set to: ${z.value}`)}catch(k){console.error("Failed to set exposure compensation:",k)}}},W=async c=>{if(!(!u||!ie.value)){A.value=c;try{c==="continuous"?await u.applyConstraints({advanced:[{exposureMode:"continuous"}]}):await u.applyConstraints({advanced:[{exposureMode:"manual"}]})}catch(k){console.error("Failed to set exposure mode:",k),A.value="continuous"}}},le=async()=>{if(fe.value){se.value=!se.value;try{se.value?await u.applyConstraints({advanced:[{contrast:0},{brightness:0},{saturation:.1}]}):await u.applyConstraints({advanced:[{contrast:0},{brightness:0},{saturation:0}]})}catch(c){console.error("HDR toggle failed:",c)}}},re=async()=>{if(u)try{const c=u.getCapabilities(),k=u.getSettings();console.log("Enhanced Camera Capabilities:",c),c.zoom&&(Z.value=!0,B.value=c.zoom.max,V.value=k.zoom||1),M.value=!!c.torch,c.focusMode&&c.focusMode.includes("manual")&&(p.value=!0,c.focusDistance&&(g.value=c.focusDistance.min,n.value=c.focusDistance.max,N.value=k.focusDistance||g.value)),c.exposureCompensation&&(ie.value=!0,ge.value=c.exposureCompensation.min,ce.value=c.exposureCompensation.max,z.value=k.exposureCompensation||0),fe.value=c.whiteBalanceMode&&c.exposureMode&&c.focusMode}catch(c){console.error("Error checking camera capabilities:",c)}},we=async()=>{if(!($.value||!r.value||!m.value||R.value)){$.value=!0;try{(te.value==="on"||te.value==="fill")&&(j.value=!0,await new Promise(ke=>setTimeout(ke,50)));const c=r.value,k=m.value,ee=c.videoWidth,H=c.videoHeight;let xe,de,Ie,Ue;ee/H>a.aspectRatio?(de=H,xe=H*a.aspectRatio,Ie=(ee-xe)/2,Ue=0):(xe=ee,de=ee/a.aspectRatio,Ie=0,Ue=(H-de)/2),k.width=xe,k.height=de;const Ce=k.getContext("2d");if(Ce.imageSmoothingEnabled=!0,Ce.imageSmoothingQuality="high",Ce.drawImage(c,Ie,Ue,xe,de,0,0,xe,de),z.value!==0){const ke=Ce.getImageData(0,0,xe,de),$e=ke.data,Ae=1+z.value*.1;for(let _e=0;_e<$e.length;_e+=4)$e[_e]=Math.min(255,$e[_e]*Ae),$e[_e+1]=Math.min(255,$e[_e+1]*Ae),$e[_e+2]=Math.min(255,$e[_e+2]*Ae);Ce.putImageData(ke,0,0)}const Re=await new Promise(ke=>{k.toBlob(ke,"image/jpeg",.95)}),Le=await b(Re);if(Le){const ke=new File([Le],`capture_${Date.now()}.jpeg`,{type:"image/jpeg",lastModified:Date.now()});w("photoCaptured",ke)}setTimeout(()=>{j.value=!1},100)}catch(c){console.error("Error capturing photo:",c)}finally{$.value=!1}}},Ve=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(ee=>ee.stop());const k=await navigator.mediaDevices.enumerateDevices();if(C.value=k.filter(ee=>ee.kind==="videoinput"),I.value=C.value.length>1,!x.value&&C.value.length>0){const ee=C.value.find(H=>H.label.toLowerCase().includes("back")||H.label.toLowerCase().includes("rear")||H.label.toLowerCase().includes("environment"));x.value=ee?ee.deviceId:C.value[0].deviceId}}catch(c){console.error("Error getting camera devices:",c)}},Pe=c=>{switch(c.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan. Pastikan kamera terpasang dan tidak digunakan aplikasi lain.";case"NotSupportedError":return"Browser tidak mendukung akses kamera. Gunakan browser modern seperti Chrome, Firefox, atau Safari.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain. Tutup aplikasi lain yang menggunakan kamera.";case"OverconstrainedError":case"ConstraintNotSatisfiedError":return"Kamera tidak mendukung mode yang diminta. Menggunakan mode alternatif...";default:return`Error: ${c.message||"Tidak dapat mengakses kamera"}`}},je=async()=>{try{const c={video:{deviceId:x.value?{exact:x.value}:void 0,facingMode:x.value?void 0:{ideal:i.value},width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}},audio:!1};v=await navigator.mediaDevices.getUserMedia(c),u=v.getVideoTracks()[0],r.value.srcObject=v,await r.value.play(),await re(),L.value=null}catch(c){console.error("Fallback camera also failed: ",c),L.value=Pe(c)}},Oe=async()=>{const c=["off","on","auto","fill"],ee=(c.indexOf(te.value)+1)%c.length;te.value=c[ee],await X()},S=async()=>{if(!I.value||R.value)return;R.value=!0,v&&v.getTracks().forEach(H=>H.stop());const k=(C.value.findIndex(H=>H.deviceId===x.value)+1)%C.value.length;x.value=C.value[k].deviceId;const ee=C.value[k];ee.label.toLowerCase().includes("front")||ee.label.toLowerCase().includes("user")?i.value="user":i.value="environment",await D()},b=async c=>new Promise(k=>{const ee=ve.value*1024;if(c.size<=ee){k(c);return}const H=new Image,xe=new FileReader;xe.onload=de=>{H.onload=()=>{const Ie=document.createElement("canvas"),Ue=Ie.getContext("2d");let Ce=Math.sqrt(ee/c.size),Re=Math.floor(H.width*Ce),Le=Math.floor(H.height*Ce);Re<800&&(Re=800,Le=Math.floor(800/H.width*H.height),Ce=800/H.width),Ie.width=Re,Ie.height=Le,Ue.imageSmoothingEnabled=!0,Ue.imageSmoothingQuality="high",Ue.drawImage(H,0,0,Re,Le);let ke=.92;const $e=()=>{Ie.toBlob(Ae=>{Ae.size>ee&&ke>.4?(ke-=.08,$e()):k(Ae)},"image/jpeg",ke)};$e()},H.src=de.target.result},xe.readAsDataURL(c)}),oe=()=>{v&&v.getTracks().forEach(c=>c.stop()),w("close")},F=async()=>{L.value=null,await D()},ue=async c=>{if(!u||!p.value)return;const k=r.value.getBoundingClientRect(),ee=c.clientX-k.left,H=c.clientY-k.top;G.value=!0,U.value={left:`${ee}px`,top:`${H}px`,transform:"translate(-50%, -50%)"};try{if(u.getCapabilities().pointsOfInterest){const de=ee/k.width,Ie=H/k.height;await u.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:de,y:Ie}]}]})}}catch(xe){console.warn("Manual focus failed:",xe)}setTimeout(()=>{G.value=!1},2e3)},me=async c=>{if(!(!u||!p.value)){pe.value=c;try{c==="continuous"?await u.applyConstraints({advanced:[{focusMode:"continuous"}]}):await u.applyConstraints({advanced:[{focusMode:"manual"}]})}catch(k){console.error("Failed to set focus mode:",k),pe.value="continuous"}}},be=async c=>{if(!u||!Z.value)return;const k=Math.min(Math.max(c,1),B.value);V.value=k;try{await u.applyConstraints({advanced:[{zoom:k}]})}catch(ee){console.error("Failed to set zoom:",ee)}};return ye(()=>a.show,async c=>{c?(await et(),await D()):oe()}),Ye(()=>{v&&v.getTracks().forEach(c=>c.stop())}),(c,k)=>{var ee;return t.show?(s(),o("div",Ln,[e("div",Bn,[e("div",jn,[e("div",Fn,[e("span",{class:J(["settings-badge",f.value])},_(d.value),3),e("span",{class:J(["settings-badge",E.value])},_(T.value),3),e("span",On,_(t.settings.camera_aspect_ratio),1)]),e("div",qn,_(((ee=t.point)==null?void 0:ee.name)||"Camera"),1),e("button",{onClick:oe,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},k[9]||(k[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:qe(q.value),onClick:ue,onTouchstart:ue},[e("video",{ref_key:"webcamVideo",ref:r,autoplay:"",playsinline:"",class:J(["webcam-video",{"hdr-mode":se.value}])},null,2),e("canvas",{ref_key:"webcamCanvas",ref:m,class:"hidden"},null,512),j.value?(s(),o("div",{key:0,class:"screen-flash-overlay",style:qe(De.value)},null,4)):l("",!0),K.value?(s(),o("div",Hn,k[10]||(k[10]=[e("div",{class:"warning-icon"},"⚠️",-1),e("p",null,"Backlight terdeteksi! Gunakan fill flash",-1)]))):l("",!0),e("div",{class:"aspect-ratio-guide",style:qe(Be.value)},null,4),G.value?(s(),o("div",{key:2,class:"focus-indicator",style:qe(U.value)},k[11]||(k[11]=[e("div",{class:"focus-ring"},null,-1)]),4)):l("",!0),e("div",Kn,[e("span",{class:J(["hd-text",{"hdr-active":se.value}])},_(se.value?"HDR":"HD"),3)]),Z.value?(s(),o("div",zn,[e("span",Gn,_(V.value.toFixed(1))+"x",1),Fe(e("input",{type:"range",min:"1",max:B.value,step:"0.1","onUpdate:modelValue":k[0]||(k[0]=H=>V.value=H),onInput:k[1]||(k[1]=H=>be(parseFloat(H.target.value))),class:"zoom-slider"},null,40,Wn),[[Ge,V.value]])])):l("",!0),R.value?(s(),o("div",Zn,k[12]||(k[12]=[e("div",{class:"loading-spinner"},null,-1),e("p",{class:"loading-text"},"Mengoptimalkan kamera...",-1)]))):l("",!0),L.value?(s(),o("div",Jn,[e("div",Yn,[k[13]||(k[13]=e("div",{class:"error-icon"},"⚠️",-1)),k[14]||(k[14]=e("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),e("p",Xn,_(L.value),1),e("button",{onClick:F,class:"retry-button"}," Coba Lagi ")])])):l("",!0)],36),e("div",Qn,[e("div",es,[ie.value?(s(),o("div",ts,[k[15]||(k[15]=e("label",{class:"control-label"},"Exposure",-1)),Fe(e("input",{type:"range",min:ge.value,max:ce.value,step:"0.1","onUpdate:modelValue":k[2]||(k[2]=H=>z.value=H),onInput:k[3]||(k[3]=H=>Q(parseFloat(H.target.value))),class:"exposure-slider"},null,40,as),[[Ge,z.value]]),e("span",ns,_(z.value>0?"+":"")+_(z.value.toFixed(1)),1)])):l("",!0),M.value?(s(),o("div",ss,[k[17]||(k[17]=e("label",{class:"control-label"},"Flash",-1)),Fe(e("select",{"onUpdate:modelValue":k[4]||(k[4]=H=>te.value=H),onChange:X,class:"flash-selector"},k[16]||(k[16]=[e("option",{value:"off"},"Off",-1),e("option",{value:"on"},"On",-1),e("option",{value:"auto"},"Auto",-1),e("option",{value:"fill"},"Fill",-1)]),544),[[Vt,te.value]])])):l("",!0),fe.value?(s(),o("div",os,[k[18]||(k[18]=e("label",{class:"control-label"},"HDR",-1)),e("button",{onClick:le,class:J(["hdr-toggle",{active:se.value}])},_(se.value?"ON":"OFF"),3)])):l("",!0)]),e("div",is,[t.settings.enable_flash&&M.value?(s(),o("button",{key:0,onClick:Oe,class:J(["control-button",{active:O.value,"fill-mode":te.value==="fill"}])},k[19]||(k[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):l("",!0),e("button",{onClick:we,class:"capture-button",disabled:$.value||R.value},[e("div",rs,[$.value?(s(),o("div",us)):(s(),o("div",ds,k[20]||(k[20]=[e("div",{class:"camera-lens"},null,-1),e("div",{class:"camera-flash"},null,-1)])))])],8,ls),t.settings.enable_camera_switch&&I.value?(s(),o("button",{key:1,onClick:S,class:"control-button",disabled:R.value},k[21]||(k[21]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,cs)):l("",!0)]),p.value||ie.value?(s(),o("div",ps,[e("button",{onClick:k[5]||(k[5]=H=>me("continuous")),class:J(["control-btn",{active:pe.value==="continuous"}])}," Auto Focus ",2),e("button",{onClick:k[6]||(k[6]=H=>me("manual")),class:J(["control-btn",{active:pe.value==="manual"}])}," Manual Focus ",2),ie.value?(s(),o("button",{key:0,onClick:k[7]||(k[7]=H=>W("continuous")),class:J(["control-btn",{active:A.value==="continuous"}])}," Auto Expo ",2)):l("",!0),ie.value?(s(),o("button",{key:1,onClick:k[8]||(k[8]=H=>W("manual")),class:J(["control-btn",{active:A.value==="manual"}])}," Manual Expo ",2)):l("",!0)])):l("",!0)])])])):l("",!0)}}},ms=Ke(gs,[["__scopeId","data-v-de90e34f"]]),vs=["accept","multiple","disabled"],fs={class:"text-xs text-gray-500 mb-2"},hs=["disabled"],bs={class:"h-full flex flex-col items-center justify-center p-4 text-center"},ys={class:"text-xs text-gray-400 mt-1"},xs={key:0,class:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},ks={class:"flex items-center justify-between mb-2"},ws={class:"text-xs text-blue-600"},Is={class:"w-full bg-blue-200 rounded-full h-2"},$s={class:"text-xs text-blue-600 mt-1"},Ss={key:1,class:"flex items-center gap-4"},Cs=["src"],As={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},_s=["disabled"],Ts={key:2,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},Ns=["disabled"],Es=["onClick"],Vs=["src"],Us={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},Ms={key:0},Ds={key:1,class:"ml-1"},Ps={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Rs={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Ls={key:2,class:"mt-1 text-xs text-red-600"},Bs={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(t,{emit:Y}){const a=t,w=Y,r=y(null),m=y(null),v=y(!1),u=y(!1),i=y(!1),x=y([]),C=y(0),I=y(!1),M=y(0),O=y(0),j=y(0),G=wt("imageSourceSetting",y("all")),K=`inspection-${a.inspectionId}-point-${a.pointId}-backup`,U=ne(()=>Number(a.settings.max_files)>1),$=ne(()=>a.settings.allowed_types.map(d=>`.${d}`).join(", ")),R=ne(()=>{const d=a.settings.camera_aspect_ratio.split(":");if(d.length===2){const T=parseFloat(d[0]),f=parseFloat(d[1]);if(!isNaN(T)&&!isNaN(f)&&f!==0)return T/f}return 3/4}),L=ne(()=>{const d=[],T=new Set;for(const f of a.modelValue)f.id&&T.add(f.id),d.push({...f,rotation:f.rotation||0,isNew:!1,isUploaded:!0,preview:f.preview||(f.image_path?`/${f.image_path}`:null)});for(const f of x.value)f.id&&T.add(f.id),d.push({...f,isUploading:f.isUploading||!1});return d}),V=d=>d.preview||(d.image_path?`/${d.image_path}`:""),B=()=>{i.value&&(i.value=!1),G.value==="camera"?pe():G.value==="gallery"?Z():v.value=!0},Z=()=>{v.value=!1,r.value.click()},pe=()=>{v.value=!1,u.value=!0},N=()=>{v.value=!1,L.value.length>0&&(i.value=!0)},g=()=>{u.value=!1,L.value.length>0&&(i.value=!0)},n=()=>{i.value=!1,I.value||(x.value.forEach(d=>{d.preview&&d.preview.startsWith("blob:")&&URL.revokeObjectURL(d.preview)}),x.value=[])},p=d=>new Promise(T=>{const f=new FileReader;f.onload=E=>{const D=new Image;D.onload=()=>{T({file:d,preview:URL.createObjectURL(d),rotation:0,width:D.naturalWidth,height:D.naturalHeight,isNew:!0})},D.onerror=()=>{console.error("Failed to load image for dimensions:",d.name),T({file:d,preview:URL.createObjectURL(d),rotation:0,width:0,height:0,isNew:!0})},D.src=E.target.result},f.readAsDataURL(d)}),A=d=>{const T=d.name.split(".").pop().toLowerCase();return a.settings.allowed_types.includes(T)},z=async d=>{const f=(a.settings.max_size||2048)*1024;return new Promise(E=>{const D=new Image,ae=new FileReader;ae.onload=X=>{D.onload=()=>{const Q=document.createElement("canvas"),W=Q.getContext("2d"),le=Math.max(D.width,D.height);Q.width=le,Q.height=le,W.fillStyle="white",W.fillRect(0,0,le,le);const re=(le-D.width)/2,we=(le-D.height)/2;W.drawImage(D,re,we,D.width,D.height);let Ve=.9;const Pe=()=>{Q.toBlob(je=>{if(je.size>f&&Ve>.1)Ve-=.1,Pe();else{const Oe=new File([je],d.name,{type:"image/jpeg",lastModified:Date.now()});E(Oe)}},"image/jpeg",Ve)};Pe()},D.src=X.target.result},ae.readAsDataURL(d)})},ge=async d=>{const T=Array.from(d.target.files);if(!T.length){v.value=!1,L.value.length>0&&(i.value=!0);return}try{const f=T.filter(W=>!A(W));if(f.length>0){const W=f.map(le=>le.name.split(".").pop()).join(", ");alert(`File type not allowed: ${W}. Allowed types: ${a.settings.allowed_types.join(", ")}`),d.target.value="";return}const E=L.value.length,D=a.settings.max_files-E,ae=await Promise.all(T.slice(0,D).map(async W=>await z(W))),X=await Promise.all(ae.map(p)),Q=U.value?X:X.slice(0,1);U.value?x.value.push(...Q):(x.value.forEach(W=>{W.preview&&W.preview.startsWith("blob:")&&URL.revokeObjectURL(W.preview)}),x.value=Q),v.value=!1,Q.length>0?(C.value=Math.max(0,L.value.length-Q.length),i.value=!0):L.value.length>0&&(i.value=!0),d.target.value=""}catch(f){console.error("Error processing selected images:",f),alert("Failed to process selected images. Please try again."),v.value=!1,L.value.length>0&&(i.value=!0)}},ce=async d=>{const T=L.value.length;if(!U.value||T<a.settings.max_files)try{const f=await z(d),E=new Image;E.onload=()=>{const D={file:f,preview:URL.createObjectURL(f),rotation:0,width:E.naturalWidth,height:E.naturalHeight,isNew:!0};U.value?x.value.push(D):(x.value.forEach(ae=>{ae.preview&&ae.preview.startsWith("blob:")&&URL.revokeObjectURL(ae.preview)}),x.value=[D]),u.value=!1,v.value=!1,C.value=L.value.length-1,i.value=!0},E.src=URL.createObjectURL(f)}catch(f){console.error("Error processing captured image:",f),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${a.settings.max_files} files allowed.`),u.value=!1,v.value=!1,L.value.length>0&&(i.value=!0)},ie=(d=0)=>{C.value=d,i.value=!0},fe=d=>new Promise(T=>{if(d.rotation===0||!m.value){if(!d.isNew&&!d.file){T({file:null,width:d.width,height:d.height,isOriginal:!0});return}T({file:d.file,width:d.width,height:d.height});return}const f=new Image;f.onload=async()=>{try{const E=m.value,D=E.getContext("2d"),ae=f.width,X=f.height;let Q,W;d.rotation===90||d.rotation===270?(Q=X,W=ae):(Q=ae,W=X),E.width=Q,E.height=W,D.clearRect(0,0,E.width,E.height),D.translate(E.width/2,E.height/2),D.rotate(d.rotation*Math.PI/180),D.drawImage(f,-ae/2,-X/2,ae,X),D.setTransform(1,0,0,1,0,0);const le=await new Promise(Ve=>{E.toBlob(Ve,"image/jpeg",.9)}),re=new File([le],d.file?d.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),we=await z(re);T({file:we,width:Q,height:W})}catch(E){console.error("Error processing rotated image:",E),T({file:d.file,width:d.width,height:d.height})}},f.onerror=()=>{console.error("Failed to load image for rotation processing:",d.preview),T({file:d.file,width:d.width,height:d.height})},f.src=d.preview}),se=d=>{try{const T={images:d.map(f=>{var E;return{fileName:((E=f.file)==null?void 0:E.name)||`image-${Date.now()}.jpg`,rotation:f.rotation||0,width:f.width||0,height:f.height||0,timestamp:Date.now()}}),inspectionId:a.inspectionId,pointId:a.pointId};localStorage.setItem(K,JSON.stringify(T))}catch(T){console.error("Error saving backup:",T)}},te=()=>{localStorage.removeItem(K)},he=async d=>{I.value=!0;const T=[],f=[];if(!a.pointId){alert("Error: Point ID is missing. Cannot upload image."),I.value=!1;return}try{se(d);for(const E of d){if(!E.isNew&&E.rotation===0&&E.id&&E.image_path){T.push({id:E.id,image_path:E.image_path,width:E.width,height:E.height,rotation:0,preview:E.preview,isUploaded:!0});continue}const{file:D,width:ae,height:X,isOriginal:Q}=await fe(E);if(Q&&!E.isNew){T.push({id:E.id,image_path:E.image_path,width:E.width,height:E.height,rotation:E.rotation||0,preview:E.preview,isUploaded:!0});continue}D&&f.push({file:D,width:ae,height:X,rotation:E.rotation||0,originalImage:E})}n(),f.length>0?await ve(f,T):(w("update:modelValue",T),w("save",a.pointId))}catch(E){console.error("Error during image processing:",E),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{I.value=!1}},ve=async(d,T)=>{j.value=d.length,O.value=0,M.value=0;const f=[...T];let E=0;try{for(let D=0;D<d.length;D++){const ae=d[D],X=new FormData;X.append("inspection_id",a.inspectionId),X.append("point_id",a.pointId),X.append("images[]",ae.file);const Q=x.value.findIndex(W=>{var le;return W.preview===((le=ae.originalImage)==null?void 0:le.preview)});Q!==-1&&(x.value[Q].isUploading=!0,x.value[Q].isFailed=!1);try{const le=(await Xe.post(route("inspections.upload-image"),X,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:re=>{if(re.total){const we=Math.round(re.loaded*100/re.total);M.value=Math.round((D+re.loaded/re.total)/d.length*100),O.value=D+1}}})).data.images;if(le&&le.length>0){const re=le[0];if(f.push({id:re.image_id,image_path:re.path,width:re.width||ae.width||0,height:re.height||ae.height||0,rotation:ae.rotation||0,preview:re.public_url,isUploaded:!0}),Q!==-1){const we=x.value.splice(Q,1)[0];we.preview&&we.preview.startsWith("blob:")&&URL.revokeObjectURL(we.preview)}E++}}catch(W){console.error(`Error uploading image ${D+1}:`,W),Q!==-1&&(x.value[Q].isUploading=!1,x.value[Q].isFailed=!0)}}E>0&&(w("update:modelValue",f),w("save",a.pointId),w("uploaded",{pointId:a.pointId,images:f,newImagesCount:E})),E===d.length&&te(),console.log(`✅ Successfully uploaded ${E}/${d.length} images`)}catch(D){console.error("Error in upload process:",D),d.forEach(ae=>{const X=x.value.findIndex(Q=>{var W;return Q.preview===((W=ae.originalImage)==null?void 0:W.preview)});X!==-1&&(x.value[X].isUploading=!1,x.value[X].isFailed=!0)})}finally{M.value=0,O.value=0,j.value=0,I.value=!1}},q=async d=>{if(!d||!d.file){console.error("No file to retry upload");return}I.value=!0;const T=[...a.modelValue];try{const f=new FormData;f.append("inspection_id",a.inspectionId),f.append("point_id",a.pointId),f.append("images[]",d.file);const E=x.value.findIndex(X=>X.preview===d.preview);E!==-1&&(x.value[E].isUploading=!0,x.value[E].isFailed=!1);const ae=(await Xe.post(route("inspections.upload-image"),f,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(ae&&ae.length>0){const X=ae[0];if(T.push({id:X.image_id,image_path:X.path,width:X.width||d.width||0,height:X.height||d.height||0,rotation:d.rotation||0,preview:X.public_url,isUploaded:!0}),E!==-1){const W=x.value.splice(E,1)[0];W.preview&&W.preview.startsWith("blob:")&&URL.revokeObjectURL(W.preview)}w("update:modelValue",T),w("save",a.pointId),w("uploaded",{pointId:a.pointId,images:T,newImagesCount:1}),x.value.some(W=>W.isFailed)||te(),console.log("✅ Successfully retried upload for 1 image")}}catch(f){console.error("Error retrying upload:",f),previewIndex!==-1&&(x.value[previewIndex].isUploading=!1,x.value[previewIndex].isFailed=!0)}finally{I.value=!1}},Be=d=>{if(d){if(d.id&&!d.isNew)De(d);else{const T=x.value.findIndex(f=>f.preview&&f.preview===d.preview&&f.isNew||f.id&&f.id===d.id);if(T!==-1){const f=x.value.splice(T,1)[0];f.preview&&f.preview.startsWith("blob:")&&URL.revokeObjectURL(f.preview)}w("update:modelValue",a.modelValue.filter(f=>!(f.id&&f.id===d.id)&&!(f.preview&&f.preview===d.preview)))}C.value>=L.value.length&&(C.value=Math.max(0,L.value.length-1)),L.value.length===0&&n()}},De=async d=>{var f,E;if(d.id||d.image_path)try{await Xe.delete(route("inspections.delete-image"),{data:{image_id:d.id,image_path:d.image_path}})}catch(D){console.error("Error deleting image from server:",D),(E=(f=D.response)==null?void 0:f.data)!=null&&E.message?alert(`Failed to delete image from server: ${D.response.data.message}`):alert(`Failed to delete image from server: ${D.message}`);return}d.preview&&d.preview.startsWith("blob:")&&URL.revokeObjectURL(d.preview);const T=a.modelValue.filter(D=>D.id!==d.id);w("update:modelValue",T),x.value=x.value.filter(D=>D.isNew&&d.isNew?D.preview!==d.preview:D.id!==d.id),w("removeImage",{image:d}),i.value&&L.value.length===0?n():i.value&&C.value>=L.value.length&&(C.value=Math.max(0,L.value.length-1))};return We(()=>{try{localStorage.getItem(K)&&console.log("Found backup images, ready for recovery if needed")}catch(d){console.error("Error loading backup:",d)}}),(d,T)=>(s(),o("div",null,[e("input",{ref_key:"galleryInput",ref:r,type:"file",accept:$.value,class:"hidden",onChange:ge,multiple:U.value,disabled:I.value},null,40,vs),e("canvas",{ref_key:"processingCanvas",ref:m,class:"hidden"},null,512),e("p",fs,"Foto Maksimal: "+_(t.settings.max_files)+" | Rasio: "+_(t.settings.camera_aspect_ratio),1),L.value.length===0?(s(),o("label",{key:0,onClick:B,class:J(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:I.value},[e("div",bs,[T[2]||(T[2]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),T[3]||(T[3]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",ys,"Tipe: "+_($.value),1)])],8,hs)):(s(),o("div",{key:1,class:J(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":t.settings.max_files==1,"bg-transparent":t.settings.max_files>1}]),"aria-label":"Image gallery"},[I.value?(s(),o("div",xs,[e("div",ks,[T[4]||(T[4]=e("span",{class:"text-sm font-medium text-blue-700"},"Mengupload gambar...",-1)),e("span",ws,_(M.value)+"%",1)]),e("div",Is,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:qe({width:M.value+"%"})},null,4)]),e("p",$s,_(O.value)+"/"+_(j.value)+" gambar terupload",1)])):l("",!0),t.settings.max_files===1?(s(),o("div",Ss,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:T[0]||(T[0]=f=>ie(0))},[e("img",{src:V(L.value[0]),class:"w-full h-full object-cover"},null,8,Cs),L.value[0].isUploading?(s(),o("div",As,T[5]||(T[5]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):l("",!0)]),e("button",{onClick:T[1]||(T[1]=Ze(f=>De(L.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:I.value},T[6]||(T[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Se(" Hapus Foto ")]),8,_s)])):(s(),o("div",Ts,[U.value&&L.value.length<t.settings.max_files?(s(),o("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:B,disabled:I.value},T[7]||(T[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,Ns)):l("",!0),(s(!0),o(Ne,null,Ee(L.value,(f,E)=>(s(),o("div",{key:f.id||f.preview,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:D=>f.isFailed?q(f):ie(E)},[e("img",{src:V(f),class:"w-full h-full object-cover"},null,8,Vs),f.isNew||f.rotation!==0?(s(),o("div",Us,[f.isNew?(s(),o("span",Ms,"BARU")):l("",!0),f.rotation!==0?(s(),o("span",Ds,"ROTASI")):l("",!0)])):l("",!0),f.isUploading?(s(),o("div",Ps,T[8]||(T[8]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):l("",!0),f.isFailed?(s(),o("div",Rs,T[9]||(T[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"text-xs font-medium"},"Retry",-1)]))):l("",!0)],8,Es))),128))]))],2)),t.error?(s(),o("p",Ls,_(t.error),1)):l("",!0),Te(on,{show:v.value,settings:t.settings,onClose:N,onOpenWebcam:pe,onTriggerGallery:Z},null,8,["show","settings"]),Te(ms,{show:u.value,"aspect-ratio":R.value,settings:t.settings,point:t.point,onClose:g,onPhotoCaptured:ce},null,8,["show","aspect-ratio","settings","point"]),Te(Rn,{show:i.value,images:L.value,point:t.point,"initial-index":C.value,"allow-multiple":U.value,"max-files":t.settings.max_files,"is-uploading":I.value,"aspect-ratio":R.value,"upload-progress":M.value,"current-upload":O.value,"total-upload":j.value,onClose:n,onSaveImages:he,onRemovePreviewImage:Be,onTriggerAddMorePhotos:B,onRetryImage:q},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},tt=Ke(Bs,[["__scopeId","data-v-3180dd6e"]]),js={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Fs={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Os={class:"px-4 pb-2 border-b border-gray-200"},qs={class:"text-lg font-semibold text-gray-900"},Hs={key:0,class:"text-sm text-gray-500 mt-1"},Ks={class:"flex-1 overflow-y-auto p-4"},zs={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Gs={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(t){return(Y,a)=>(s(),Me(Je,{name:"bottom-sheet"},{default:He(()=>[t.show?(s(),o("div",js,[a[1]||(a[1]=e("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),e("div",Fs,[a[0]||(a[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Os,[e("h3",qs,_(t.title),1),t.subtitle?(s(),o("p",Hs,_(t.subtitle),1)):l("",!0)]),e("div",Ks,[xt(Y.$slots,"default",{},void 0,!0)]),Y.$slots.footer?(s(),o("div",zs,[xt(Y.$slots,"footer",{},void 0,!0)])):l("",!0)])])):l("",!0)]),_:3}))}},Ws=Ke(Gs,[["__scopeId","data-v-fd942535"]]),Zs={class:"space-y-4"},Js={key:0,class:"mt-2"},Ys={key:1,class:"mt-2"},Xs={key:2,class:"mt-2"},Qs={key:3,class:"mt-2"},eo={key:4,class:"mt-2"},to={class:"text-sm font-medium text-gray-700 mb-2"},ao={key:0,class:"text-red-500"},no={key:0,class:"text-xs text-red-500"},so=["name","value","checked"],oo={key:6,class:"space-y-2"},io={key:0,class:"text-red-500"},lo={key:1,class:"text-xs text-red-500"},ro={key:7,class:"mt-4"},uo={class:"text-sm font-medium text-gray-700 mb-2"},co={key:0,class:"text-red-500"},po={key:0,class:"text-xs text-red-500"},go={class:"flex gap-2"},mo=["disabled"],Tt={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:String,notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(t,{emit:Y}){const a=t,w=Y,r=u=>w("hapus",u),m=ne(()=>a.options.find(u=>u.value===a.selectedValue)),v=ne(()=>{var i,x,C,I,M,O,j;if(a.point.input_type==="text"&&(!((i=a.notesValue)!=null&&i.trim())||a.point.settings.min_length&&a.notesValue.length<a.point.settings.min_length||a.point.settings.max_length&&a.notesValue.length>a.point.settings.max_length)||a.point.input_type==="number"&&(!((x=a.notesValue)!=null&&x.trim())||a.point.settings.min&&a.notesValue.length<a.point.settings.min||a.point.settings.max&&a.notesValue.length>a.point.settings.max)||a.point.input_type==="account"&&(!((C=a.notesValue)!=null&&C.trim())||a.point.settings.min_value&&a.notesValue.length<a.point.settings.min_value||a.point.settings.max_value&&a.notesValue.length>a.point.settings.max_value)||a.point.input_type==="date"&&(!((I=a.notesValue)!=null&&I.trim())||a.point.settings.min_date&&a.notesValue.length<a.point.settings.min_date||a.point.settings.max_date&&a.notesValue.length>a.point.settings.max_date))return!1;if(a.point.input_type==="imageTOradio"){if(a.imagesValue.length===0)return!1;const G=a.imagesValue.some(U=>U.status==="error"),K=a.imagesValue.some(U=>U.status==="uploading");if(G||K)return!1}if(a.options.length&&!a.selectedValue)return!1;const u=m.value;if(a.showTextarea&&((M=u==null?void 0:u.settings)!=null&&M.show_textarea)&&(!((O=a.notesValue)!=null&&O.trim())||u.settings.min_length&&a.notesValue.length<u.settings.min_length||u.settings.max_length&&a.notesValue.length>u.settings.max_length))return!1;if(a.showImageUpload&&((j=u==null?void 0:u.settings)!=null&&j.show_image_upload)){if(a.imagesValue.length===0||u.settings.max_files&&a.imagesValue.length>u.settings.max_files)return!1;const G=a.imagesValue.some(U=>U.status==="error"),K=a.imagesValue.some(U=>U.status==="uploading");if(G||K)return!1}return!0});return(u,i)=>(s(),Me(Ws,{show:t.show,title:t.title,subtitle:t.subtitle,onClose:i[18]||(i[18]=x=>u.$emit("close"))},{footer:He(()=>[t.selectedPoint?(s(),o("button",{key:0,onClick:i[15]||(i[15]=x=>r(t.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},i[20]||(i[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),Se(" Hapus Data ")]))):l("",!0),e("div",go,[e("button",{type:"button",onClick:i[16]||(i[16]=x=>u.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:i[17]||(i[17]=x=>u.$emit("save")),disabled:!v.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,mo)])]),default:He(()=>{var x,C,I,M,O,j,G,K,U,$,R,L,V,B,Z,pe,N,g,n,p,A,z,ge,ce,ie,fe,se,te,he,ve;return[e("div",Zs,[t.point.input_type==="text"?(s(),o("div",Js,[Te($t,{"model-value":t.notesValue,required:(x=t.point.settings)==null?void 0:x.is_required,"min-length":(C=t.point.settings)==null?void 0:C.min_length,"max-length":(I=t.point.settings)==null?void 0:I.max_length,allowSpace:(M=t.point.settings)==null?void 0:M.allow_space,textTransform:(O=t.point.settings)==null?void 0:O.text_transform,placeholder:((j=t.point.settings)==null?void 0:j.placeholder)||"Masukan text",error:u.error,"onUpdate:modelValue":i[0]||(i[0]=q=>u.$emit("update:notesValue",q)),onSave:i[1]||(i[1]=q=>u.$emit("saveText",q))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):l("",!0),t.point.input_type==="number"?(s(),o("div",Ys,[Te(St,{"model-value":t.notesValue,required:(G=t.point.settings)==null?void 0:G.is_required,min:(K=t.point.settings)==null?void 0:K.min,max:(U=t.point.settings)==null?void 0:U.max,step:(($=t.point.settings)==null?void 0:$.step)||1,placeholder:((R=t.point.settings)==null?void 0:R.placeholder)||"Masukan number",error:u.error,"onUpdate:modelValue":i[2]||(i[2]=q=>u.$emit("update:notesValue",q)),onSave:i[3]||(i[3]=q=>u.$emit("saveNumber",q))},null,8,["model-value","required","min","max","step","placeholder","error"])])):l("",!0),t.point.input_type==="account"?(s(),o("div",Xs,[Te(At,{"model-value":t.notesValue,required:(L=t.point.settings)==null?void 0:L.is_required,placeholder:((V=t.point.settings)==null?void 0:V.placeholder)||"Masukkan nilai",error:u.error,"point-id":t.pointId,settings:t.point.settings,"onUpdate:modelValue":i[4]||(i[4]=q=>u.$emit("update:notesValue",q)),onSave:i[5]||(i[5]=q=>u.$emit("saveAccount",q))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):l("",!0),t.point.input_type==="date"?(s(),o("div",Qs,[Te(Ct,{"model-value":t.notesValue,required:(B=t.point.settings)==null?void 0:B.is_required,"min-date":(Z=t.point.settings)==null?void 0:Z.min_date,"max-date":(pe=t.point.settings)==null?void 0:pe.max_date,error:u.error,"onUpdate:modelValue":i[6]||(i[6]=q=>u.$emit("update:notesValue",q)),onSave:i[7]||(i[7]=q=>u.$emit("saveDate",q))},null,8,["model-value","required","min-date","max-date","error"])])):l("",!0),t.point.input_type==="imageTOradio"?(s(),o("div",eo,[e("h4",to,[(N=t.point.settings)!=null&&N.required?(s(),o("span",ao,"*")):l("",!0)]),Te(tt,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point.inspection_point,"inspection-id":t.inspectionId,settings:t.point.settings,"onUpdate:modelValue":i[8]||(i[8]=q=>u.$emit("update:imagesValue",q)),onSave:i[9]||(i[9]=q=>u.$emit("saveImage",q))},null,8,["model-value","point-id","point","inspection-id","settings"]),(g=t.point.settings)!=null&&g.required&&t.imagesValue.length===0?(s(),o("p",no," Foto wajib diupload ")):l("",!0)])):l("",!0),t.options.length?(s(),o("div",{key:5,class:J(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ne,null,Ee(t.options,(q,Be)=>(s(),o("label",{key:Be,class:"cursor-pointer"},[e("input",{type:"radio",name:t.name,value:q.value,checked:t.selectedValue===q.value,onChange:i[10]||(i[10]=De=>u.$emit("update:selectedValue",De.target.value)),class:"hidden peer"},null,40,so),e("div",{class:J(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.selectedValue===q.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.selectedValue!==q.value}])},_(q.label),3)]))),128))],2)):l("",!0),t.showTextarea&&((p=(n=m.value)==null?void 0:n.settings)!=null&&p.show_textarea)?(s(),o("div",oo,[(A=m.value.settings)!=null&&A.required?(s(),o("span",io,"*")):l("",!0),Te(_t,{"model-value":t.notesValue,"point-id":t.pointId,"inspection-id":t.inspectionId,settings:m.value.settings,required:(z=m.value.settings)==null?void 0:z.required,"min-length":(ge=m.value.settings)==null?void 0:ge.min_length,"max-length":(ce=m.value.settings)==null?void 0:ce.max_length,placeholder:((ie=m.value.settings)==null?void 0:ie.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":i[11]||(i[11]=q=>u.$emit("update:notesValue",q)),onSave:i[12]||(i[12]=q=>u.$emit("saveTextarea",q))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(fe=m.value.settings)!=null&&fe.required&&!t.notesValue?(s(),o("p",lo," Keterangan wajib diisi ")):l("",!0)])):l("",!0),t.showImageUpload&&((te=(se=m.value)==null?void 0:se.settings)!=null&&te.show_image_upload)?(s(),o("div",ro,[e("h4",uo,[i[19]||(i[19]=Se(" Upload Foto ")),(he=m.value.settings)!=null&&he.required?(s(),o("span",co,"*")):l("",!0)]),Te(tt,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,settings:m.value.settings,"onUpdate:modelValue":i[13]||(i[13]=q=>u.$emit("update:imagesValue",q)),onSave:i[14]||(i[14]=q=>u.$emit("saveImage",q))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ve=m.value.settings)!=null&&ve.required&&t.imagesValue.length===0?(s(),o("p",po," Foto wajib diupload ")):l("",!0)])):l("",!0)])]}),_:1},8,["show","title","subtitle"]))}},vo={class:"mt-2 space-y-2"},fo=["name","value","checked","onChange","required"],ho={key:0,class:"p-2 rounded-lg bg-gray-50"},bo={key:0,class:"mt-2"},yo={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},xo=["src"],ko={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},wo={key:1,class:"mt-2"},Io={class:"text-sm text-gray-600"},$o={key:2,class:"mt-2 text-sm text-red-600"},So={__name:"InputRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:Y}){const a=t,w=Y,r=y(a.notes),m=y([...a.images]),v=y(!1),u=y(""),i=y([]),x=y(""),C=y([]),I=ne(()=>a.options.find(V=>V.value===a.modelValue)),M=V=>V.settings&&(V.settings.show_textarea||V.settings.show_image_upload);ye(()=>a.notes,V=>{r.value=V}),ye(()=>a.images,V=>{m.value=[...V]}),ye(()=>a.modelValue,V=>{V&&(x.value=V)});const O=V=>{w("update:modelValue",V.value),M(V)?G():w("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:V.value,notes:"",images:[]})},j=V=>V.preview||(V.image_path?`/${V.image_path}`:V),G=()=>{x.value=a.modelValue,u.value=r.value,i.value=[...m.value],C.value=[...m.value],v.value=!0},K=()=>{u.value="",i.value=[],x.value="",v.value=!1},U=V=>{i.value=V,m.value=[...V],w("update:images",[...V]),w("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:r.value,images:[...V]})},$=V=>{},R=()=>{x.value!==a.modelValue&&w("update:modelValue",x.value),r.value=u.value,w("update:notes",u.value),m.value=[...i.value],w("update:images",[...i.value]),w("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:x.value,notes:u.value,images:i.value}),v.value=!1},L=V=>{x.value="",u.value="",i.value=[],r.value="",m.value=[],w("update:modelValue",""),w("update:notes",""),w("update:images",[]),w("hapus",V),v.value=!1};return(V,B)=>{var Z,pe,N;return s(),o("div",vo,[e("div",{class:J(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ne,null,Ee(t.options,(g,n)=>(s(),o("label",{key:n,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:g.value,checked:t.modelValue===g.value,onChange:p=>O(g),class:"hidden peer",required:t.required},null,40,fo),e("div",{class:J(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===g.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==g.value}])},_(g.label),3)]))),128))],2),t.modelValue&&I.value&&M(I.value)?(s(),o("div",ho,[e("div",{class:"flex justify-between items-start"},[B[4]||(B[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:G,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),t.images.length>0&&((Z=I.value.settings)!=null&&Z.show_image_upload)?(s(),o("div",bo,[e("div",yo,[(s(!0),o(Ne,null,Ee(t.images,(g,n)=>(s(),o("div",{key:n,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:j(g),class:"w-full h-full object-cover rounded"},null,8,xo),n===3&&t.images.length>4?(s(),o("span",ko," +"+_(t.images.length-4),1)):l("",!0)]))),128))])])):l("",!0),t.notes&&((pe=I.value.settings)!=null&&pe.show_textarea)?(s(),o("div",wo,[e("p",Io,_(t.notes),1)])):l("",!0)])):l("",!0),v.value?(s(),Me(Tt,{key:(N=t.selectedPoint)==null?void 0:N.id,show:v.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":x.value,"notes-value":u.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":B[0]||(B[0]=g=>x.value=g),"onUpdate:notesValue":B[1]||(B[1]=g=>u.value=g),"onUpdate:imagesValue":B[2]||(B[2]=g=>U(g)),onClose:K,onSave:R,onSaveTextarea:V.handleTextareaSave,onSaveImage:$,onHapus:B[3]||(B[3]=g=>L(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):l("",!0),t.error?(s(),o("p",$o,_(t.error),1)):l("",!0)])}}},Co={class:"mt-2 space-y-2"},Ao={key:0,class:"flex flex-wrap gap-3"},_o={key:1,class:"p-2"},To={key:0,class:"mt-2"},No={class:"flex gap-2 overflow-x-auto scrollbar-hide"},Eo=["src"],Vo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Uo=["name","value","checked"],Mo={key:1,class:"mt-2"},Do={class:"text-sm text-gray-600"},Po={key:3,class:"mt-2 text-sm text-red-600"},Ro={__name:"InputImageToRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:Y}){const a=t,w=Y,r=y(a.notes),m=y([...a.images]),v=y(!1),u=y(""),i=y([]),x=y(""),C=y([]),I=ne(()=>a.options.find($=>$.value===a.modelValue)),M=$=>$.preview||($.image_path?`/${$.image_path}`:$);ye(()=>a.notes,$=>{r.value=$});const O=()=>{x.value=a.modelValue||"",u.value=r.value,i.value=[...m.value],C.value=[...m.value],v.value=!0},j=()=>{u.value="",i.value=[],x.value="",v.value=!1},G=$=>{i.value=$,m.value=[...$],w("update:images",[...$]),w("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:r.value,images:[...$]})},K=()=>{x.value!==a.modelValue&&w("update:modelValue",x.value),r.value=u.value,w("update:notes",u.value),m.value=[...i.value],w("update:images",[...i.value]),w("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:x.value,notes:u.value,images:i.value}),v.value=!1},U=$=>{x.value="",u.value="",i.value=[],r.value="",m.value=[],w("update:modelValue",""),w("update:notes",""),w("update:images",[]),w("hapus",$),v.value=!1};return($,R)=>{var L,V;return s(),o("div",Co,[!t.modelValue&&m.value.length===0&&!r.value?(s(),o("div",Ao,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:O},R[4]||(R[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(s(),o("div",_o,[e("div",{class:"flex justify-between items-start"},[R[5]||(R[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:O,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),m.value.length>0?(s(),o("div",To,[e("div",No,[(s(!0),o(Ne,null,Ee(m.value,(B,Z)=>(s(),o("div",{key:Z,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:M(B),class:"w-full h-full object-cover rounded"},null,8,Eo),Z===3&&m.value.length>4?(s(),o("span",Vo," +"+_(m.value.length-4),1)):l("",!0)]))),128))])])):l("",!0),e("div",{class:J(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ne,null,Ee(t.options,(B,Z)=>(s(),o("label",{key:Z,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:B.value,checked:t.modelValue===B.value,disabled:!0,class:"hidden peer"},null,8,Uo),e("div",{class:J(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===B.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==B.value}])},_(B.label),3)]))),128))],2),r.value&&((L=I.value.settings)!=null&&L.show_textarea)?(s(),o("div",Mo,[e("p",Do,_(r.value),1)])):l("",!0)])),v.value?(s(),Me(Tt,{key:(V=t.selectedPoint)==null?void 0:V.id,show:v.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":x.value,"notes-value":u.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":R[0]||(R[0]=B=>x.value=B),"onUpdate:notesValue":R[1]||(R[1]=B=>u.value=B),"onUpdate:imagesValue":R[2]||(R[2]=B=>G(B)),onClose:j,onSave:K,onHapus:R[3]||(R[3]=B=>U(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):l("",!0),t.error?(s(),o("p",Po,_(t.error),1)):l("",!0)])}}},Lo={class:"text-base font-semibold text-indigo-700"},Bo={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},jo={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Fo={class:"text-base font-semibold text-indigo-700"},Oo={class:"p-4 space-y-4"},qo={key:0,class:"flex justify-end py-1"},Ho=["onClick"],Ko={key:1,class:"space-y-2"},zo={class:"flex items-start justify-between"},Go={class:"flex-1"},Wo={class:"block text-sm font-medium text-gray-700"},Zo={key:0,class:"text-red-500"},Jo={key:1,class:"italic text-xs text-gray-400 ml-2"},Yo={key:0,class:"mt-1"},Xo={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Qo={key:0},ei={key:1},ti={key:2},ai={key:3},ni={key:4},si={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},oi={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},ii={class:"text-xs mt-1 list-disc list-inside"},li={key:0},ri={key:1},ui={key:2},di={key:3},ci={key:4},pi={key:0,class:"text-center py-8 text-gray-500"},gi={key:0,class:"text-xs text-gray-400"},mi={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(t,{emit:Y}){const a=t,w=Y,r=wt("vehicleFeatures",y(null));r.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Ut("vehicleFeatures",r);const m=y(!1),v=y([]),u=y(!0),i=y(null),x=Mt(),C={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};We(()=>{const N=new IntersectionObserver(([g])=>{u.value=g.isIntersecting},{threshold:.1});i.value&&N.observe(i.value),Ye(()=>{i.value&&N.unobserve(i.value)})});const I=()=>{m.value=!m.value,m.value||(v.value=[])},M=ne(()=>(a.category.points||[]).some(N=>N.is_default===!1)),O=N=>!N||!Array.isArray(N)?[]:N.map(g=>C[g]||g),j=N=>{var A,z;const g=N.settings;if(!G(N))return!0;const n=(A=a.car)==null?void 0:A.transmission,p=(z=a.car)==null?void 0:z.fuel_type;return!(g.transmission&&Array.isArray(g.transmission)&&g.transmission.length>0&&n&&!g.transmission.includes(n)||g.fuel_type&&g.fuel_type.trim()!==""&&p&&g.fuel_type!==p||g.rear_door&&(!r.value||!r.value.rear_door)||g.pick_up&&(!r.value||!r.value.pick_up)||g.box&&(!r.value||!r.value.box))},G=N=>{const g=N.settings;return!!(g!=null&&g.transmission&&Array.isArray(g.transmission)&&g.transmission.length>0||g!=null&&g.fuel_type&&g.fuel_type.trim()!==""||g!=null&&g.rear_door||g!=null&&g.pick_up||g!=null&&g.box)},K=N=>G(N)&&(m.value||j(N)),U=ne(()=>{const N=a.category.points||[],g=[];let n=[];return m.value?a.category.isDamageMenu?N.filter(p=>{var A;return p.is_default||R((A=p.inspection_point)==null?void 0:A.id)||m.value}):N:a.category.isDamageMenu?N.filter(p=>{var z;const A=(z=p.inspection_point)==null?void 0:z.id;return R(A)||p.is_default||v.value.includes(A)}):(N.forEach(p=>{var se;const A=(se=p.inspection_point)==null?void 0:se.id,z=R(A),ge=v.value.includes(A),ie=!G(p)||j(p);(p.is_default||z||ge)&&ie?(n.length>0&&(g.push({is_link:!0,count:n.length,hiddenIds:n.map(te=>te.inspection_point.id)}),n.forEach(te=>{v.value.includes(te.inspection_point.id)&&g.push(te)}),n=[]),g.push(p)):(!G(p)||j(p))&&n.push(p)}),n.length>0&&(g.push({is_link:!0,count:n.length,hiddenIds:n.map(p=>p.inspection_point.id)}),n.forEach(p=>{v.value.includes(p.inspection_point.id)&&g.push(p)})),g.filter(p=>{var A,z;return p.is_link||p.is_default||R((A=p.inspection_point)==null?void 0:A.id)||v.value.includes((z=p.inspection_point)==null?void 0:z.id)}))});ne(()=>U.value.filter(N=>!N.is_link));const $=N=>{m.value=!1,N.forEach(g=>{v.value.includes(g)||v.value.push(g)})},R=N=>{if(!N)return!1;const g=x.props.existingResults[N]!==void 0,n=x.props.existingImages[N]&&x.props.existingImages[N].length>0,p=a.form.results[N]&&(a.form.results[N].status||a.form.results[N].note),A=a.form.images[N]&&a.form.images[N].length>0;return g||n||p||A},L=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],V=N=>{var p,A,z,ge,ce,ie,fe,se,te;const g=a.form.results[(p=N.inspection_point)==null?void 0:p.id],n=a.form.images[(A=N.inspection_point)==null?void 0:A.id];if(!g)return!1;switch(N.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!g.note;case"select":case"radio":if(!g.status)return!1;const he=(ge=(z=N.settings)==null?void 0:z.radios)==null?void 0:ge.find(q=>q.value===g.status);return!(he!=null&&he.settings&&(he.settings.show_textarea&&!((ce=g.note)!=null&&ce.trim())||he.settings.show_image_upload&&(n==null?void 0:n.length)===0));case"imageTOradio":if((n==null?void 0:n.length)===0||!g.status)return!1;const ve=(fe=(ie=N.settings)==null?void 0:ie.radios)==null?void 0:fe.find(q=>q.value===g.status);return!(ve!=null&&ve.settings&&ve.settings.show_textarea&&!((se=g.note)!=null&&se.trim()));case"image":return(n==null?void 0:n.length)>0;default:return!!g.status||!!((te=g.note)!=null&&te.trim())}},B=(N,g,n)=>{w("updateResult",{pointId:N,type:n,value:g})},Z=N=>{console.log("Save result for point:",N)},pe=N=>{w("hapusPoint",N)};return ye(()=>a.form.results,N=>{},{deep:!0}),ye(()=>a.form.images,N=>{},{deep:!0}),ye(()=>a.car,N=>{console.log("Car data updated:",N)},{deep:!0}),ye(r,N=>{console.log("Vehicle features updated:",N)},{deep:!0}),(N,g)=>(s(),o(Ne,null,[a.head==="vertical"?(s(),o("div",{key:0,class:J(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[e("h4",Lo,_(t.category.name),1),M.value?(s(),o("button",{key:0,onClick:I,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},_(m.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):l("",!0)])):l("",!0),e("div",{class:J(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",a.head==="vertical"?"pt-6":""])},[!u.value&&M.value?(s(),o("button",{key:0,onClick:I,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[m.value?(s(),o("svg",Bo,g[0]||(g[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(s(),o("svg",jo,g[1]||(g[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):l("",!0),a.head==="horizontal"?(s(),o("div",{key:1,ref_key:"categoryHeader",ref:i,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",Fo,_(t.category.name),1),M.value?(s(),o("button",{key:0,onClick:I,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},_(m.value?"Sembunyikan":"Tampilkan Point Lain"),1)):l("",!0)],512)):l("",!0),e("div",Oo,[(s(!0),o(Ne,null,Ee(U.value,(n,p)=>{var A,z,ge,ce,ie,fe,se,te,he,ve,q,Be,De,d,T,f,E,D,ae,X,Q,W,le,re,we,Ve,Pe,je,Oe,S,b,oe,F,ue,me,be,c,k,ee,H,xe,de,Ie,Ue,Ce,Re,Le,ke,$e,Ae,_e,at,nt,st,ot,it,lt,rt,ut,dt,ct,pt,gt,mt,vt,ft,ht,bt,yt;return s(),o("div",{key:p,class:J(["space-y-2 last:border-0 last:pb-0",n.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[n.is_link?(s(),o("div",qo,[e("button",{onClick:P=>$(n.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+_(n.count)+" Point Tersembunyi ",9,Ho)])):(s(),o("div",Ko,[e("div",zo,[e("div",Go,[e("label",Wo,[Se(_((A=n.inspection_point)==null?void 0:A.name)+" ",1),(z=n.settings)!=null&&z.is_required?(s(),o("span",Zo,"*")):l("",!0),!n.is_default&&!R((ge=n.inspection_point)==null?void 0:ge.id)?(s(),o("span",Jo," (opsional) ")):l("",!0)]),K(n)?(s(),o("div",Yo,[G(n)?(s(),o("div",Xo,[(ce=n.settings)!=null&&ce.transmission?(s(),o("div",Qo,_(n.settings.transmission.join(", ")),1)):l("",!0),(ie=n.settings)!=null&&ie.fuel_type?(s(),o("div",ei,_(n.settings.fuel_type),1)):l("",!0),(fe=n.settings)!=null&&fe.rear_door?(s(),o("div",ti," Pintu Belakang ")):l("",!0),(se=n.settings)!=null&&se.pick_up?(s(),o("div",ai," Tipe Pick Up ")):l("",!0),(te=n.settings)!=null&&te.box?(s(),o("div",ni," Memiliki Box ")):l("",!0)])):l("",!0)])):l("",!0)]),V(n)?(s(),o("span",si," ✓ ")):l("",!0)]),n.input_type==="text"&&j(n)?(s(),Me($t,{key:0,modelValue:t.form.results[(he=n.inspection_point)==null?void 0:he.id].note,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"note")}],required:(ve=n.settings)==null?void 0:ve.is_required,"min-length":(q=n.settings)==null?void 0:q.min_length,"max-length":(Be=n.settings)==null?void 0:Be.max_length,allowSpace:(De=n.settings)==null?void 0:De.allow_space,textTransform:(d=n.settings)==null?void 0:d.text_transform,placeholder:((T=n.settings)==null?void 0:T.placeholder)||"Masukan text",error:t.form.errors[`results.${(f=n.inspection_point)==null?void 0:f.id}.note`],onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):l("",!0),n.input_type==="number"&&j(n)?(s(),Me(St,{key:1,modelValue:t.form.results[(E=n.inspection_point)==null?void 0:E.id].note,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"note")}],required:(D=n.settings)==null?void 0:D.is_required,min:(ae=n.settings)==null?void 0:ae.min,max:(X=n.settings)==null?void 0:X.max,step:((Q=n.settings)==null?void 0:Q.step)||1,placeholder:((W=n.settings)==null?void 0:W.placeholder)||"Masukan number",error:t.form.errors[`results.${(le=n.inspection_point)==null?void 0:le.id}.note`],onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):l("",!0),n.input_type==="account"&&j(n)?(s(),Me(At,{key:2,modelValue:t.form.results[(re=n.inspection_point)==null?void 0:re.id].note,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"note")}],required:(we=n.settings)==null?void 0:we.is_required,placeholder:((Ve=n.settings)==null?void 0:Ve.placeholder)||"Masukkan nilai",error:t.form.errors[`results.${(Pe=n.inspection_point)==null?void 0:Pe.id}.note`],"point-id":(je=n.inspection_point)==null?void 0:je.id,settings:n.settings,onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):l("",!0),n.input_type==="date"&&j(n)?(s(),Me(Ct,{key:3,modelValue:t.form.results[(Oe=n.inspection_point)==null?void 0:Oe.id].note,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"note")}],required:(S=n.settings)==null?void 0:S.is_required,"min-date":(b=n.settings)==null?void 0:b.min_date,"max-date":(oe=n.settings)==null?void 0:oe.max_date,error:t.form.errors[`results.${(F=n.inspection_point)==null?void 0:F.id}.note`],onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):l("",!0),n.input_type==="textarea"&&j(n)?(s(),Me(_t,{key:4,modelValue:t.form.results[(ue=n.inspection_point)==null?void 0:ue.id].note,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"note")}],required:(me=n.settings)==null?void 0:me.is_required,"min-length":(be=n.settings)==null?void 0:be.min_length,"max-length":(c=n.settings)==null?void 0:c.max_length,placeholder:((k=n.settings)==null?void 0:k.placeholder)||"Masukkan teks di sini",settings:n.settings,error:t.form.errors[`results.${(ee=n.inspection_point)==null?void 0:ee.id}.note`],onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):l("",!0),n.input_type==="radio"&&j(n)?(s(),Me(So,{key:5,modelValue:t.form.results[(H=n.inspection_point)==null?void 0:H.id].status,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"status")}],notes:t.form.results[(xe=n.inspection_point)==null?void 0:xe.id].note,images:t.form.images[(de=n.inspection_point)==null?void 0:de.id],required:(Ie=n.settings)==null?void 0:Ie.is_required,"point-id":(Ue=n.inspection_point)==null?void 0:Ue.id,point:n.inspection_point,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(Ce=n.inspection_point)==null?void 0:Ce.name,subtitle:(Re=n.inspection_point)==null?void 0:Re.description,"selected-point":n.inspection_point??null,options:((Le=n.settings)==null?void 0:Le.radios)||L,error:t.form.errors[`results.${(ke=n.inspection_point)==null?void 0:ke.id}.status`],"onUpdate:notes":P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},"onUpdate:images":P=>{var h;return t.form.images[(h=n.inspection_point)==null?void 0:h.id]=P},onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)},onHapus:P=>{var h;return pe((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):l("",!0),n.input_type==="imageTOradio"&&j(n)?(s(),Me(Ro,{key:6,modelValue:t.form.results[($e=n.inspection_point)==null?void 0:$e.id].status,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"status")}],notes:t.form.results[(Ae=n.inspection_point)==null?void 0:Ae.id].note,images:t.form.images[(_e=n.inspection_point)==null?void 0:_e.id],required:(at=n.settings)==null?void 0:at.is_required,"point-id":(nt=n.inspection_point)==null?void 0:nt.id,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(st=n.inspection_point)==null?void 0:st.name,subtitle:(ot=n.inspection_point)==null?void 0:ot.description,point:n,"selected-point":n.inspection_point??null,options:((it=n.settings)==null?void 0:it.radios)||L,error:t.form.errors[`results.${(lt=n.inspection_point)==null?void 0:lt.id}.status`],"onUpdate:notes":P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},"onUpdate:images":P=>{var h;return t.form.images[(h=n.inspection_point)==null?void 0:h.id]=P},onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)},onHapus:P=>{var h;return pe((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):l("",!0),n.input_type==="image"&&j(n)?(s(),Me(tt,{key:7,modelValue:t.form.images[(rt=n.inspection_point)==null?void 0:rt.id],"onUpdate:modelValue":P=>{var h;return t.form.images[(h=n.inspection_point)==null?void 0:h.id]=P},error:t.form.errors[`images.${(ut=n.inspection_point)==null?void 0:ut.id}`],"inspection-id":t.inspectionId,"point-id":(dt=n.inspection_point)==null?void 0:dt.id,point:n.inspection_point,"point-name":(ct=n.inspection_point)==null?void 0:ct.name,settings:n.settings,"onUpdate:notes":P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=P},"onUpdate:status":P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=P}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):l("",!0),n.input_type==="select"&&j(n)?(s(),Me(Qa,{key:8,modelValue:t.form.results[(pt=n.inspection_point)==null?void 0:pt.id].status,"onUpdate:modelValue":[P=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=P},P=>{var h;return B((h=n.inspection_point)==null?void 0:h.id,P,"status")}],required:(gt=n.settings)==null?void 0:gt.is_required,error:t.form.errors[`results.${(mt=n.inspection_point)==null?void 0:mt.id}.status`],onSave:P=>{var h;return Z((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):l("",!0),!j(n)&&G(n)?(s(),o("div",oi,[g[2]||(g[2]=e("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),g[3]||(g[3]=e("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),e("ul",ii,[(vt=n.settings)!=null&&vt.transmission?(s(),o("li",li," Transmisi: "+_(O(n.settings.transmission).join(", ")),1)):l("",!0),(ft=n.settings)!=null&&ft.fuel_type?(s(),o("li",ri," Bahan bakar: "+_(n.settings.fuel_type),1)):l("",!0),(ht=n.settings)!=null&&ht.rear_door?(s(),o("li",ui,"Kendaraan dengan pintu belakang")):l("",!0),(bt=n.settings)!=null&&bt.pick_up?(s(),o("li",di,"Tipe pick up")):l("",!0),(yt=n.settings)!=null&&yt.box?(s(),o("li",ci,"Kendaraan dengan box")):l("",!0)])])):l("",!0)]))],2)}),128)),U.value.filter(n=>!n.is_link).length===0?(s(),o("div",pi,[g[4]||(g[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),g[5]||(g[5]=e("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),t.category.isDamageMenu?(s(),o("p",gi,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):l("",!0)])):l("",!0)])],2)],64))}},Ki=Ke(mi,[["__scopeId","data-v-21688412"]]),vi={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},fi={class:"p-4 space-y-4-6"},hi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},bi=["value"],yi={class:"p-4 space-y-4-6"},xi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},ki=["value"],wi={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},Ii={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},$i=["value"],Si={class:"p-4 space-y-2"},Ci={class:"flex items-center justify-between mb-2"},Ai={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},_i={class:"flex items-center justify-between mb-3"},Ti={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},Ni=["onClick"],Ei={class:"text-sm font-medium text-gray-800 mb-1"},Vi={class:"text-xs text-gray-600 line-clamp-2"},Ui={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},Mi={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},Di={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Pi={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ri={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Li={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(t,{emit:Y}){const a=t,w=Y,r=y(null),m=y(!1),v=y(!1),u=kt({bold:!1,italic:!1,underline:!1}),i=kt({flooded:"",collision:"",collision_severity:"",notes:""}),x=y([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`}]);y(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const C=n=>{if(!n)return{};if(typeof n=="string")try{return JSON.parse(n)||{}}catch(p){return console.error("Error parsing settings JSON:",p),{}}return typeof n=="object"&&n!==null?n:{}};ne(()=>C(a.inspection.settings).conclusion||{});const I=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],M=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],O=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];We(()=>{G(),et(()=>{j(),$()})});const j=()=>{r.value&&i.notes&&(r.value.innerHTML=i.notes)},G=()=>{const p=C(a.inspection.settings).conclusion||{},A=a.form.conclusion||{};i.flooded=A.flooded||p.flooded||"",i.collision=A.collision||p.collision||"",i.collision_severity=A.collision_severity||p.collision_severity||"",i.notes=A.notes||a.inspection.notes||""},K=n=>{if(!r.value)return;let p=n.content;p=p.replace(/{PLATE_NUMBER}/g,a.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,a.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,i.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,i.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),r.value.innerHTML=p,i.notes=p,v.value=!1,et(()=>{r.value.focus(),g()})},U=()=>{r.value&&(r.value.innerHTML="",i.notes="",g())},$=()=>{if(!r.value)return;const n=window.getSelection();n.rangeCount===0||n.isCollapsed||(u.bold=document.queryCommandState("bold"),u.italic=document.queryCommandState("italic"),u.underline=document.queryCommandState("underline"))},R=n=>{if(!r.value)return;r.value.focus();const p=u[n];switch(n){case"bold":document.execCommand("bold",!1,!p);break;case"italic":document.execCommand("italic",!1,!p);break;case"underline":document.execCommand("underline",!1,!p);break}setTimeout(()=>{$(),L()},10)},L=It.debounce(()=>{r.value&&(i.notes=r.value.innerHTML,g())},200),V=n=>{n.preventDefault(),document.execCommand("insertParagraph",!1,null)},B=n=>{n.preventDefault();const p=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,p)},Z=()=>{m.value=!0},pe=()=>{m.value=!1,r.value&&(i.notes=r.value.innerHTML,g())},N=()=>{g()},g=()=>{const n={flooded:i.flooded,collision:i.collision,collision_severity:i.collision==="yes"?i.collision_severity:null,notes:i.notes};w("updateConclusion",n)};return ye(()=>a.form.conclusion,n=>{n&&(i.flooded=n.flooded!==void 0?n.flooded:i.flooded,i.collision=n.collision!==void 0?n.collision:i.collision,i.collision_severity=n.collision_severity!==void 0?n.collision_severity:i.collision_severity,i.notes=n.notes!==void 0?n.notes:i.notes,r.value&&n.notes!==void 0&&r.value.innerHTML!==n.notes&&(r.value.innerHTML=n.notes))},{deep:!0,immediate:!0}),ye([()=>i.flooded,()=>i.collision,()=>i.collision_severity,()=>i.notes],()=>{g()},{deep:!0}),(n,p)=>(s(),o("div",vi,[p[21]||(p[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),e("div",fi,[p[10]||(p[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Se(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",hi,[(s(),o(Ne,null,Ee(I,A=>e("label",{key:A.value,class:"cursor-pointer"},[Fe(e("input",{type:"radio","onUpdate:modelValue":p[0]||(p[0]=z=>i.flooded=z),value:A.value,class:"hidden peer",onChange:N},null,40,bi),[[Qe,i.flooded]]),e("div",{class:J(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.flooded===A.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.flooded!==A.value}])},_(A.label),3)])),64))])]),e("div",yi,[p[12]||(p[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Se(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",xi,[(s(),o(Ne,null,Ee(M,A=>e("label",{key:A.value,class:"cursor-pointer"},[Fe(e("input",{type:"radio","onUpdate:modelValue":p[1]||(p[1]=z=>i.collision=z),value:A.value,class:"hidden peer",onChange:N},null,40,ki),[[Qe,i.collision]]),e("div",{class:J(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.collision===A.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.collision!==A.value}])},_(A.label),3)])),64))]),Te(Je,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:He(()=>[i.collision==="yes"?(s(),o("div",wi,[p[11]||(p[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Se("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ii,[(s(),o(Ne,null,Ee(O,A=>e("label",{key:A.value,class:"cursor-pointer"},[Fe(e("input",{type:"radio","onUpdate:modelValue":p[2]||(p[2]=z=>i.collision_severity=z),value:A.value,class:"hidden peer",onChange:N},null,40,$i),[[Qe,i.collision_severity]]),e("div",{class:J(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":i.collision_severity===A.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":i.collision_severity!==A.value}])},_(A.label),3)])),64))])])):l("",!0)]),_:1})]),e("div",Si,[e("div",Ci,[p[14]||(p[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),e("button",{type:"button",onClick:p[3]||(p[3]=A=>v.value=!v.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},p[13]||(p[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),Se(" Template ")]))]),Te(Je,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:He(()=>[v.value?(s(),o("div",Ai,[e("div",_i,[p[16]||(p[16]=e("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),e("button",{onClick:p[4]||(p[4]=A=>v.value=!1),class:"text-gray-400 hover:text-gray-600"},p[15]||(p[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Ti,[(s(!0),o(Ne,null,Ee(x.value,A=>(s(),o("button",{key:A.id,onClick:z=>K(A),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[e("div",Ei,_(A.name),1),e("div",Vi,_(A.description),1)],8,Ni))),128))])])):l("",!0)]),_:1}),e("div",Ui,[e("button",{type:"button",onClick:p[5]||(p[5]=A=>R("bold")),class:J(["p-2 rounded transition-all duration-150 ease-in-out font-medium",u.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},p[17]||(p[17]=[e("strong",null,"B",-1)]),2),e("button",{type:"button",onClick:p[6]||(p[6]=A=>R("italic")),class:J(["p-2 rounded transition-all duration-150 ease-in-out font-medium",u.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},p[18]||(p[18]=[e("em",null,"I",-1)]),2),e("button",{type:"button",onClick:p[7]||(p[7]=A=>R("underline")),class:J(["p-2 rounded transition-all duration-150 ease-in-out font-medium",u.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},p[19]||(p[19]=[e("u",null,"U",-1)]),2),e("button",{type:"button",onClick:p[8]||(p[8]=A=>U()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," 🗑️ Clear ")]),Te(Je,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:He(()=>[Object.values(u).some(A=>A)?(s(),o("div",Mi,[p[20]||(p[20]=Se(" Format aktif: ")),u.bold?(s(),o("span",Di,"Bold")):l("",!0),u.italic?(s(),o("span",Pi,"Italic")):l("",!0),u.underline?(s(),o("span",Ri,"Underline")):l("",!0)])):l("",!0)]),_:1}),e("div",{ref_key:"editorRef",ref:r,contenteditable:"true",class:J(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!m.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":m.value}]),onInput:p[9]||(p[9]=(...A)=>ze(L)&&ze(L)(...A)),onBlur:pe,onFocus:Z,onKeydown:Dt(V,["enter"]),onPaste:B,onMouseup:$,onKeyup:$,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},zi=Ke(Li,[["__scopeId","data-v-e09db1bd"]]);export{Ws as B,Ki as C,Hi as V,Tt as _,zi as a};
