import{x as Nt,r as $,g as Pe,q as ne,E as Re,G as ve,c as o,o as s,d as e,b as l,k as ke,z as Ce,A as Me,n as ee,t as V,u as Ee,e as Et,F as Ie,m as $e,f as we,y as De,w as Te,N as Ue,D as Fe,L as kt,a as Be,j as Se,l as xt,T as Le,M as Vt,p as Ut,O as wt,J as je,B as Mt}from"./vendor-g77w9U1W.js";import{l as It}from"./lodash-CGXsUT3p.js";import{_ as Pt}from"./PrimaryButton-CrKKsBb9.js";import{_ as Dt}from"./ActionMessage-C9w22vKV.js";import{_ as Ne}from"./app-DD8bj5x1.js";const Lt={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Rt={key:0,class:"p-4 space-y-2"},Bt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},jt={class:"flex items-center space-x-2"},Ft={key:0,class:"text-xs text-red-500 font-normal ml-2"},Ot={key:1,class:"text-xs text-red-500 font-normal ml-2"},qt={key:2,class:"text-xs text-green-500 font-normal ml-2"},Kt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ht={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Gt={class:"col-span-2 flex space-x-3"},zt={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Wt={class:"flex items-start"},Jt={class:"text-sm text-blue-700"},Zt={class:"mt-1"},Yt={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Xt={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},Qt={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},ea={key:3,class:"text-blue-600"},ta={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},aa={class:"relative"},na={key:0,class:"absolute right-3 top-3"},sa={key:1,class:"text-xs text-red-500 font-normal ml-2"},oa={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ia={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},la={key:0},ra=["onMousedown"],da={class:"font-medium text-gray-900"},ua={class:"text-sm text-gray-500"},ca={key:1,class:"p-4 text-sm text-gray-500 text-center"},pa={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ma={key:0,class:"mb-4"},ga=["innerHTML"],va={key:1},fa={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ha=["onClick"],ba=["src","alt"],ya={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},xa={class:"text-white text-xs text-center"},wa={key:2,class:"text-center py-4 text-gray-500 text-sm"},ka={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},Ia=["src","alt"],$a={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Sa={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},_a={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Aa={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(t,{emit:Z}){var Y,ae,te,re,fe,ye;const a=t,b=Z,r=Nt({plate_number:((Y=a.inspection)==null?void 0:Y.plate_number)||"",car_id:((ae=a.inspection)==null?void 0:ae.car_id)||null,car_name:((te=a.inspection)==null?void 0:te.car_name)||""}),m=$(((re=a.inspection)==null?void 0:re.plate_number)||""),v=$(((fe=a.inspection)==null?void 0:fe.car_id)||null),u=$(((ye=a.inspection)==null?void 0:ye.car_name)||""),i=$(""),y=$(""),_=$(""),w=$(null),P=$({rear_door:!1}),O=$(!1),R=$(""),G=$(""),K=$(r.car_name),M=$(!1),k=$(!1),z=$([]),q=$(null),N=$([]),j=$(!1),W=$(0);Pe(()=>{var I,g,Q,B,oe;if(E((I=a.inspection)==null?void 0:I.plate_number),(g=a.inspection)!=null&&g.car_id&&((Q=a.CarDetail)==null?void 0:Q.length)>0){const he=a.CarDetail.find(xe=>xe.id===a.inspection.car_id);he&&d(he)}else!((B=a.inspection)!=null&&B.car_id)&&((oe=a.inspection)!=null&&oe.car_name)&&(K.value=a.inspection.car_name,r.car_id=null);window.addEventListener("keydown",S),ce(),b("update:hasUnsavedChanges",se.value),b("update:validation",le.value)}),Re(()=>{window.removeEventListener("keydown",S)});const ce=()=>{try{const I=localStorage.getItem("vehicle_features");if(I){const g=JSON.parse(I);P.value.rear_door=g.rear_door||!1,g.pick_up?w.value="pick_up":g.box?w.value="box":w.value=null}else P.value.rear_door=!1,w.value=null;c()}catch(I){console.error("Error loading vehicle type from localStorage:",I),P.value.rear_door=!1,w.value=null,c()}},A=()=>{P.value.rear_door=!P.value.rear_door,n()},p=I=>{w.value===I?w.value=null:w.value=I,n()},n=()=>{try{const I={rear_door:P.value.rear_door,pick_up:w.value==="pick_up",box:w.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(I)),c(),console.log("Vehicle features saved to localStorage:",I)}catch(I){console.error("Error saving vehicle type to localStorage:",I)}},c=()=>{const I={rear_door:P.value.rear_door,pick_up:w.value==="pick_up",box:w.value==="box"};b("update:vehicle-type",I)},E=I=>{if(!I){i.value="",y.value="",_.value="";return}const g=I.toUpperCase().trim(),Q=g.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(Q)i.value=Q[1]||"",y.value=Q[2]||"",_.value=Q[3]||"";else{let B="area",oe="",he="",xe="";for(const ge of g)B==="area"&&/[A-Z]/.test(ge)?oe+=ge:B==="area"&&/[0-9]/.test(ge)?(B="number",he+=ge):B==="number"&&/[0-9]/.test(ge)?he+=ge:B==="number"&&/[A-Z]/.test(ge)?(B="suffix",xe+=ge):B==="suffix"&&/[A-Z]/.test(ge)&&(xe+=ge);i.value=oe,y.value=he,_.value=xe}X()},X=()=>{const I=`${i.value}${y.value}${_.value}`;r.plate_number=I,U()},pe=I=>{I==="area"?i.value=i.value.toUpperCase().replace(/[^A-Z]/g,""):I==="number"?y.value=y.value.replace(/[^0-9]/g,""):I==="suffix"&&(_.value=_.value.toUpperCase().replace(/[^A-Z]/g,"")),X()},de=ne(()=>{const I=r.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(I)}),ie=ne(()=>!K.value||K.value.trim()===""),be=ne(()=>r.plate_number.length>0&&!de.value?"Format plat nomor tidak valid.":null),le=ne(()=>{const I=!r.plate_number||r.plate_number.trim()==="",g=!K.value||K.value.trim()==="";return I||g||!de.value||O.value}),se=ne(()=>{const I=r.plate_number!==m.value,g=r.car_id!==v.value||K.value!==u.value;return I||g}),me=ne(()=>se.value&&!le.value),ue=I=>{var Q,B,oe;if(!I)return"";const g=[];return(Q=I.brand)!=null&&Q.name&&g.push(I.brand.name),(B=I.model)!=null&&B.name&&g.push(I.model.name),(oe=I.type)!=null&&oe.name&&g.push(I.type.name),I.cc&&g.push((I.cc/1e3).toFixed(1)),I.transmission&&g.push(I.transmission),I.year&&g.push(I.year.toString()),I.fuel_type&&g.push(I.fuel_type),I.production_period&&g.push(`(${I.production_period})`),g.join(" ")},H=()=>{r.car_id&&(r.car_id=null,q.value=null,N.value=[]),Ae()},Ae=It.debounce(()=>{if(!K.value.trim()){z.value=[],M.value=!1;return}k.value=!0;try{const I=K.value.toLowerCase().trim();z.value=a.CarDetail.filter(g=>ue(g).toLowerCase().includes(I)),M.value=!0}finally{k.value=!1}},300),_e=()=>{setTimeout(()=>{M.value=!1,r.car_name=K.value,U()},200)},d=async I=>{q.value=I,K.value=ue(I),r.car_id=I.id,r.car_name=ue(I),M.value=!1,await f(I.id),U(),b("update:hasUnsavedChanges",se.value),b("update:validation",le.value)},C=I=>!I||!I.file_path?"":`/storage/${I.file_path}`,f=async I=>{try{const g=await fetch(`/api/cars/${I}/images`);if(g.ok){const Q=await g.json();N.value=Array.isArray(Q)?Q:[]}else N.value=[]}catch(g){console.error("Error loading car images:",g),N.value=[]}},T=I=>{W.value=I,j.value=!0,document.body.style.overflow="hidden"},D=()=>{j.value=!1,document.body.style.overflow=""},J=()=>{W.value=(W.value+1)%N.value.length},x=()=>{W.value=(W.value-1+N.value.length)%N.value.length},S=I=>{if(j.value)switch(I.key){case"Escape":D();break;case"ArrowRight":J();break;case"ArrowLeft":x();break}},U=()=>{const I={plate_number:r.plate_number,car_id:r.car_id,car_name:r.car_name};b("update-vehicle",I)},F=()=>{a.inspection&&r.post(route("inspections.updateVehicleDetails",{inspection:a.inspection.id}),{preserveScroll:!0,onSuccess:()=>{m.value=r.plate_number,v.value=r.car_id,u.value=r.car_name,b("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:I=>{console.error("Gagal menyimpan data:",I)}})};return ve([()=>r.plate_number,()=>r.car_name],I=>{R.value="",O.value=!1,G.value="";const g=I[0];if(g&&g.length>=6){const Q=a.allInspections.filter(B=>{var oe;return B.plate_number===g&&B.id!==((oe=a.inspection)==null?void 0:oe.id)});if(Q.length>0){const B=["draft","in_progress","pending","pending_review","revision"],oe=Q.find(he=>B.includes(he.status));if(oe)O.value=!0,R.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${oe.status.replace(/_/g," ").toUpperCase()}.`;else{const he=Q.filter(xe=>["approved","rejected","completed","cancelled"].includes(xe.status));if(he.length>0){he.sort((ge,Ve)=>new Date(Ve.created_at)-new Date(ge.created_at));const xe=he[0];if(xe.car_id){const ge=a.CarDetail.find(Ve=>Ve.id===xe.car_id);ge&&d(ge)}else xe.car_name&&(K.value=xe.car_name,r.car_name=xe.car_name,r.car_id=null);G.value=`Nomor plat ini sudah pernah diperiksa ${he.length} kali sebelumnya.`}}}}b("update:hasUnsavedChanges",se.value),b("update:validation",le.value)},{deep:!0}),ve([()=>P.value.rear_door,()=>w.value],()=>{n()}),(I,g)=>{var Q;return s(),o("div",Lt,[g[27]||(g[27]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),t.inspection?(s(),o("div",Rt,[e("div",Bt,[g[11]||(g[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",jt,[Ce(e("input",{"onUpdate:modelValue":g[0]||(g[0]=B=>i.value=B),type:"text",placeholder:"Contoh: B",class:ee(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!de.value||O.value}]),onInput:g[1]||(g[1]=B=>pe("area")),maxlength:"2"},null,34),[[Me,i.value]]),Ce(e("input",{"onUpdate:modelValue":g[2]||(g[2]=B=>y.value=B),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:ee(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!de.value||O.value}]),onInput:g[3]||(g[3]=B=>pe("number")),maxlength:"4"},null,34),[[Me,y.value]]),Ce(e("input",{"onUpdate:modelValue":g[4]||(g[4]=B=>_.value=B),type:"text",placeholder:"ABC",class:ee(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!de.value||O.value}]),onInput:g[5]||(g[5]=B=>pe("suffix")),maxlength:"3"},null,34),[[Me,_.value]])]),be.value?(s(),o("span",Ft,V(be.value),1)):l("",!0),R.value?(s(),o("span",Ot,V(R.value),1)):l("",!0),G.value?(s(),o("span",qt,V(G.value),1)):l("",!0)]),e("div",Kt,[g[15]||(g[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),e("div",Ht,[e("div",{class:ee(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":P.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!P.value.rear_door}]),onClick:A},g[12]||(g[12]=[e("span",null,"Pintu Belakang",-1)]),2),e("div",Gt,[e("div",{class:ee(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":w.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":w.value!=="pick_up"}]),onClick:g[6]||(g[6]=B=>p("pick_up"))}," Pick Up ",2),e("div",{class:ee(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":w.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":w.value!=="box"}]),onClick:g[7]||(g[7]=B=>p("box"))}," Box ",2)])]),e("div",zt,[e("div",Wt,[g[14]||(g[14]=e("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",Jt,[g[13]||(g[13]=e("p",{class:"font-medium"},"Status Kendaraan:",-1)),e("p",Zt,[P.value.rear_door?(s(),o("span",Yt," ✓ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):l("",!0),w.value==="pick_up"?(s(),o("span",Xt," ✓ Pick Up ")):l("",!0),w.value==="box"?(s(),o("span",Qt," ✓ Box ")):l("",!0),!P.value.rear_door&&!w.value?(s(),o("span",ea," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):l("",!0)])])])])]),e("div",ta,[g[19]||(g[19]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",aa,[Ce(e("input",{"onUpdate:modelValue":g[8]||(g[8]=B=>K.value=B),type:"text",placeholder:"Cari atau ketik nama mobil...",class:ee(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ie.value}]),onInput:H,onFocus:g[9]||(g[9]=B=>M.value=!0),onBlur:_e},null,34),[[Me,K.value]]),k.value?(s(),o("div",na,g[16]||(g[16]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):l("",!0),ie.value?(s(),o("span",sa,"Nama mobil tidak boleh kosong.")):l("",!0),!Ee(r).car_id&&K.value?(s(),o("div",oa,g[17]||(g[17]=[Et('<div class="flex items-start" data-v-93565d5f><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-93565d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-93565d5f></path></svg><div data-v-93565d5f><p class="text-yellow-800 font-medium mb-1" data-v-93565d5f>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-93565d5f>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-93565d5f> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-93565d5f>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-93565d5f>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):l("",!0),M.value?(s(),o("div",ia,[z.value.length>0?(s(),o("div",la,[(s(!0),o(Ie,null,$e(z.value,B=>(s(),o("div",{key:B.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:oe=>d(B)},[e("div",da,V(ue(B)),1),e("div",ua,V(B.year)+" • "+V(B.cc)+"cc • "+V(B.transmission)+" • "+V(B.fuel_type),1)],40,ra))),128))])):(s(),o("div",ca,g[18]||(g[18]=[we(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),we(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):l("",!0)])]),Ee(r).car_id&&q.value?(s(),o("div",pa,[q.value.description?(s(),o("div",ma,[g[20]||(g[20]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:q.value.description},null,8,ga)])):l("",!0),N.value.length>0?(s(),o("div",va,[g[21]||(g[21]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",fa,[(s(!0),o(Ie,null,$e(N.value,(B,oe)=>(s(),o("div",{key:B.id||oe,class:"relative group cursor-pointer",onClick:he=>T(oe)},[e("img",{src:C(B),alt:B.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ba),B.note?(s(),o("div",ya,[e("p",xa,V(B.note),1)])):l("",!0)],8,ha))),128))])])):(s(),o("div",wa," Tidak ada gambar tersedia untuk mobil ini "))])):l("",!0),j.value?(s(),o("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:D},[e("div",ka,[e("button",{onClick:D,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},g[22]||(g[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),N.value.length>1?(s(),o("button",{key:0,onClick:De(x,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},g[23]||(g[23]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):l("",!0),N.value.length>1?(s(),o("button",{key:1,onClick:De(J,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},g[24]||(g[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):l("",!0),e("img",{src:C(N.value[W.value]),alt:"Car Image "+(W.value+1),class:"max-w-full max-h-full object-contain",onClick:g[10]||(g[10]=De(()=>{},["stop"]))},null,8,Ia),N.value.length>1?(s(),o("div",$a,V(W.value+1)+" / "+V(N.value.length),1)):l("",!0),(Q=N.value[W.value])!=null&&Q.note?(s(),o("div",Sa,V(N.value[W.value].note),1)):l("",!0)])])):l("",!0),ke(Pt,{type:"button",onClick:F,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!me.value},{default:Te(()=>[Ee(r).processing?(s(),o("svg",_a,g[25]||(g[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):l("",!0),e("span",null,V(Ee(r).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),ke(Dt,{on:Ee(r).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Te(()=>g[26]||(g[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),we(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):l("",!0)])}}},Di=Ne(Aa,[["__scopeId","data-v-93565d5f"]]),Ca={class:"mt-1"},Ta=["value","required","minlength","maxlength","allowSpace","placeholder"],Na={key:0,class:"mt-2 text-sm text-red-600"},$t={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,b=Z,r=ne(()=>{if(!a.modelValue)return"";let v=a.modelValue;switch(a.allowSpace||(v=v.replace(/\s+/g,"")),a.textTransform){case"uppercase":return v.toUpperCase();case"lowercase":return v.toLowerCase();case"capitalize":return v.replace(/\b\w/g,u=>u.toUpperCase());default:return v}}),m=v=>{let u=v.target.value;switch(a.allowSpace||(u=u.replace(/\s+/g,"")),a.textTransform){case"uppercase":u=u.toUpperCase();break;case"lowercase":u=u.toLowerCase();break;case"capitalize":u=u.replace(/\b\w/g,i=>i.toUpperCase());break}b("update:modelValue",u),b("save",a.pointId)};return(v,u)=>(s(),o("div",Ca,[e("input",{value:r.value,onInput:m,type:"text",required:t.required,minlength:t.minLength,maxlength:t.maxLength,allowSpace:t.allowSpace,placeholder:t.placeholder,class:ee(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:t.textTransform==="uppercase",lowercase:t.textTransform==="lowercase",capitalize:t.textTransform==="capitalize"}])},null,42,Ta),t.error?(s(),o("p",Na,V(t.error),1)):l("",!0)]))}},Ea={class:"mt-1"},Va=["value","required","min","max","step","placeholder"],Ua={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputNumber",props:{modelValue:[String,Number],required:Boolean,min:[String,Number],max:[String,Number],step:[String,Number],placeholder:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,b=Z,r=m=>{const v=m.target.value;b("update:modelValue",v),b("save",a.pointId)};return(m,v)=>(s(),o("div",Ea,[e("input",{value:t.modelValue,onInput:r,type:"number",required:t.required,min:t.min,max:t.max,step:t.step,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Va),t.error?(s(),o("p",Ua,V(t.error),1)):l("",!0)]))}},Ma={class:"mt-1"},Pa=["value","required","min","max"],Da={key:0,class:"mt-2 text-sm text-red-600"},_t={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,b=Z,r=m=>{b("update:modelValue",m.target.value),b("save",a.pointId)};return(m,v)=>(s(),o("div",Ma,[e("input",{value:t.modelValue,onChange:r,type:"date",required:t.required,min:t.minDate,max:t.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Pa),t.error?(s(),o("p",Da,V(t.error),1)):l("",!0)]))}},La={class:"mt-1"},Ra=["value","required","placeholder"],Ba={key:0,class:"mt-2 text-sm text-red-600"},At={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,b=Z,r=$(""),m=ne(()=>{var _,w,P,O;return{currency_symbol:((_=a.settings)==null?void 0:_.currency_symbol)||"Rp",thousands_separator:((w=a.settings)==null?void 0:w.thousands_separator)||",",min_value:((P=a.settings)==null?void 0:P.min_value)!==void 0?Number(a.settings.min_value):0,max_value:((O=a.settings)==null?void 0:O.max_value)!==void 0?Number(a.settings.max_value):1e9}}),v=_=>{if(_==null||_==="")return"";const w=Number(_);if(isNaN(w))return"";let P=w.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return m.value.thousands_separator!==","&&(P=P.replace(/,/g,m.value.thousands_separator)),P},u=_=>_?_.replace(/[^\d]/g,""):"",i=ne(()=>r.value?`${m.value.currency_symbol} ${v(r.value)}`:""),y=_=>{let w=u(_.target.value),P=Number(w);m.value.min_value!==void 0&&P<m.value.min_value&&(w=m.value.min_value.toString()),m.value.max_value!==void 0&&P>m.value.max_value&&(w=m.value.max_value.toString()),r.value=w,b("update:modelValue",w),b("save",a.pointId)};return ve(()=>a.modelValue,_=>{_!=null&&(r.value=_.toString())},{immediate:!0}),(_,w)=>(s(),o("div",La,[e("input",{value:i.value,onInput:y,type:"text",required:t.required,placeholder:t.placeholder,class:ee(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",t.error?"border-red-300":"border-gray-300"])},null,42,Ra),t.error?(s(),o("p",Ba,V(t.error),1)):l("",!0)]))}},ja={class:"mt-1 space-y-3"},Fa={key:0,class:"space-y-2"},Oa={class:"flex flex-wrap gap-2"},qa=["onClick"],Ka=["value","required","minlength","maxlength","placeholder"],Ha={class:"flex justify-between items-center mt-1"},Ga={class:"text-xs text-gray-500"},za={key:0,class:"text-xs text-red-600"},Ct={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,b=Z,r=$([]),m=$(""),v=_=>r.value.some(w=>w.value===_),u=_=>{v(_.value)?r.value=r.value.filter(R=>R.value!==_.value):r.value.push(_);const P=[...r.value.map(R=>R.value)];m.value.trim()&&P.push(m.value.trim());const O=P.join(", ");b("update:modelValue",O),b("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:O})},i=_=>{const w=_.target.value;b("update:modelValue",w),b("save",{pointId:a.pointId,inspectionId:a.inspectionId,notes:w}),y(w)},y=_=>{var R,G,K,M;if(!_){r.value=[],m.value="";return}const w=_.split(",").map(k=>k.trim()).filter(k=>k),P=((G=(R=a.settings)==null?void 0:R.damage_options)==null?void 0:G.map(k=>k.value))||[];r.value=((M=(K=a.settings)==null?void 0:K.damage_options)==null?void 0:M.filter(k=>w.includes(k.value)))||[];const O=w.filter(k=>!P.includes(k));m.value=O.join(", ")};return ve(()=>a.modelValue,_=>{_!=null&&y(_)},{immediate:!0}),(_,w)=>{var P,O,R;return s(),o("div",ja,[(P=t.settings)!=null&&P.enable_damage&&((O=t.settings)!=null&&O.damage_options)?(s(),o("div",Fa,[w[0]||(w[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",Oa,[(s(!0),o(Ie,null,$e(t.settings.damage_options,(G,K)=>(s(),o("button",{key:K,type:"button",onClick:M=>u(G),class:ee(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":v(G.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!v(G.value)}])},V(G.label),11,qa))),128))])])):l("",!0),e("div",null,[e("textarea",{value:t.modelValue,onInput:i,required:t.required,minlength:t.minLength,maxlength:t.maxLength,placeholder:t.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ka),e("div",Ha,[e("span",Ga,V(((R=t.modelValue)==null?void 0:R.length)||0)+"/"+V(t.maxLength||400),1),t.error?(s(),o("p",za,V(t.error),1)):l("",!0)])])])}}},Wa={class:"mt-1"},Ja=["value","required"],Za={key:0,class:"mt-2 text-sm text-red-600"},Ya={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(t,{emit:Z}){const a=t,b=Z,r=m=>{b("update:modelValue",m.target.value),b("save",a.pointId)};return(m,v)=>(s(),o("div",Wa,[e("select",{value:t.modelValue,onChange:r,required:t.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},v[0]||(v[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Ja),t.error?(s(),o("p",Za,V(t.error),1)):l("",!0)]))}},Xa=Ne(Ya,[["__scopeId","data-v-1b6c0201"]]),Qa={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},en={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},tn={class:"text-xs text-gray-500 mt-2 text-center"},an={class:"flex flex-row space-x-4 mb-6"},nn={class:"mt-4 text-right"},sn={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(t){return(Z,a)=>t.show?(s(),o("div",Qa,[e("div",en,[a[7]||(a[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",tn,[a[3]||(a[3]=we("Ambil Foto Maksimal: ")),e("b",null,V(t.settings.max_files),1),a[4]||(a[4]=we(" Dengan Rasio & Ukuran: ")),e("b",null,V(t.settings.camera_aspect_ratio),1)]),e("div",an,[e("button",{onClick:a[0]||(a[0]=b=>Z.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[5]||(a[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Kamera",-1)])),e("button",{onClick:a[1]||(a[1]=b=>Z.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},a[6]||(a[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",nn,[e("button",{onClick:a[2]||(a[2]=b=>Z.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):l("",!0)}},on={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ln={class:"w-full h-full flex flex-col"},rn={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},dn=["disabled"],un={class:"text-lg font-semibold"},cn={class:"flex items-center gap-2"},pn=["disabled"],mn=["disabled"],gn={key:0,class:"bg-blue-900 bg-opacity-50 text-white p-3"},vn={class:"flex items-center justify-between mb-2"},fn={class:"text-xs"},hn={class:"w-full bg-blue-700 bg-opacity-50 rounded-full h-2"},bn={class:"text-xs mt-1 text-blue-300"},yn={class:"flex-1 flex items-center justify-center overflow-hidden relative"},xn=["src"],wn={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},kn={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},In=["disabled"],$n=["disabled"],Sn=["disabled"],_n={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},An={class:"flex justify-between items-center w-full"},Cn=["disabled"],Tn={key:1,class:"flex-1"},Nn=["disabled"],En={class:"flex gap-3 w-full"},Vn={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},Un={class:"flex items-center gap-2"},Mn={key:0,class:"text-center"},Pn={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(t,{emit:Z}){const a=t,b=Z,r=$(0),m=$([]),v=ne(()=>m.value.length>0?m.value[r.value]:null);ve(()=>a.images,M=>{m.value=M.map(k=>({...k,rotation:k.rotation||0})),M.length===0&&a.show&&P()},{deep:!0,immediate:!0}),ve(()=>a.show,M=>{M&&a.images.length>0&&(r.value=a.initialIndex)}),ve(()=>a.uploadProgress,M=>{M===100&&console.log("Upload completed")});const u=M=>M.preview||(M.image_path?`/${M.image_path}`:""),i=()=>{if(v.value&&!a.isUploading){const M=(v.value.rotation+90)%360;m.value[r.value].rotation=M,b("update:images",m.value)}},y=()=>{a.isUploading||(r.value=r.value<m.value.length-1?r.value+1:0)},_=()=>{a.isUploading||(r.value=r.value>0?r.value-1:m.value.length-1)},w=()=>{a.isUploading||b("saveImages",m.value)},P=()=>{a.isUploading||b("close")},O=()=>{if(v.value&&!a.isUploading){const M=v.value,k=m.value.findIndex(z=>z.isNew&&M.isNew&&z.preview===M.preview||!z.isNew&&!M.isNew&&z.id===M.id);k!==-1&&(b("removePreviewImage",M),m.value.splice(k,1),b("update:images",m.value)),r.value>=m.value.length&&(r.value=Math.max(0,m.value.length-1)),m.value.length===0&&b("close")}},R=()=>{a.isUploading||b("triggerAddMorePhotos")},G=()=>{v.value&&!a.isUploading&&b("retryImage",v.value)},K=M=>{M.key==="Escape"&&!a.isUploading&&P()};return Pe(()=>{document.addEventListener("keydown",K)}),Re(()=>{document.removeEventListener("keydown",K)}),(M,k)=>{var z;return t.show?(s(),o("div",on,[e("div",ln,[e("div",rn,[e("button",{onClick:P,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},k[0]||(k[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,dn),e("div",un,V(((z=t.point)==null?void 0:z.name)||"Preview")+" ("+V(r.value+1)+"/"+V(m.value.length)+") ",1),e("div",cn,[v.value&&v.value.isNew?(s(),o("button",{key:0,onClick:O,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:t.isUploading},k[1]||(k[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,pn)):l("",!0),v.value&&v.value.isNew?(s(),o("button",{key:1,onClick:i,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:t.isUploading},k[2]||(k[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]),8,mn)):l("",!0)])]),t.isUploading?(s(),o("div",gn,[e("div",vn,[k[3]||(k[3]=e("span",{class:"text-sm font-medium"},"Mengupload gambar...",-1)),e("span",fn,V(t.uploadProgress)+"%",1)]),e("div",hn,[e("div",{class:"bg-blue-400 h-2 rounded-full transition-all duration-300",style:Ue({width:t.uploadProgress+"%"})},null,4)]),e("p",bn,V(t.currentUpload)+"/"+V(t.totalUpload)+" gambar terupload",1)])):l("",!0),e("div",yn,[e("div",{class:"relative w-full max-w-full",style:Ue({paddingTop:t.aspectRatio?100/t.aspectRatio+"%":"75%"})},[v.value?(s(),o("img",{key:0,src:u(v.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:Ue({transform:`rotate(${v.value.rotation}deg)`})},null,12,xn)):l("",!0),v.value&&v.value.isUploading?(s(),o("div",wn,k[4]||(k[4]=[e("div",{class:"text-center text-white"},[e("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e("p",{class:"text-sm"},"Mengupload...")],-1)]))):l("",!0),v.value&&v.value.isFailed?(s(),o("div",kn,[k[5]||(k[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),k[6]||(k[6]=e("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),e("button",{onClick:G,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:t.isUploading}," Coba Lagi ",8,In)])):l("",!0)],4),m.value.length>1&&!t.isUploading?(s(),o("button",{key:0,onClick:_,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},k[7]||(k[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,$n)):l("",!0),m.value.length>1&&!t.isUploading?(s(),o("button",{key:1,onClick:y,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:t.isUploading},k[8]||(k[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Sn)):l("",!0)]),e("div",_n,[e("div",An,[v.value&&!v.value.isNew?(s(),o("button",{key:0,onClick:O,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:t.isUploading},k[9]||(k[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),we(" Hapus Foto ")]),8,Cn)):(s(),o("div",Tn)),t.allowMultiple&&m.value.length<t.maxFiles&&!t.isUploading?(s(),o("button",{key:2,onClick:R,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:t.isUploading},k[10]||(k[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),we(" Tambah Foto ")]),8,Nn)):l("",!0)]),e("div",En,[t.isUploading?(s(),o("button",Vn,[e("div",Un,[k[11]||(k[11]=e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),e("span",null,"Mengupload... "+V(t.uploadProgress)+"%",1)])])):(s(),o("button",{key:0,onClick:w,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),t.isUploading?(s(),o("div",Mn,k[12]||(k[12]=[e("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):l("",!0)])])])):l("",!0)}}},Dn=Ne(Pn,[["__scopeId","data-v-581782f4"]]),Ln={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},Rn={class:"webcam-content-box"},Bn={class:"webcam-header"},jn={class:"inspection-point-name"},Fn={key:0,class:"manual-controls-overlay"},On={class:"manual-controls-panel"},qn={class:"control-group"},Kn={class:"slider-container"},Hn={class:"slider-value"},Gn=["min","max"],zn={class:"orientation-icon"},Wn={key:2,class:"loading-overlay"},Jn={key:3,class:"error-overlay"},Zn={class:"error-content"},Yn={class:"error-message"},Xn={class:"webcam-footer"},Qn={class:"camera-controls"},es=["disabled"],ts={class:"camera-icon-container"},as={key:0,class:"camera-spinner"},ns={key:1,class:"camera-shutter"},ss=["disabled"],os={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(t,{emit:Z}){const a=t,b=Z,r=$(null),m=$(null);let v=null,u=null;const i=$("environment"),y=$(null),_=$([]),w=$(!1),P=$(!1),O=$(!1),R=$(!1),G=$(!1),K=$(null),M=$(!1),k=$(!1),z=$({}),q=$("continuous"),N=$(0),j=$(-3),W=$(3),ce=$(!1),A=$("portrait"),p=$("portrait"),n=ne(()=>{var x;return((x=a.settings)==null?void 0:x.max_size)||2048}),c=ne(()=>A.value==="portrait"||p.value==="portrait"),E=ne(()=>a.aspectRatio?{aspectRatio:`${c.value?a.aspectRatio:1/a.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),X=ne(()=>({"orientation-portrait":c.value,"orientation-landscape":!c.value})),pe=ne(()=>c.value?"📱":"🔄"),de=()=>{const x=()=>{p.value=window.screen.orientation.type.includes("portrait")?"portrait":"landscape"},S=U=>{if(U.gamma!==null&&U.beta!==null){const F=Math.abs(U.gamma);Math.abs(U.beta)>45||F<45?A.value="portrait":A.value="landscape"}};return window.addEventListener("orientationchange",x),window.addEventListener("resize",x),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",S),x(),()=>{window.removeEventListener("orientationchange",x),window.removeEventListener("resize",x),window.removeEventListener("deviceorientation",S)}},ie=async()=>{v&&v.getTracks().forEach(x=>x.stop()),G.value=!0,K.value=null;try{await be();const x={deviceId:y.value?{exact:y.value}:void 0,facingMode:y.value?void 0:{ideal:i.value},width:{ideal:1920},height:{ideal:1080},aspectRatio:{ideal:a.aspectRatio||4/3},frameRate:{ideal:60}};v=await navigator.mediaDevices.getUserMedia({video:x,audio:!1}),u=v.getVideoTracks()[0],r.value.srcObject=v,await new Promise(S=>{r.value.readyState>=2?S():(r.value.onloadeddata=S,setTimeout(S,500))}),await r.value.play(),await se()}catch(x){console.error("Error accessing camera: ",x),K.value=le(x)}finally{G.value=!1}},be=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(U=>U.stop());const S=await navigator.mediaDevices.enumerateDevices();if(_.value=S.filter(U=>U.kind==="videoinput"),w.value=_.value.length>1,!y.value&&_.value.length>0){const U=_.value.find(F=>F.label.toLowerCase().includes("back")||F.label.toLowerCase().includes("rear")||F.label.toLowerCase().includes("environment"));y.value=U?U.deviceId:_.value[0].deviceId}}catch(x){console.error("Error getting camera devices:",x)}},le=x=>{switch(x.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan.";case"NotSupportedError":return"Browser tidak mendukung akses kamera.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain.";default:return`Tidak dapat mengakses kamera: ${x.message}`}},se=async()=>{if(u)try{const x=u.getCapabilities();P.value=!!x.torch,ce.value=!!x.exposureCompensation,x.exposureCompensation&&(j.value=x.exposureCompensation.min||-3,W.value=x.exposureCompensation.max||3)}catch(x){console.error("Error checking camera capabilities:",x)}},me=async x=>{if(!u)return;const S=r.value.getBoundingClientRect(),U=x.clientX-S.left,F=x.clientY-S.top;k.value=!0,z.value={left:`${U}px`,top:`${F}px`,transform:"translate(-50%, -50%)"};try{if(u.getCapabilities().pointsOfInterest){const ae=Math.max(0,Math.min(1,U/S.width)),te=Math.max(0,Math.min(1,F/S.height));await u.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:ae,y:te}]}]}),console.log(`Focus set to: ${ae.toFixed(2)}, ${te.toFixed(2)}`)}M.value=!0,q.value="manual"}catch(Y){console.warn("Manual focus failed, using continuous:",Y),q.value="continuous"}setTimeout(()=>{k.value=!1},2e3)},ue=async x=>{if(!(!u||!ce.value)){N.value=Math.max(j.value,Math.min(W.value,x));try{await u.applyConstraints({advanced:[{exposureCompensation:N.value}]})}catch(S){console.error("Failed to set exposure compensation:",S)}}},H=async()=>{if(u)try{await u.applyConstraints({advanced:[{focusMode:"continuous"},{exposureMode:"continuous"}]}),N.value=0,q.value="continuous",M.value=!1}catch(x){console.warn("Failed to reset to auto mode:",x)}},Ae=()=>{M.value=!1},_e=async()=>{if(!(!u||!P.value))try{i.value==="user"||await u.applyConstraints({advanced:[{torch:!O.value}]}),O.value=!O.value}catch(x){console.error("Flash toggle failed:",x)}},d=async()=>{if(!w.value||G.value)return;G.value=!0,v&&v.getTracks().forEach(F=>F.stop());const S=(_.value.findIndex(F=>F.deviceId===y.value)+1)%_.value.length;y.value=_.value[S].deviceId;const U=_.value[S];i.value=U.label.toLowerCase().includes("front")?"user":"environment",await ie()},C=async()=>{var x,S;if(!(R.value||!r.value||!m.value)){R.value=!0;try{const U=r.value,F=m.value,Y=U.videoWidth,ae=U.videoHeight;let te,re,fe,ye;if(c.value)Y/ae>a.aspectRatio?(re=ae,te=ae*a.aspectRatio,fe=(Y-te)/2,ye=0):(te=Y,re=Y/a.aspectRatio,fe=0,ye=(ae-re)/2);else{const Q=1/a.aspectRatio;Y/ae>Q?(re=ae,te=ae*Q,fe=(Y-te)/2,ye=0):(te=Y,re=Y/Q,fe=0,ye=(ae-re)/2)}F.width=te,F.height=re,F.getContext("2d").drawImage(U,fe,ye,te,re,0,0,te,re);const g=await new Promise(Q=>{F.toBlob(Q,"image/jpeg",.85)});if(g&&g.size<=n.value*1024){const Q=`inspeksi_${((x=a.point)==null?void 0:x.name)||"foto"}_${Date.now()}.jpg`,B=new File([g],Q,{type:"image/jpeg",lastModified:Date.now()});b("photoCaptured",B)}else if(g){const Q=await f(g);if(Q){const B=`inspeksi_${((S=a.point)==null?void 0:S.name)||"foto"}_${Date.now()}.jpg`,oe=new File([Q],B,{type:"image/jpeg",lastModified:Date.now()});b("photoCaptured",oe)}}}catch(U){console.error("Error capturing photo:",U)}finally{R.value=!1}}},f=async x=>new Promise(S=>{const U=n.value*1024,F=new Image,Y=new FileReader;Y.onload=ae=>{F.onload=()=>{const te=document.createElement("canvas"),re=te.getContext("2d"),fe=Math.sqrt(U/x.size),ye=Math.floor(F.width*fe),I=Math.floor(F.height*fe);te.width=ye,te.height=I,re.drawImage(F,0,0,ye,I),te.toBlob(S,"image/jpeg",.8)},F.src=ae.target.result},Y.readAsDataURL(x)}),T=()=>{v&&v.getTracks().forEach(x=>x.stop()),b("close")},D=async()=>{K.value=null,await ie()};let J=null;return ve(()=>a.show,async x=>{x?(await Fe(),J=de(),await ie()):(J&&J(),T())}),Re(()=>{v&&v.getTracks().forEach(x=>x.stop()),J&&J()}),(x,S)=>{var U;return t.show?(s(),o("div",Ln,[e("div",Rn,[e("div",Bn,[e("div",jn,V(((U=t.point)==null?void 0:U.name)||"Camera"),1),e("button",{onClick:T,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},S[2]||(S[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:Ue(E.value),onClick:me,onTouchstart:me},[e("video",{ref_key:"webcamVideo",ref:r,autoplay:"",playsinline:"",class:"webcam-video"},null,512),e("canvas",{ref_key:"webcamCanvas",ref:m,class:"hidden"},null,512),M.value?(s(),o("div",Fn,[e("div",On,[e("div",qn,[S[3]||(S[3]=e("label",{class:"control-label"},"Exposure",-1)),e("div",Kn,[e("span",Hn,V(N.value>0?"+":"")+V(N.value.toFixed(1)),1),Ce(e("input",{type:"range",min:j.value,max:W.value,step:"0.1","onUpdate:modelValue":S[0]||(S[0]=F=>N.value=F),onInput:S[1]||(S[1]=F=>ue(parseFloat(F.target.value))),class:"control-slider"},null,40,Gn),[[Me,N.value]])])]),e("div",{class:"control-buttons"},[e("button",{onClick:H,class:"control-btn reset-btn"}," Reset Auto "),e("button",{onClick:Ae,class:"control-btn close-btn"}," Tutup ")])])])):l("",!0),k.value?(s(),o("div",{key:1,class:"focus-indicator",style:Ue(z.value)},S[4]||(S[4]=[e("div",{class:"focus-ring"},null,-1)]),4)):l("",!0),e("div",{class:ee(["orientation-indicator",X.value])},[e("div",zn,V(pe.value),1)],2),G.value?(s(),o("div",Wn,S[5]||(S[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",{class:"loading-text"},"Menginisialisasi kamera...",-1)]))):l("",!0),K.value?(s(),o("div",Jn,[e("div",Zn,[S[6]||(S[6]=e("div",{class:"error-icon"},"⚠️",-1)),S[7]||(S[7]=e("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),e("p",Yn,V(K.value),1),e("button",{onClick:D,class:"retry-button"}," Coba Lagi ")])])):l("",!0)],36),e("div",Xn,[e("div",Qn,[t.settings.enable_flash&&P.value?(s(),o("button",{key:0,onClick:_e,class:ee(["control-button",{active:O.value}])},S[8]||(S[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):l("",!0),e("button",{onClick:C,class:"capture-button",disabled:R.value||G.value},[e("div",ts,[R.value?(s(),o("div",as)):(s(),o("div",ns))])],8,es),t.settings.enable_camera_switch&&w.value?(s(),o("button",{key:1,onClick:d,class:"control-button",disabled:G.value},S[9]||(S[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,ss)):l("",!0)])])])])):l("",!0)}}},is=Ne(os,[["__scopeId","data-v-409eb7b6"]]),ls=["accept","multiple","disabled"],rs={class:"text-xs text-gray-500 mb-2"},ds=["disabled"],us={class:"h-full flex flex-col items-center justify-center p-4 text-center"},cs={class:"text-xs text-gray-400 mt-1"},ps={key:0,class:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},ms={class:"flex items-center justify-between mb-2"},gs={class:"text-xs text-blue-600"},vs={class:"w-full bg-blue-200 rounded-full h-2"},fs={class:"text-xs text-blue-600 mt-1"},hs={key:1,class:"flex items-center gap-4"},bs=["src"],ys={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},xs=["disabled"],ws={key:2,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},ks=["disabled"],Is=["onClick"],$s=["src"],Ss={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},_s={key:0},As={key:1,class:"ml-1"},Cs={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Ts={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Ns={key:2,class:"mt-1 text-xs text-red-600"},Es={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(t,{emit:Z}){const a=t,b=Z,r=$(null),m=$(null),v=$(!1),u=$(!1),i=$(!1),y=$([]),_=$(0),w=$(!1),P=$(0),O=$(0),R=$(0),G=kt("imageSourceSetting",$("all")),K=`inspection-${a.inspectionId}-point-${a.pointId}-backup`,M=ne(()=>Number(a.settings.max_files)>1),k=ne(()=>a.settings.allowed_types.map(d=>`.${d}`).join(", ")),z=ne(()=>{const d=a.settings.camera_aspect_ratio.split(":");if(d.length===2){const C=parseFloat(d[0]),f=parseFloat(d[1]);if(!isNaN(C)&&!isNaN(f)&&f!==0)return C/f}return 3/4}),q=ne(()=>{const d=[],C=new Set;for(const f of a.modelValue)f.id&&C.add(f.id),d.push({...f,rotation:f.rotation||0,isNew:!1,isUploaded:!0,preview:f.preview||(f.image_path?`/${f.image_path}`:null)});for(const f of y.value)f.id&&C.add(f.id),d.push({...f,isUploading:f.isUploading||!1});return d}),N=d=>d.preview||(d.image_path?`/${d.image_path}`:""),j=()=>{i.value&&(i.value=!1),G.value==="camera"?ce():G.value==="gallery"?W():v.value=!0},W=()=>{v.value=!1,r.value.click()},ce=()=>{v.value=!1,u.value=!0},A=()=>{v.value=!1,q.value.length>0&&(i.value=!0)},p=()=>{u.value=!1,q.value.length>0&&(i.value=!0)},n=()=>{i.value=!1,w.value||(y.value.forEach(d=>{d.preview&&d.preview.startsWith("blob:")&&URL.revokeObjectURL(d.preview)}),y.value=[])},c=d=>new Promise(C=>{const f=new FileReader;f.onload=T=>{const D=new Image;D.onload=()=>{C({file:d,preview:URL.createObjectURL(d),rotation:0,width:D.naturalWidth,height:D.naturalHeight,isNew:!0})},D.onerror=()=>{console.error("Failed to load image for dimensions:",d.name),C({file:d,preview:URL.createObjectURL(d),rotation:0,width:0,height:0,isNew:!0})},D.src=T.target.result},f.readAsDataURL(d)}),E=d=>{const C=d.name.split(".").pop().toLowerCase();return a.settings.allowed_types.includes(C)},X=async d=>{const f=(a.settings.max_size||2048)*1024;return new Promise(T=>{const D=new Image,J=new FileReader;J.onload=x=>{D.onload=()=>{const S=document.createElement("canvas"),U=S.getContext("2d"),F=Math.max(D.width,D.height);S.width=F,S.height=F,U.fillStyle="white",U.fillRect(0,0,F,F);const Y=(F-D.width)/2,ae=(F-D.height)/2;U.drawImage(D,Y,ae,D.width,D.height);let te=.9;const re=()=>{S.toBlob(fe=>{if(fe.size>f&&te>.1)te-=.1,re();else{const ye=new File([fe],d.name,{type:"image/jpeg",lastModified:Date.now()});T(ye)}},"image/jpeg",te)};re()},D.src=x.target.result},J.readAsDataURL(d)})},pe=async d=>{const C=Array.from(d.target.files);if(!C.length){v.value=!1,q.value.length>0&&(i.value=!0);return}try{const f=C.filter(U=>!E(U));if(f.length>0){const U=f.map(F=>F.name.split(".").pop()).join(", ");alert(`File type not allowed: ${U}. Allowed types: ${a.settings.allowed_types.join(", ")}`),d.target.value="";return}const T=q.value.length,D=a.settings.max_files-T,J=await Promise.all(C.slice(0,D).map(async U=>await X(U))),x=await Promise.all(J.map(c)),S=M.value?x:x.slice(0,1);M.value?y.value.push(...S):(y.value.forEach(U=>{U.preview&&U.preview.startsWith("blob:")&&URL.revokeObjectURL(U.preview)}),y.value=S),v.value=!1,S.length>0?(_.value=Math.max(0,q.value.length-S.length),i.value=!0):q.value.length>0&&(i.value=!0),d.target.value=""}catch(f){console.error("Error processing selected images:",f),alert("Failed to process selected images. Please try again."),v.value=!1,q.value.length>0&&(i.value=!0)}},de=async d=>{const C=q.value.length;if(!M.value||C<a.settings.max_files)try{const f=await X(d),T=new Image;T.onload=()=>{const D={file:f,preview:URL.createObjectURL(f),rotation:0,width:T.naturalWidth,height:T.naturalHeight,isNew:!0};M.value?y.value.push(D):(y.value.forEach(J=>{J.preview&&J.preview.startsWith("blob:")&&URL.revokeObjectURL(J.preview)}),y.value=[D]),u.value=!1,v.value=!1,_.value=q.value.length-1,i.value=!0},T.src=URL.createObjectURL(f)}catch(f){console.error("Error processing captured image:",f),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${a.settings.max_files} files allowed.`),u.value=!1,v.value=!1,q.value.length>0&&(i.value=!0)},ie=(d=0)=>{_.value=d,i.value=!0},be=d=>new Promise(C=>{if(d.rotation===0||!m.value){if(!d.isNew&&!d.file){C({file:null,width:d.width,height:d.height,isOriginal:!0});return}C({file:d.file,width:d.width,height:d.height});return}const f=new Image;f.onload=async()=>{try{const T=m.value,D=T.getContext("2d"),J=f.width,x=f.height;let S,U;d.rotation===90||d.rotation===270?(S=x,U=J):(S=J,U=x),T.width=S,T.height=U,D.clearRect(0,0,T.width,T.height),D.translate(T.width/2,T.height/2),D.rotate(d.rotation*Math.PI/180),D.drawImage(f,-J/2,-x/2,J,x),D.setTransform(1,0,0,1,0,0);const F=await new Promise(te=>{T.toBlob(te,"image/jpeg",.9)}),Y=new File([F],d.file?d.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),ae=await X(Y);C({file:ae,width:S,height:U})}catch(T){console.error("Error processing rotated image:",T),C({file:d.file,width:d.width,height:d.height})}},f.onerror=()=>{console.error("Failed to load image for rotation processing:",d.preview),C({file:d.file,width:d.width,height:d.height})},f.src=d.preview}),le=d=>{try{const C={images:d.map(f=>{var T;return{fileName:((T=f.file)==null?void 0:T.name)||`image-${Date.now()}.jpg`,rotation:f.rotation||0,width:f.width||0,height:f.height||0,timestamp:Date.now()}}),inspectionId:a.inspectionId,pointId:a.pointId};localStorage.setItem(K,JSON.stringify(C))}catch(C){console.error("Error saving backup:",C)}},se=()=>{localStorage.removeItem(K)},me=async d=>{w.value=!0;const C=[],f=[];if(!a.pointId){alert("Error: Point ID is missing. Cannot upload image."),w.value=!1;return}try{le(d);for(const T of d){if(!T.isNew&&T.rotation===0&&T.id&&T.image_path){C.push({id:T.id,image_path:T.image_path,width:T.width,height:T.height,rotation:0,preview:T.preview,isUploaded:!0});continue}const{file:D,width:J,height:x,isOriginal:S}=await be(T);if(S&&!T.isNew){C.push({id:T.id,image_path:T.image_path,width:T.width,height:T.height,rotation:T.rotation||0,preview:T.preview,isUploaded:!0});continue}D&&f.push({file:D,width:J,height:x,rotation:T.rotation||0,originalImage:T})}n(),f.length>0?await ue(f,C):(b("update:modelValue",C),b("save",a.pointId))}catch(T){console.error("Error during image processing:",T),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{w.value=!1}},ue=async(d,C)=>{R.value=d.length,O.value=0,P.value=0;const f=[...C];let T=0;try{for(let D=0;D<d.length;D++){const J=d[D],x=new FormData;x.append("inspection_id",a.inspectionId),x.append("point_id",a.pointId),x.append("images[]",J.file);const S=y.value.findIndex(U=>{var F;return U.preview===((F=J.originalImage)==null?void 0:F.preview)});S!==-1&&(y.value[S].isUploading=!0,y.value[S].isFailed=!1);try{const F=(await Be.post(route("inspections.upload-image"),x,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:Y=>{if(Y.total){const ae=Math.round(Y.loaded*100/Y.total);P.value=Math.round((D+Y.loaded/Y.total)/d.length*100),O.value=D+1}}})).data.images;if(F&&F.length>0){const Y=F[0];if(f.push({id:Y.image_id,image_path:Y.path,width:Y.width||J.width||0,height:Y.height||J.height||0,rotation:J.rotation||0,preview:Y.public_url,isUploaded:!0}),S!==-1){const ae=y.value.splice(S,1)[0];ae.preview&&ae.preview.startsWith("blob:")&&URL.revokeObjectURL(ae.preview)}T++}}catch(U){console.error(`Error uploading image ${D+1}:`,U),S!==-1&&(y.value[S].isUploading=!1,y.value[S].isFailed=!0)}}T>0&&(b("update:modelValue",f),b("save",a.pointId),b("uploaded",{pointId:a.pointId,images:f,newImagesCount:T})),T===d.length&&se(),console.log(`✅ Successfully uploaded ${T}/${d.length} images`)}catch(D){console.error("Error in upload process:",D),d.forEach(J=>{const x=y.value.findIndex(S=>{var U;return S.preview===((U=J.originalImage)==null?void 0:U.preview)});x!==-1&&(y.value[x].isUploading=!1,y.value[x].isFailed=!0)})}finally{P.value=0,O.value=0,R.value=0,w.value=!1}},H=async d=>{if(!d||!d.file){console.error("No file to retry upload");return}w.value=!0;const C=[...a.modelValue];try{const f=new FormData;f.append("inspection_id",a.inspectionId),f.append("point_id",a.pointId),f.append("images[]",d.file);const T=y.value.findIndex(x=>x.preview===d.preview);T!==-1&&(y.value[T].isUploading=!0,y.value[T].isFailed=!1);const J=(await Be.post(route("inspections.upload-image"),f,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(J&&J.length>0){const x=J[0];if(C.push({id:x.image_id,image_path:x.path,width:x.width||d.width||0,height:x.height||d.height||0,rotation:d.rotation||0,preview:x.public_url,isUploaded:!0}),T!==-1){const U=y.value.splice(T,1)[0];U.preview&&U.preview.startsWith("blob:")&&URL.revokeObjectURL(U.preview)}b("update:modelValue",C),b("save",a.pointId),b("uploaded",{pointId:a.pointId,images:C,newImagesCount:1}),y.value.some(U=>U.isFailed)||se(),console.log("✅ Successfully retried upload for 1 image")}}catch(f){console.error("Error retrying upload:",f),previewIndex!==-1&&(y.value[previewIndex].isUploading=!1,y.value[previewIndex].isFailed=!0)}finally{w.value=!1}},Ae=d=>{if(d){if(d.id&&!d.isNew)_e(d);else{const C=y.value.findIndex(f=>f.preview&&f.preview===d.preview&&f.isNew||f.id&&f.id===d.id);if(C!==-1){const f=y.value.splice(C,1)[0];f.preview&&f.preview.startsWith("blob:")&&URL.revokeObjectURL(f.preview)}b("update:modelValue",a.modelValue.filter(f=>!(f.id&&f.id===d.id)&&!(f.preview&&f.preview===d.preview)))}_.value>=q.value.length&&(_.value=Math.max(0,q.value.length-1)),q.value.length===0&&n()}},_e=async d=>{var f,T;if(d.id||d.image_path)try{await Be.delete(route("inspections.delete-image"),{data:{image_id:d.id,image_path:d.image_path}})}catch(D){console.error("Error deleting image from server:",D),(T=(f=D.response)==null?void 0:f.data)!=null&&T.message?alert(`Failed to delete image from server: ${D.response.data.message}`):alert(`Failed to delete image from server: ${D.message}`);return}d.preview&&d.preview.startsWith("blob:")&&URL.revokeObjectURL(d.preview);const C=a.modelValue.filter(D=>D.id!==d.id);b("update:modelValue",C),y.value=y.value.filter(D=>D.isNew&&d.isNew?D.preview!==d.preview:D.id!==d.id),b("removeImage",{image:d}),i.value&&q.value.length===0?n():i.value&&_.value>=q.value.length&&(_.value=Math.max(0,q.value.length-1))};return Pe(()=>{try{localStorage.getItem(K)&&console.log("Found backup images, ready for recovery if needed")}catch(d){console.error("Error loading backup:",d)}}),(d,C)=>(s(),o("div",null,[e("input",{ref_key:"galleryInput",ref:r,type:"file",accept:k.value,class:"hidden",onChange:pe,multiple:M.value,disabled:w.value},null,40,ls),e("canvas",{ref_key:"processingCanvas",ref:m,class:"hidden"},null,512),e("p",rs,"Foto Maksimal: "+V(t.settings.max_files)+" | Rasio: "+V(t.settings.camera_aspect_ratio),1),q.value.length===0?(s(),o("label",{key:0,onClick:j,class:ee(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:w.value},[e("div",us,[C[2]||(C[2]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),C[3]||(C[3]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",cs,"Tipe: "+V(k.value),1)])],8,ds)):(s(),o("div",{key:1,class:ee(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":t.settings.max_files==1,"bg-transparent":t.settings.max_files>1}]),"aria-label":"Image gallery"},[w.value?(s(),o("div",ps,[e("div",ms,[C[4]||(C[4]=e("span",{class:"text-sm font-medium text-blue-700"},"Mengupload gambar...",-1)),e("span",gs,V(P.value)+"%",1)]),e("div",vs,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:Ue({width:P.value+"%"})},null,4)]),e("p",fs,V(O.value)+"/"+V(R.value)+" gambar terupload",1)])):l("",!0),t.settings.max_files===1?(s(),o("div",hs,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:C[0]||(C[0]=f=>ie(0))},[e("img",{src:N(q.value[0]),class:"w-full h-full object-cover"},null,8,bs),q.value[0].isUploading?(s(),o("div",ys,C[5]||(C[5]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):l("",!0)]),e("button",{onClick:C[1]||(C[1]=De(f=>_e(q.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:w.value},C[6]||(C[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),we(" Hapus Foto ")]),8,xs)])):(s(),o("div",ws,[M.value&&q.value.length<t.settings.max_files?(s(),o("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:j,disabled:w.value},C[7]||(C[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,ks)):l("",!0),(s(!0),o(Ie,null,$e(q.value,(f,T)=>(s(),o("div",{key:f.id||f.preview,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:D=>f.isFailed?H(f):ie(T)},[e("img",{src:N(f),class:"w-full h-full object-cover"},null,8,$s),f.isNew||f.rotation!==0?(s(),o("div",Ss,[f.isNew?(s(),o("span",_s,"BARU")):l("",!0),f.rotation!==0?(s(),o("span",As,"ROTASI")):l("",!0)])):l("",!0),f.isUploading?(s(),o("div",Cs,C[8]||(C[8]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):l("",!0),f.isFailed?(s(),o("div",Ts,C[9]||(C[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"text-xs font-medium"},"Retry",-1)]))):l("",!0)],8,Is))),128))]))],2)),t.error?(s(),o("p",Ns,V(t.error),1)):l("",!0),ke(sn,{show:v.value,settings:t.settings,onClose:A,onOpenWebcam:ce,onTriggerGallery:W},null,8,["show","settings"]),ke(is,{show:u.value,"aspect-ratio":z.value,settings:t.settings,point:t.point,onClose:p,onPhotoCaptured:de},null,8,["show","aspect-ratio","settings","point"]),ke(Dn,{show:i.value,images:q.value,point:t.point,"initial-index":_.value,"allow-multiple":M.value,"max-files":t.settings.max_files,"is-uploading":w.value,"aspect-ratio":z.value,"upload-progress":P.value,"current-upload":O.value,"total-upload":R.value,onClose:n,onSaveImages:me,onRemovePreviewImage:Ae,onTriggerAddMorePhotos:j,onRetryImage:H},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},Oe=Ne(Es,[["__scopeId","data-v-3180dd6e"]]),Vs={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Us={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Ms={class:"px-4 pb-2 border-b border-gray-200"},Ps={class:"text-lg font-semibold text-gray-900"},Ds={key:0,class:"text-sm text-gray-500 mt-1"},Ls={class:"flex-1 overflow-y-auto p-4"},Rs={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Bs={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(t){return(Z,a)=>(s(),Se(Le,{name:"bottom-sheet"},{default:Te(()=>[t.show?(s(),o("div",Vs,[a[1]||(a[1]=e("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),e("div",Us,[a[0]||(a[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Ms,[e("h3",Ps,V(t.title),1),t.subtitle?(s(),o("p",Ds,V(t.subtitle),1)):l("",!0)]),e("div",Ls,[xt(Z.$slots,"default",{},void 0,!0)]),Z.$slots.footer?(s(),o("div",Rs,[xt(Z.$slots,"footer",{},void 0,!0)])):l("",!0)])])):l("",!0)]),_:3}))}},js=Ne(Bs,[["__scopeId","data-v-fd942535"]]),Fs={class:"space-y-4"},Os={key:0,class:"mt-2"},qs={key:1,class:"mt-2"},Ks={key:2,class:"mt-2"},Hs={key:3,class:"mt-2"},Gs={key:4,class:"mt-2"},zs={class:"text-sm font-medium text-gray-700 mb-2"},Ws={key:0,class:"text-red-500"},Js={key:0,class:"text-xs text-red-500"},Zs=["name","value","checked"],Ys={key:6,class:"space-y-2"},Xs={key:0,class:"text-red-500"},Qs={key:1,class:"text-xs text-red-500"},eo={key:7,class:"mt-4"},to={class:"text-sm font-medium text-gray-700 mb-2"},ao={key:0,class:"text-red-500"},no={key:0,class:"text-xs text-red-500"},so={class:"flex gap-2"},oo=["disabled"],Tt={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:String,notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(t,{emit:Z}){const a=t,b=Z,r=u=>b("hapus",u),m=ne(()=>a.options.find(u=>u.value===a.selectedValue)),v=ne(()=>{var i,y,_,w,P,O,R;if(a.point.input_type==="text"&&(!((i=a.notesValue)!=null&&i.trim())||a.point.settings.min_length&&a.notesValue.length<a.point.settings.min_length||a.point.settings.max_length&&a.notesValue.length>a.point.settings.max_length)||a.point.input_type==="number"&&(!((y=a.notesValue)!=null&&y.trim())||a.point.settings.min&&a.notesValue.length<a.point.settings.min||a.point.settings.max&&a.notesValue.length>a.point.settings.max)||a.point.input_type==="account"&&(!((_=a.notesValue)!=null&&_.trim())||a.point.settings.min_value&&a.notesValue.length<a.point.settings.min_value||a.point.settings.max_value&&a.notesValue.length>a.point.settings.max_value)||a.point.input_type==="date"&&(!((w=a.notesValue)!=null&&w.trim())||a.point.settings.min_date&&a.notesValue.length<a.point.settings.min_date||a.point.settings.max_date&&a.notesValue.length>a.point.settings.max_date))return!1;if(a.point.input_type==="imageTOradio"){if(a.imagesValue.length===0)return!1;const G=a.imagesValue.some(M=>M.status==="error"),K=a.imagesValue.some(M=>M.status==="uploading");if(G||K)return!1}if(a.options.length&&!a.selectedValue)return!1;const u=m.value;if(a.showTextarea&&((P=u==null?void 0:u.settings)!=null&&P.show_textarea)&&(!((O=a.notesValue)!=null&&O.trim())||u.settings.min_length&&a.notesValue.length<u.settings.min_length||u.settings.max_length&&a.notesValue.length>u.settings.max_length))return!1;if(a.showImageUpload&&((R=u==null?void 0:u.settings)!=null&&R.show_image_upload)){if(a.imagesValue.length===0||u.settings.max_files&&a.imagesValue.length>u.settings.max_files)return!1;const G=a.imagesValue.some(M=>M.status==="error"),K=a.imagesValue.some(M=>M.status==="uploading");if(G||K)return!1}return!0});return(u,i)=>(s(),Se(js,{show:t.show,title:t.title,subtitle:t.subtitle,onClose:i[18]||(i[18]=y=>u.$emit("close"))},{footer:Te(()=>[t.selectedPoint?(s(),o("button",{key:0,onClick:i[15]||(i[15]=y=>r(t.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},i[20]||(i[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),we(" Hapus Data ")]))):l("",!0),e("div",so,[e("button",{type:"button",onClick:i[16]||(i[16]=y=>u.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:i[17]||(i[17]=y=>u.$emit("save")),disabled:!v.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,oo)])]),default:Te(()=>{var y,_,w,P,O,R,G,K,M,k,z,q,N,j,W,ce,A,p,n,c,E,X,pe,de,ie,be,le,se,me,ue;return[e("div",Fs,[t.point.input_type==="text"?(s(),o("div",Os,[ke($t,{"model-value":t.notesValue,required:(y=t.point.settings)==null?void 0:y.is_required,"min-length":(_=t.point.settings)==null?void 0:_.min_length,"max-length":(w=t.point.settings)==null?void 0:w.max_length,allowSpace:(P=t.point.settings)==null?void 0:P.allow_space,textTransform:(O=t.point.settings)==null?void 0:O.text_transform,placeholder:((R=t.point.settings)==null?void 0:R.placeholder)||"Masukan text",error:u.error,"onUpdate:modelValue":i[0]||(i[0]=H=>u.$emit("update:notesValue",H)),onSave:i[1]||(i[1]=H=>u.$emit("saveText",H))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):l("",!0),t.point.input_type==="number"?(s(),o("div",qs,[ke(St,{"model-value":t.notesValue,required:(G=t.point.settings)==null?void 0:G.is_required,min:(K=t.point.settings)==null?void 0:K.min,max:(M=t.point.settings)==null?void 0:M.max,step:((k=t.point.settings)==null?void 0:k.step)||1,placeholder:((z=t.point.settings)==null?void 0:z.placeholder)||"Masukan number",error:u.error,"onUpdate:modelValue":i[2]||(i[2]=H=>u.$emit("update:notesValue",H)),onSave:i[3]||(i[3]=H=>u.$emit("saveNumber",H))},null,8,["model-value","required","min","max","step","placeholder","error"])])):l("",!0),t.point.input_type==="account"?(s(),o("div",Ks,[ke(At,{"model-value":t.notesValue,required:(q=t.point.settings)==null?void 0:q.is_required,placeholder:((N=t.point.settings)==null?void 0:N.placeholder)||"Masukkan nilai",error:u.error,"point-id":t.pointId,settings:t.point.settings,"onUpdate:modelValue":i[4]||(i[4]=H=>u.$emit("update:notesValue",H)),onSave:i[5]||(i[5]=H=>u.$emit("saveAccount",H))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):l("",!0),t.point.input_type==="date"?(s(),o("div",Hs,[ke(_t,{"model-value":t.notesValue,required:(j=t.point.settings)==null?void 0:j.is_required,"min-date":(W=t.point.settings)==null?void 0:W.min_date,"max-date":(ce=t.point.settings)==null?void 0:ce.max_date,error:u.error,"onUpdate:modelValue":i[6]||(i[6]=H=>u.$emit("update:notesValue",H)),onSave:i[7]||(i[7]=H=>u.$emit("saveDate",H))},null,8,["model-value","required","min-date","max-date","error"])])):l("",!0),t.point.input_type==="imageTOradio"?(s(),o("div",Gs,[e("h4",zs,[(A=t.point.settings)!=null&&A.required?(s(),o("span",Ws,"*")):l("",!0)]),ke(Oe,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point.inspection_point,"inspection-id":t.inspectionId,settings:t.point.settings,"onUpdate:modelValue":i[8]||(i[8]=H=>u.$emit("update:imagesValue",H)),onSave:i[9]||(i[9]=H=>u.$emit("saveImage",H))},null,8,["model-value","point-id","point","inspection-id","settings"]),(p=t.point.settings)!=null&&p.required&&t.imagesValue.length===0?(s(),o("p",Js," Foto wajib diupload ")):l("",!0)])):l("",!0),t.options.length?(s(),o("div",{key:5,class:ee(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ie,null,$e(t.options,(H,Ae)=>(s(),o("label",{key:Ae,class:"cursor-pointer"},[e("input",{type:"radio",name:t.name,value:H.value,checked:t.selectedValue===H.value,onChange:i[10]||(i[10]=_e=>u.$emit("update:selectedValue",_e.target.value)),class:"hidden peer"},null,40,Zs),e("div",{class:ee(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.selectedValue===H.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.selectedValue!==H.value}])},V(H.label),3)]))),128))],2)):l("",!0),t.showTextarea&&((c=(n=m.value)==null?void 0:n.settings)!=null&&c.show_textarea)?(s(),o("div",Ys,[(E=m.value.settings)!=null&&E.required?(s(),o("span",Xs,"*")):l("",!0),ke(Ct,{"model-value":t.notesValue,"point-id":t.pointId,"inspection-id":t.inspectionId,settings:m.value.settings,required:(X=m.value.settings)==null?void 0:X.required,"min-length":(pe=m.value.settings)==null?void 0:pe.min_length,"max-length":(de=m.value.settings)==null?void 0:de.max_length,placeholder:((ie=m.value.settings)==null?void 0:ie.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":i[11]||(i[11]=H=>u.$emit("update:notesValue",H)),onSave:i[12]||(i[12]=H=>u.$emit("saveTextarea",H))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(be=m.value.settings)!=null&&be.required&&!t.notesValue?(s(),o("p",Qs," Keterangan wajib diisi ")):l("",!0)])):l("",!0),t.showImageUpload&&((se=(le=m.value)==null?void 0:le.settings)!=null&&se.show_image_upload)?(s(),o("div",eo,[e("h4",to,[i[19]||(i[19]=we(" Upload Foto ")),(me=m.value.settings)!=null&&me.required?(s(),o("span",ao,"*")):l("",!0)]),ke(Oe,{"model-value":t.imagesValue,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,settings:m.value.settings,"onUpdate:modelValue":i[13]||(i[13]=H=>u.$emit("update:imagesValue",H)),onSave:i[14]||(i[14]=H=>u.$emit("saveImage",H))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ue=m.value.settings)!=null&&ue.required&&t.imagesValue.length===0?(s(),o("p",no," Foto wajib diupload ")):l("",!0)])):l("",!0)])]}),_:1},8,["show","title","subtitle"]))}},io={class:"mt-2 space-y-2"},lo=["name","value","checked","onChange","required"],ro={key:0,class:"p-2 rounded-lg bg-gray-50"},uo={key:0,class:"mt-2"},co={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},po=["src"],mo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},go={key:1,class:"mt-2"},vo={class:"text-sm text-gray-600"},fo={key:2,class:"mt-2 text-sm text-red-600"},ho={__name:"InputRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:Z}){const a=t,b=Z,r=$(a.notes),m=$([...a.images]),v=$(!1),u=$(""),i=$([]),y=$(""),_=$([]),w=ne(()=>a.options.find(N=>N.value===a.modelValue)),P=N=>N.settings&&(N.settings.show_textarea||N.settings.show_image_upload);ve(()=>a.notes,N=>{r.value=N}),ve(()=>a.images,N=>{m.value=[...N]}),ve(()=>a.modelValue,N=>{N&&(y.value=N)});const O=N=>{b("update:modelValue",N.value),P(N)?G():b("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:N.value,notes:"",images:[]})},R=N=>N.preview||(N.image_path?`/${N.image_path}`:N),G=()=>{y.value=a.modelValue,u.value=r.value,i.value=[...m.value],_.value=[...m.value],v.value=!0},K=()=>{u.value="",i.value=[],y.value="",v.value=!1},M=N=>{i.value=N,m.value=[...N],b("update:images",[...N]),b("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:r.value,images:[...N]})},k=N=>{},z=()=>{y.value!==a.modelValue&&b("update:modelValue",y.value),r.value=u.value,b("update:notes",u.value),m.value=[...i.value],b("update:images",[...i.value]),b("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:y.value,notes:u.value,images:i.value}),v.value=!1},q=N=>{y.value="",u.value="",i.value=[],r.value="",m.value=[],b("update:modelValue",""),b("update:notes",""),b("update:images",[]),b("hapus",N),v.value=!1};return(N,j)=>{var W,ce,A;return s(),o("div",io,[e("div",{class:ee(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ie,null,$e(t.options,(p,n)=>(s(),o("label",{key:n,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:p.value,checked:t.modelValue===p.value,onChange:c=>O(p),class:"hidden peer",required:t.required},null,40,lo),e("div",{class:ee(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===p.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==p.value}])},V(p.label),3)]))),128))],2),t.modelValue&&w.value&&P(w.value)?(s(),o("div",ro,[e("div",{class:"flex justify-between items-start"},[j[4]||(j[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:G,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),t.images.length>0&&((W=w.value.settings)!=null&&W.show_image_upload)?(s(),o("div",uo,[e("div",co,[(s(!0),o(Ie,null,$e(t.images,(p,n)=>(s(),o("div",{key:n,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:R(p),class:"w-full h-full object-cover rounded"},null,8,po),n===3&&t.images.length>4?(s(),o("span",mo," +"+V(t.images.length-4),1)):l("",!0)]))),128))])])):l("",!0),t.notes&&((ce=w.value.settings)!=null&&ce.show_textarea)?(s(),o("div",go,[e("p",vo,V(t.notes),1)])):l("",!0)])):l("",!0),v.value?(s(),Se(Tt,{key:(A=t.selectedPoint)==null?void 0:A.id,show:v.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":y.value,"notes-value":u.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":j[0]||(j[0]=p=>y.value=p),"onUpdate:notesValue":j[1]||(j[1]=p=>u.value=p),"onUpdate:imagesValue":j[2]||(j[2]=p=>M(p)),onClose:K,onSave:z,onSaveTextarea:N.handleTextareaSave,onSaveImage:k,onHapus:j[3]||(j[3]=p=>q(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):l("",!0),t.error?(s(),o("p",fo,V(t.error),1)):l("",!0)])}}},bo={class:"mt-2 space-y-2"},yo={key:0,class:"flex flex-wrap gap-3"},xo={key:1,class:"p-2"},wo={key:0,class:"mt-2"},ko={class:"flex gap-2 overflow-x-auto scrollbar-hide"},Io=["src"],$o={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},So=["name","value","checked"],_o={key:1,class:"mt-2"},Ao={class:"text-sm text-gray-600"},Co={key:3,class:"mt-2 text-sm text-red-600"},To={__name:"InputImageToRadio",props:{modelValue:String,required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(t,{emit:Z}){const a=t,b=Z,r=$(a.notes),m=$([...a.images]),v=$(!1),u=$(""),i=$([]),y=$(""),_=$([]),w=ne(()=>a.options.find(k=>k.value===a.modelValue)),P=k=>k.preview||(k.image_path?`/${k.image_path}`:k);ve(()=>a.notes,k=>{r.value=k});const O=()=>{y.value=a.modelValue||"",u.value=r.value,i.value=[...m.value],_.value=[...m.value],v.value=!0},R=()=>{u.value="",i.value=[],y.value="",v.value=!1},G=k=>{i.value=k,m.value=[...k],b("update:images",[...k]),b("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:a.modelValue,notes:r.value,images:[...k]})},K=()=>{y.value!==a.modelValue&&b("update:modelValue",y.value),r.value=u.value,b("update:notes",u.value),m.value=[...i.value],b("update:images",[...i.value]),b("save",{pointId:a.pointId,inspectionId:a.inspectionId,value:y.value,notes:u.value,images:i.value}),v.value=!1},M=k=>{y.value="",u.value="",i.value=[],r.value="",m.value=[],b("update:modelValue",""),b("update:notes",""),b("update:images",[]),b("hapus",k),v.value=!1};return(k,z)=>{var q,N;return s(),o("div",bo,[!t.modelValue&&m.value.length===0&&!r.value?(s(),o("div",yo,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:O},z[4]||(z[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(s(),o("div",xo,[e("div",{class:"flex justify-between items-start"},[z[5]||(z[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:O,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),m.value.length>0?(s(),o("div",wo,[e("div",ko,[(s(!0),o(Ie,null,$e(m.value,(j,W)=>(s(),o("div",{key:W,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:P(j),class:"w-full h-full object-cover rounded"},null,8,Io),W===3&&m.value.length>4?(s(),o("span",$o," +"+V(m.value.length-4),1)):l("",!0)]))),128))])])):l("",!0),e("div",{class:ee(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(t.options.length,3)}`])},[(s(!0),o(Ie,null,$e(t.options,(j,W)=>(s(),o("label",{key:W,class:"cursor-pointer"},[e("input",{type:"radio",name:"radio-"+t.pointId,value:j.value,checked:t.modelValue===j.value,disabled:!0,class:"hidden peer"},null,8,So),e("div",{class:ee(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":t.modelValue===j.value,"border-gray-300 text-gray-700 hover:bg-gray-50":t.modelValue!==j.value}])},V(j.label),3)]))),128))],2),r.value&&((q=w.value.settings)!=null&&q.show_textarea)?(s(),o("div",_o,[e("p",Ao,V(r.value),1)])):l("",!0)])),v.value?(s(),Se(Tt,{key:(N=t.selectedPoint)==null?void 0:N.id,show:v.value,title:t.pointName||"Detail",subtitle:t.subtitle||"",name:"modal-radio-"+t.pointId,options:t.options,"selected-value":y.value,"notes-value":u.value,"images-value":i.value,"point-id":t.pointId,point:t.point,"inspection-id":t.inspectionId,"selected-point":t.selectedPoint,"onUpdate:selectedValue":z[0]||(z[0]=j=>y.value=j),"onUpdate:notesValue":z[1]||(z[1]=j=>u.value=j),"onUpdate:imagesValue":z[2]||(z[2]=j=>G(j)),onClose:R,onSave:K,onHapus:z[3]||(z[3]=j=>M(t.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):l("",!0),t.error?(s(),o("p",Co,V(t.error),1)):l("",!0)])}}},No={class:"text-base font-semibold text-indigo-700"},Eo={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Vo={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Uo={class:"text-base font-semibold text-indigo-700"},Mo={class:"p-4 space-y-4"},Po={key:0,class:"flex justify-end py-1"},Do=["onClick"],Lo={key:1,class:"space-y-2"},Ro={class:"flex items-start justify-between"},Bo={class:"flex-1"},jo={class:"block text-sm font-medium text-gray-700"},Fo={key:0,class:"text-red-500"},Oo={key:1,class:"italic text-xs text-gray-400 ml-2"},qo={key:0,class:"mt-1"},Ko={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Ho={key:0},Go={key:1},zo={key:2},Wo={key:3},Jo={key:4},Zo={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},Yo={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},Xo={class:"text-xs mt-1 list-disc list-inside"},Qo={key:0},ei={key:1},ti={key:2},ai={key:3},ni={key:4},si={key:0,class:"text-center py-8 text-gray-500"},oi={key:0,class:"text-xs text-gray-400"},ii={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(t,{emit:Z}){const a=t,b=Z,r=kt("vehicleFeatures",$(null));r.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Vt("vehicleFeatures",r);const m=$(!1),v=$([]),u=$(!0),i=$(null),y=Ut(),_={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};Pe(()=>{const A=new IntersectionObserver(([p])=>{u.value=p.isIntersecting},{threshold:.1});i.value&&A.observe(i.value),Re(()=>{i.value&&A.unobserve(i.value)})});const w=()=>{m.value=!m.value,m.value||(v.value=[])},P=ne(()=>(a.category.points||[]).some(A=>A.is_default===!1)),O=A=>!A||!Array.isArray(A)?[]:A.map(p=>_[p]||p),R=A=>{var E,X;const p=A.settings;if(!G(A))return!0;const n=(E=a.car)==null?void 0:E.transmission,c=(X=a.car)==null?void 0:X.fuel_type;return!(p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0&&n&&!p.transmission.includes(n)||p.fuel_type&&p.fuel_type.trim()!==""&&c&&p.fuel_type!==c||p.rear_door&&(!r.value||!r.value.rear_door)||p.pick_up&&(!r.value||!r.value.pick_up)||p.box&&(!r.value||!r.value.box))},G=A=>{const p=A.settings;return!!(p!=null&&p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0||p!=null&&p.fuel_type&&p.fuel_type.trim()!==""||p!=null&&p.rear_door||p!=null&&p.pick_up||p!=null&&p.box)},K=A=>G(A)&&(m.value||R(A)),M=ne(()=>{const A=a.category.points||[],p=[];let n=[];return m.value?a.category.isDamageMenu?A.filter(c=>{var E;return c.is_default||z((E=c.inspection_point)==null?void 0:E.id)||m.value}):A:a.category.isDamageMenu?A.filter(c=>{var X;const E=(X=c.inspection_point)==null?void 0:X.id;return z(E)||c.is_default||v.value.includes(E)}):(A.forEach(c=>{var le;const E=(le=c.inspection_point)==null?void 0:le.id,X=z(E),pe=v.value.includes(E),ie=!G(c)||R(c);(c.is_default||X||pe)&&ie?(n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(se=>se.inspection_point.id)}),n.forEach(se=>{v.value.includes(se.inspection_point.id)&&p.push(se)}),n=[]),p.push(c)):(!G(c)||R(c))&&n.push(c)}),n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(c=>c.inspection_point.id)}),n.forEach(c=>{v.value.includes(c.inspection_point.id)&&p.push(c)})),p.filter(c=>{var E,X;return c.is_link||c.is_default||z((E=c.inspection_point)==null?void 0:E.id)||v.value.includes((X=c.inspection_point)==null?void 0:X.id)}))});ne(()=>M.value.filter(A=>!A.is_link));const k=A=>{m.value=!1,A.forEach(p=>{v.value.includes(p)||v.value.push(p)})},z=A=>{if(!A)return!1;const p=y.props.existingResults[A]!==void 0,n=y.props.existingImages[A]&&y.props.existingImages[A].length>0,c=a.form.results[A]&&(a.form.results[A].status||a.form.results[A].note),E=a.form.images[A]&&a.form.images[A].length>0;return p||n||c||E},q=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],N=A=>{var c,E,X,pe,de,ie,be,le,se;const p=a.form.results[(c=A.inspection_point)==null?void 0:c.id],n=a.form.images[(E=A.inspection_point)==null?void 0:E.id];if(!p)return!1;switch(A.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!p.note;case"select":case"radio":if(!p.status)return!1;const me=(pe=(X=A.settings)==null?void 0:X.radios)==null?void 0:pe.find(H=>H.value===p.status);return!(me!=null&&me.settings&&(me.settings.show_textarea&&!((de=p.note)!=null&&de.trim())||me.settings.show_image_upload&&(n==null?void 0:n.length)===0));case"imageTOradio":if((n==null?void 0:n.length)===0||!p.status)return!1;const ue=(be=(ie=A.settings)==null?void 0:ie.radios)==null?void 0:be.find(H=>H.value===p.status);return!(ue!=null&&ue.settings&&ue.settings.show_textarea&&!((le=p.note)!=null&&le.trim()));case"image":return(n==null?void 0:n.length)>0;default:return!!p.status||!!((se=p.note)!=null&&se.trim())}},j=(A,p,n)=>{b("updateResult",{pointId:A,type:n,value:p})},W=A=>{console.log("Save result for point:",A)},ce=A=>{b("hapusPoint",A)};return ve(()=>a.form.results,A=>{},{deep:!0}),ve(()=>a.form.images,A=>{},{deep:!0}),ve(()=>a.car,A=>{console.log("Car data updated:",A)},{deep:!0}),ve(r,A=>{console.log("Vehicle features updated:",A)},{deep:!0}),(A,p)=>(s(),o(Ie,null,[a.head==="vertical"?(s(),o("div",{key:0,class:ee(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[e("h4",No,V(t.category.name),1),P.value?(s(),o("button",{key:0,onClick:w,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},V(m.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):l("",!0)])):l("",!0),e("div",{class:ee(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",a.head==="vertical"?"pt-6":""])},[!u.value&&P.value?(s(),o("button",{key:0,onClick:w,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[m.value?(s(),o("svg",Eo,p[0]||(p[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(s(),o("svg",Vo,p[1]||(p[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):l("",!0),a.head==="horizontal"?(s(),o("div",{key:1,ref_key:"categoryHeader",ref:i,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",Uo,V(t.category.name),1),P.value?(s(),o("button",{key:0,onClick:w,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},V(m.value?"Sembunyikan":"Tampilkan Point Lain"),1)):l("",!0)],512)):l("",!0),e("div",Mo,[(s(!0),o(Ie,null,$e(M.value,(n,c)=>{var E,X,pe,de,ie,be,le,se,me,ue,H,Ae,_e,d,C,f,T,D,J,x,S,U,F,Y,ae,te,re,fe,ye,I,g,Q,B,oe,he,xe,ge,Ve,qe,Ke,He,Ge,ze,We,Je,Ze,Ye,Xe,Qe,et,tt,at,nt,st,ot,it,lt,rt,dt,ut,ct,pt,mt,gt,vt,ft,ht,bt,yt;return s(),o("div",{key:c,class:ee(["space-y-2 last:border-0 last:pb-0",n.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[n.is_link?(s(),o("div",Po,[e("button",{onClick:L=>k(n.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+V(n.count)+" Point Tersembunyi ",9,Do)])):(s(),o("div",Lo,[e("div",Ro,[e("div",Bo,[e("label",jo,[we(V((E=n.inspection_point)==null?void 0:E.name)+" ",1),(X=n.settings)!=null&&X.is_required?(s(),o("span",Fo,"*")):l("",!0),!n.is_default&&!z((pe=n.inspection_point)==null?void 0:pe.id)?(s(),o("span",Oo," (opsional) ")):l("",!0)]),K(n)?(s(),o("div",qo,[G(n)?(s(),o("div",Ko,[(de=n.settings)!=null&&de.transmission?(s(),o("div",Ho,V(n.settings.transmission.join(", ")),1)):l("",!0),(ie=n.settings)!=null&&ie.fuel_type?(s(),o("div",Go,V(n.settings.fuel_type),1)):l("",!0),(be=n.settings)!=null&&be.rear_door?(s(),o("div",zo," Pintu Belakang ")):l("",!0),(le=n.settings)!=null&&le.pick_up?(s(),o("div",Wo," Tipe Pick Up ")):l("",!0),(se=n.settings)!=null&&se.box?(s(),o("div",Jo," Memiliki Box ")):l("",!0)])):l("",!0)])):l("",!0)]),N(n)?(s(),o("span",Zo," ✓ ")):l("",!0)]),n.input_type==="text"&&R(n)?(s(),Se($t,{key:0,modelValue:t.form.results[(me=n.inspection_point)==null?void 0:me.id].note,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"note")}],required:(ue=n.settings)==null?void 0:ue.is_required,"min-length":(H=n.settings)==null?void 0:H.min_length,"max-length":(Ae=n.settings)==null?void 0:Ae.max_length,allowSpace:(_e=n.settings)==null?void 0:_e.allow_space,textTransform:(d=n.settings)==null?void 0:d.text_transform,placeholder:((C=n.settings)==null?void 0:C.placeholder)||"Masukan text",error:t.form.errors[`results.${(f=n.inspection_point)==null?void 0:f.id}.note`],onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):l("",!0),n.input_type==="number"&&R(n)?(s(),Se(St,{key:1,modelValue:t.form.results[(T=n.inspection_point)==null?void 0:T.id].note,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"note")}],required:(D=n.settings)==null?void 0:D.is_required,min:(J=n.settings)==null?void 0:J.min,max:(x=n.settings)==null?void 0:x.max,step:((S=n.settings)==null?void 0:S.step)||1,placeholder:((U=n.settings)==null?void 0:U.placeholder)||"Masukan number",error:t.form.errors[`results.${(F=n.inspection_point)==null?void 0:F.id}.note`],onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):l("",!0),n.input_type==="account"&&R(n)?(s(),Se(At,{key:2,modelValue:t.form.results[(Y=n.inspection_point)==null?void 0:Y.id].note,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"note")}],required:(ae=n.settings)==null?void 0:ae.is_required,placeholder:((te=n.settings)==null?void 0:te.placeholder)||"Masukkan nilai",error:t.form.errors[`results.${(re=n.inspection_point)==null?void 0:re.id}.note`],"point-id":(fe=n.inspection_point)==null?void 0:fe.id,settings:n.settings,onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):l("",!0),n.input_type==="date"&&R(n)?(s(),Se(_t,{key:3,modelValue:t.form.results[(ye=n.inspection_point)==null?void 0:ye.id].note,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"note")}],required:(I=n.settings)==null?void 0:I.is_required,"min-date":(g=n.settings)==null?void 0:g.min_date,"max-date":(Q=n.settings)==null?void 0:Q.max_date,error:t.form.errors[`results.${(B=n.inspection_point)==null?void 0:B.id}.note`],onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):l("",!0),n.input_type==="textarea"&&R(n)?(s(),Se(Ct,{key:4,modelValue:t.form.results[(oe=n.inspection_point)==null?void 0:oe.id].note,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"note")}],required:(he=n.settings)==null?void 0:he.is_required,"min-length":(xe=n.settings)==null?void 0:xe.min_length,"max-length":(ge=n.settings)==null?void 0:ge.max_length,placeholder:((Ve=n.settings)==null?void 0:Ve.placeholder)||"Masukkan teks di sini",settings:n.settings,error:t.form.errors[`results.${(qe=n.inspection_point)==null?void 0:qe.id}.note`],onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):l("",!0),n.input_type==="radio"&&R(n)?(s(),Se(ho,{key:5,modelValue:t.form.results[(Ke=n.inspection_point)==null?void 0:Ke.id].status,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"status")}],notes:t.form.results[(He=n.inspection_point)==null?void 0:He.id].note,images:t.form.images[(Ge=n.inspection_point)==null?void 0:Ge.id],required:(ze=n.settings)==null?void 0:ze.is_required,"point-id":(We=n.inspection_point)==null?void 0:We.id,point:n.inspection_point,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(Je=n.inspection_point)==null?void 0:Je.name,subtitle:(Ze=n.inspection_point)==null?void 0:Ze.description,"selected-point":n.inspection_point??null,options:((Ye=n.settings)==null?void 0:Ye.radios)||q,error:t.form.errors[`results.${(Xe=n.inspection_point)==null?void 0:Xe.id}.status`],"onUpdate:notes":L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},"onUpdate:images":L=>{var h;return t.form.images[(h=n.inspection_point)==null?void 0:h.id]=L},onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)},onHapus:L=>{var h;return ce((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):l("",!0),n.input_type==="imageTOradio"&&R(n)?(s(),Se(To,{key:6,modelValue:t.form.results[(Qe=n.inspection_point)==null?void 0:Qe.id].status,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"status")}],notes:t.form.results[(et=n.inspection_point)==null?void 0:et.id].note,images:t.form.images[(tt=n.inspection_point)==null?void 0:tt.id],required:(at=n.settings)==null?void 0:at.is_required,"point-id":(nt=n.inspection_point)==null?void 0:nt.id,"inspection-id":t.inspectionId,settings:n.settings,"point-name":(st=n.inspection_point)==null?void 0:st.name,subtitle:(ot=n.inspection_point)==null?void 0:ot.description,point:n,"selected-point":n.inspection_point??null,options:((it=n.settings)==null?void 0:it.radios)||q,error:t.form.errors[`results.${(lt=n.inspection_point)==null?void 0:lt.id}.status`],"onUpdate:notes":L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},"onUpdate:images":L=>{var h;return t.form.images[(h=n.inspection_point)==null?void 0:h.id]=L},onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)},onHapus:L=>{var h;return ce((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):l("",!0),n.input_type==="image"&&R(n)?(s(),Se(Oe,{key:7,modelValue:t.form.images[(rt=n.inspection_point)==null?void 0:rt.id],"onUpdate:modelValue":L=>{var h;return t.form.images[(h=n.inspection_point)==null?void 0:h.id]=L},error:t.form.errors[`images.${(dt=n.inspection_point)==null?void 0:dt.id}`],"inspection-id":t.inspectionId,"point-id":(ut=n.inspection_point)==null?void 0:ut.id,point:n.inspection_point,"point-name":(ct=n.inspection_point)==null?void 0:ct.name,settings:n.settings,"onUpdate:notes":L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].note=L},"onUpdate:status":L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=L}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):l("",!0),n.input_type==="select"&&R(n)?(s(),Se(Xa,{key:8,modelValue:t.form.results[(pt=n.inspection_point)==null?void 0:pt.id].status,"onUpdate:modelValue":[L=>{var h;return t.form.results[(h=n.inspection_point)==null?void 0:h.id].status=L},L=>{var h;return j((h=n.inspection_point)==null?void 0:h.id,L,"status")}],required:(mt=n.settings)==null?void 0:mt.is_required,error:t.form.errors[`results.${(gt=n.inspection_point)==null?void 0:gt.id}.status`],onSave:L=>{var h;return W((h=n.inspection_point)==null?void 0:h.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):l("",!0),!R(n)&&G(n)?(s(),o("div",Yo,[p[2]||(p[2]=e("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),p[3]||(p[3]=e("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),e("ul",Xo,[(vt=n.settings)!=null&&vt.transmission?(s(),o("li",Qo," Transmisi: "+V(O(n.settings.transmission).join(", ")),1)):l("",!0),(ft=n.settings)!=null&&ft.fuel_type?(s(),o("li",ei," Bahan bakar: "+V(n.settings.fuel_type),1)):l("",!0),(ht=n.settings)!=null&&ht.rear_door?(s(),o("li",ti,"Kendaraan dengan pintu belakang")):l("",!0),(bt=n.settings)!=null&&bt.pick_up?(s(),o("li",ai,"Tipe pick up")):l("",!0),(yt=n.settings)!=null&&yt.box?(s(),o("li",ni,"Kendaraan dengan box")):l("",!0)])])):l("",!0)]))],2)}),128)),M.value.filter(n=>!n.is_link).length===0?(s(),o("div",si,[p[4]||(p[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),p[5]||(p[5]=e("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),t.category.isDamageMenu?(s(),o("p",oi,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):l("",!0)])):l("",!0)])],2)],64))}},Li=Ne(ii,[["__scopeId","data-v-21688412"]]),li={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},ri={class:"p-4 space-y-4-6"},di={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},ui=["value"],ci={class:"p-4 space-y-4-6"},pi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},mi=["value"],gi={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},vi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},fi=["value"],hi={class:"p-4 space-y-2"},bi={class:"flex items-center justify-between mb-2"},yi={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},xi={class:"flex items-center justify-between mb-3"},wi={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},ki=["onClick"],Ii={class:"text-sm font-medium text-gray-800 mb-1"},$i={class:"text-xs text-gray-600 line-clamp-2"},Si={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},_i={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},Ai={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ci={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ti={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ni={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(t,{emit:Z}){const a=t,b=Z,r=$(null),m=$(!1),v=$(!1),u=wt({bold:!1,italic:!1,underline:!1}),i=wt({flooded:"",collision:"",collision_severity:"",notes:""}),y=$([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`}]);$(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const _=n=>{if(!n)return{};if(typeof n=="string")try{return JSON.parse(n)||{}}catch(c){return console.error("Error parsing settings JSON:",c),{}}return typeof n=="object"&&n!==null?n:{}};ne(()=>_(a.inspection.settings).conclusion||{});const w=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],P=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],O=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];Pe(()=>{G(),Fe(()=>{R(),k()})});const R=()=>{r.value&&i.notes&&(r.value.innerHTML=i.notes)},G=()=>{const c=_(a.inspection.settings).conclusion||{},E=a.form.conclusion||{};i.flooded=E.flooded||c.flooded||"",i.collision=E.collision||c.collision||"",i.collision_severity=E.collision_severity||c.collision_severity||"",i.notes=E.notes||a.inspection.notes||""},K=n=>{if(!r.value)return;let c=n.content;c=c.replace(/{PLATE_NUMBER}/g,a.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,a.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,i.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,i.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),r.value.innerHTML=c,i.notes=c,v.value=!1,Fe(()=>{r.value.focus(),p()})},M=()=>{r.value&&(r.value.innerHTML="",i.notes="",p())},k=()=>{if(!r.value)return;const n=window.getSelection();n.rangeCount===0||n.isCollapsed||(u.bold=document.queryCommandState("bold"),u.italic=document.queryCommandState("italic"),u.underline=document.queryCommandState("underline"))},z=n=>{if(!r.value)return;r.value.focus();const c=u[n];switch(n){case"bold":document.execCommand("bold",!1,!c);break;case"italic":document.execCommand("italic",!1,!c);break;case"underline":document.execCommand("underline",!1,!c);break}setTimeout(()=>{k(),q()},10)},q=It.debounce(()=>{r.value&&(i.notes=r.value.innerHTML,p())},200),N=n=>{n.preventDefault(),document.execCommand("insertParagraph",!1,null)},j=n=>{n.preventDefault();const c=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,c)},W=()=>{m.value=!0},ce=()=>{m.value=!1,r.value&&(i.notes=r.value.innerHTML,p())},A=()=>{p()},p=()=>{const n={flooded:i.flooded,collision:i.collision,collision_severity:i.collision==="yes"?i.collision_severity:null,notes:i.notes};b("updateConclusion",n)};return ve(()=>a.form.conclusion,n=>{n&&(i.flooded=n.flooded!==void 0?n.flooded:i.flooded,i.collision=n.collision!==void 0?n.collision:i.collision,i.collision_severity=n.collision_severity!==void 0?n.collision_severity:i.collision_severity,i.notes=n.notes!==void 0?n.notes:i.notes,r.value&&n.notes!==void 0&&r.value.innerHTML!==n.notes&&(r.value.innerHTML=n.notes))},{deep:!0,immediate:!0}),ve([()=>i.flooded,()=>i.collision,()=>i.collision_severity,()=>i.notes],()=>{p()},{deep:!0}),(n,c)=>(s(),o("div",li,[c[21]||(c[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),e("div",ri,[c[10]||(c[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[we(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",di,[(s(),o(Ie,null,$e(w,E=>e("label",{key:E.value,class:"cursor-pointer"},[Ce(e("input",{type:"radio","onUpdate:modelValue":c[0]||(c[0]=X=>i.flooded=X),value:E.value,class:"hidden peer",onChange:A},null,40,ui),[[je,i.flooded]]),e("div",{class:ee(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.flooded===E.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.flooded!==E.value}])},V(E.label),3)])),64))])]),e("div",ci,[c[12]||(c[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[we(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",pi,[(s(),o(Ie,null,$e(P,E=>e("label",{key:E.value,class:"cursor-pointer"},[Ce(e("input",{type:"radio","onUpdate:modelValue":c[1]||(c[1]=X=>i.collision=X),value:E.value,class:"hidden peer",onChange:A},null,40,mi),[[je,i.collision]]),e("div",{class:ee(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":i.collision===E.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":i.collision!==E.value}])},V(E.label),3)])),64))]),ke(Le,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Te(()=>[i.collision==="yes"?(s(),o("div",gi,[c[11]||(c[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[we("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",vi,[(s(),o(Ie,null,$e(O,E=>e("label",{key:E.value,class:"cursor-pointer"},[Ce(e("input",{type:"radio","onUpdate:modelValue":c[2]||(c[2]=X=>i.collision_severity=X),value:E.value,class:"hidden peer",onChange:A},null,40,fi),[[je,i.collision_severity]]),e("div",{class:ee(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":i.collision_severity===E.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":i.collision_severity!==E.value}])},V(E.label),3)])),64))])])):l("",!0)]),_:1})]),e("div",hi,[e("div",bi,[c[14]||(c[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),e("button",{type:"button",onClick:c[3]||(c[3]=E=>v.value=!v.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},c[13]||(c[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),we(" Template ")]))]),ke(Le,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Te(()=>[v.value?(s(),o("div",yi,[e("div",xi,[c[16]||(c[16]=e("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),e("button",{onClick:c[4]||(c[4]=E=>v.value=!1),class:"text-gray-400 hover:text-gray-600"},c[15]||(c[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",wi,[(s(!0),o(Ie,null,$e(y.value,E=>(s(),o("button",{key:E.id,onClick:X=>K(E),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[e("div",Ii,V(E.name),1),e("div",$i,V(E.description),1)],8,ki))),128))])])):l("",!0)]),_:1}),e("div",Si,[e("button",{type:"button",onClick:c[5]||(c[5]=E=>z("bold")),class:ee(["p-2 rounded transition-all duration-150 ease-in-out font-medium",u.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},c[17]||(c[17]=[e("strong",null,"B",-1)]),2),e("button",{type:"button",onClick:c[6]||(c[6]=E=>z("italic")),class:ee(["p-2 rounded transition-all duration-150 ease-in-out font-medium",u.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},c[18]||(c[18]=[e("em",null,"I",-1)]),2),e("button",{type:"button",onClick:c[7]||(c[7]=E=>z("underline")),class:ee(["p-2 rounded transition-all duration-150 ease-in-out font-medium",u.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},c[19]||(c[19]=[e("u",null,"U",-1)]),2),e("button",{type:"button",onClick:c[8]||(c[8]=E=>M()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," 🗑️ Clear ")]),ke(Le,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Te(()=>[Object.values(u).some(E=>E)?(s(),o("div",_i,[c[20]||(c[20]=we(" Format aktif: ")),u.bold?(s(),o("span",Ai,"Bold")):l("",!0),u.italic?(s(),o("span",Ci,"Italic")):l("",!0),u.underline?(s(),o("span",Ti,"Underline")):l("",!0)])):l("",!0)]),_:1}),e("div",{ref_key:"editorRef",ref:r,contenteditable:"true",class:ee(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!m.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":m.value}]),onInput:c[9]||(c[9]=(...E)=>Ee(q)&&Ee(q)(...E)),onBlur:ce,onFocus:W,onKeydown:Mt(N,["enter"]),onPaste:j,onMouseup:k,onKeyup:k,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},Ri=Ne(Ni,[["__scopeId","data-v-e09db1bd"]]);export{js as B,Li as C,Di as V,Tt as _,Ri as a};
