import{x as ie,e as d,o,a as r,t as h,F as f,h as _,j as re,f as c,g as ae,l as m,A as X,u,s as y,v as de,y as Y}from"./app-CD-ePhpI.js";const oe={class:"container mx-auto px-4 py-8"},ne={class:"text-2xl font-bold mb-6"},ue={class:"text-xl font-semibold mb-4"},ce={class:"flex items-start justify-between mb-2"},me={class:"block text-sm font-medium text-gray-700"},ge={key:0,class:"text-red-500"},fe={key:0,class:"mt-1"},_e=["onUpdate:modelValue","type","required","minlength","maxlength","pattern","placeholder"],he={key:1,class:"mt-1"},be=["onUpdate:modelValue","type","required","min","max","step"],xe={key:2,class:"mt-1"},ye=["onUpdate:modelValue","required","min","max"],pe={key:3,class:"mt-1"},ve=["onUpdate:modelValue","required","minlength","maxlength","placeholder"],we={key:4,class:"mt-2 space-y-2"},ke=["onUpdate:modelValue","value","required"],qe={class:"ml-2 block text-sm text-gray-700"},Ue={key:5,class:"mt-1"},Ve=["onUpdate:modelValue","required"],Oe=["value"],Ae={key:6,class:"space-y-4"},Ce={class:"mt-1"},je=["onUpdate:modelValue","required","onChange"],Fe=["value"],De={key:0,class:"mt-2"},Se=["onUpdate:modelValue","required","minlength","maxlength","placeholder"],Ne={key:1,class:"mt-2"},Ee=["onChange","required"],Me={key:0,class:"mt-2 flex flex-wrap gap-2"},Re=["src"],$e=["onClick"],Te={key:7,class:"mt-2"},Be=["onChange","required"],Ie={key:0,class:"mt-2 flex flex-wrap gap-2"},Le=["src"],ze=["onClick"],Je={class:"mt-2"},Ge=["onUpdate:modelValue"],Ke={__name:"Create copy",props:{inspection:Object,categories:Array},setup(p){const b=p,Z=()=>{const t={};return Array.isArray(b.categories)&&b.categories.forEach(a=>{a.inspection_points&&Array.isArray(a.inspection_points)&&a.inspection_points.forEach(i=>{t[i.id]={inspection_point_id:i.id,value:i.input_type==="checkbox"?[]:"",notes:"",images:[]}})}),t},s=ie({inspection_id:b.inspection.id,results:Z()}),ee=t=>{var i;if(!((i=t.settings)!=null&&i.options)||!s.results[t.id])return;t.settings.options.find(n=>n.value===s.results[t.id].value)&&(s.results[t.id].notes="",s.results[t.id].images=[])},se=t=>{var i,n;return t.input_type!=="option"||!((i=t.settings)!=null&&i.show_textarea)||!s.results[t.id]?!1:((n=t.settings.options)==null?void 0:n.find(e=>e.value===s.results[t.id].value))&&t.settings.show_textarea},te=t=>{var i,n;return t.input_type!=="option"||!((i=t.settings)!=null&&i.show_image_upload)||!s.results[t.id]?!1:((n=t.settings.options)==null?void 0:n.find(e=>e.value===s.results[t.id].value))&&t.settings.show_image_upload},w=(t,a)=>{if(!t.target.files||!s.results[a])return;Array.from(t.target.files).forEach(n=>{const e=new FileReader;e.onload=x=>{s.results[a].images||(s.results[a].images=[]),s.results[a].images.push({file:n,preview:x.target.result})},e.readAsDataURL(n)}),t.target.value=""},k=(t,a)=>{var i;(i=s.results[t])!=null&&i.images&&s.results[t].images.splice(a,1)},le=()=>{if(!s.results){console.error("No results data available");return}const t=new FormData;t.append("inspection_id",s.inspection_id);const a=Object.values(s.results).filter(i=>i!==null&&typeof i=="object").map(i=>{const n={...i};return n.images&&Array.isArray(n.images)?n.images=n.images.filter(e=>e&&e.file).map(e=>e.file):delete n.images,n});t.append("results",JSON.stringify(a)),Object.values(s.results).filter(i=>i&&i.images&&Array.isArray(i.images)).forEach(i=>{i.images.forEach((n,e)=>{n&&n.file&&t.append(`images[${i.inspection_point_id}][${e}]`,n.file)})}),s.post(route("inspections.store-results",b.inspection.id),{forceFormData:!0,onSuccess:()=>s.reset()})};return(t,a)=>{var i;return o(),d("div",oe,[r("h1",ne,"Vehicle Inspection: "+h(((i=p.inspection.car)==null?void 0:i.brand_id)||"Unknown Vehicle"),1),r("form",{onSubmit:re(le,["prevent"]),class:"space-y-8"},[(o(!0),d(f,null,_(p.categories,n=>(o(),d("div",{key:n.id,class:"bg-white shadow rounded-lg p-6"},[r("h2",ue,h(n.name),1),(o(!0),d(f,null,_(n.points,e=>{var x,q,U,V,O,A,C,j,F,D,S,N,E,M,R,$,T,B,I,L,z,J,G,H,K,P,Q,W;return o(),d("div",{key:e.id,class:"mb-6"},[r("div",ce,[r("label",me,[ae(h(e.name)+" ",1),(x=e.settings)!=null&&x.is_required?(o(),d("span",ge,"*")):c("",!0)])]),e.input_type==="text"?(o(),d("div",fe,[m(r("input",{"onUpdate:modelValue":l=>u(s).results[e.id].value=l,type:e.input_type,required:(q=e.settings)==null?void 0:q.is_required,minlength:(U=e.settings)==null?void 0:U.min_length,maxlength:(V=e.settings)==null?void 0:V.max_length,pattern:(O=e.settings)==null?void 0:O.pattern,placeholder:(A=e.settings)==null?void 0:A.placeholder,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,_e),[[X,u(s).results[e.id].value]])])):c("",!0),e.input_type==="number"?(o(),d("div",he,[m(r("input",{"onUpdate:modelValue":l=>u(s).results[e.id].value=l,type:e.input_type,required:(C=e.settings)==null?void 0:C.is_required,min:(j=e.settings)==null?void 0:j.min,max:(F=e.settings)==null?void 0:F.max,step:(D=e.settings)==null?void 0:D.step,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,be),[[X,u(s).results[e.id].value]])])):c("",!0),e.input_type==="date"?(o(),d("div",xe,[m(r("input",{"onUpdate:modelValue":l=>u(s).results[e.id].value=l,type:"date",required:(S=e.settings)==null?void 0:S.is_required,min:(N=e.settings)==null?void 0:N.min_date,max:(E=e.settings)==null?void 0:E.max_date,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,ye),[[y,u(s).results[e.id].value]])])):c("",!0),e.input_type==="textarea"?(o(),d("div",pe,[m(r("textarea",{"onUpdate:modelValue":l=>u(s).results[e.id].value=l,required:(M=e.settings)==null?void 0:M.is_required,minlength:(R=e.settings)==null?void 0:R.min_length,maxlength:($=e.settings)==null?void 0:$.max_length,placeholder:(T=e.settings)==null?void 0:T.placeholder,rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,ve),[[y,u(s).results[e.id].value]])])):c("",!0),e.input_type==="checkbox"?(o(),d("div",we,[(o(!0),d(f,null,_((B=e.settings)==null?void 0:B.options,l=>{var g;return o(),d("div",{key:l.value,class:"flex items-center"},[m(r("input",{"onUpdate:modelValue":v=>u(s).results[e.id].value=v,type:"checkbox",value:l.value,required:((g=e.settings)==null?void 0:g.is_required)&&u(s).results[e.id].value.length===0,class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,8,ke),[[de,u(s).results[e.id].value]]),r("label",qe,h(l.label),1)])}),128))])):c("",!0),e.input_type==="select"?(o(),d("div",Ue,[m(r("select",{"onUpdate:modelValue":l=>u(s).results[e.id].value=l,required:(I=e.settings)==null?void 0:I.is_required,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[a[0]||(a[0]=r("option",{value:""},"-- Select an option --",-1)),(o(!0),d(f,null,_((L=e.settings)==null?void 0:L.options,l=>(o(),d("option",{key:l.value,value:l.value},h(l.label),9,Oe))),128))],8,Ve),[[Y,u(s).results[e.id].value]])])):c("",!0),e.input_type==="option"?(o(),d("div",Ae,[r("div",Ce,[m(r("select",{"onUpdate:modelValue":l=>u(s).results[e.id].value=l,required:(z=e.settings)==null?void 0:z.is_required,onChange:l=>ee(e),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[a[1]||(a[1]=r("option",{value:""},"-- Select an option --",-1)),(o(!0),d(f,null,_((J=e.settings)==null?void 0:J.options,l=>(o(),d("option",{key:l.value,value:l.value},h(l.label),9,Fe))),128))],40,je),[[Y,u(s).results[e.id].value]])]),se(e)?(o(),d("div",De,[a[2]||(a[2]=r("label",{class:"block text-sm font-medium text-gray-700"},"Additional Notes",-1)),m(r("textarea",{"onUpdate:modelValue":l=>u(s).results[e.id].notes=l,required:t.isTextareaRequiredForOption(e),minlength:(G=e.settings)==null?void 0:G.textarea_min_length,maxlength:(H=e.settings)==null?void 0:H.textarea_max_length,placeholder:(K=e.settings)==null?void 0:K.textarea_placeholder,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Se),[[y,u(s).results[e.id].notes]])])):c("",!0),te(e)?(o(),d("div",Ne,[a[3]||(a[3]=r("label",{class:"block text-sm font-medium text-gray-700"},"Upload Images",-1)),r("input",{type:"file",multiple:"",onChange:l=>w(l,e.id),required:t.isImageUploadRequiredForOption(e),accept:"image/*",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"},null,40,Ee),(P=u(s).results[e.id].images)!=null&&P.length?(o(),d("div",Me,[(o(!0),d(f,null,_(u(s).results[e.id].images,(l,g)=>(o(),d("div",{key:g,class:"relative"},[r("img",{src:l.preview,class:"h-20 w-20 object-cover rounded"},null,8,Re),r("button",{type:"button",onClick:v=>k(e.id,g),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs"}," × ",8,$e)]))),128))])):c("",!0)])):c("",!0)])):c("",!0),e.input_type==="image"?(o(),d("div",Te,[r("input",{type:"file",multiple:"",onChange:l=>w(l,e.id),required:(Q=e.settings)==null?void 0:Q.is_required,accept:"image/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"},null,40,Be),(W=u(s).results[e.id].images)!=null&&W.length?(o(),d("div",Ie,[(o(!0),d(f,null,_(u(s).results[e.id].images,(l,g)=>(o(),d("div",{key:g,class:"relative"},[r("img",{src:l.preview,class:"h-20 w-20 object-cover rounded"},null,8,Le),r("button",{type:"button",onClick:v=>k(e.id,g),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs"}," × ",8,ze)]))),128))])):c("",!0)])):c("",!0),r("div",Je,[a[4]||(a[4]=r("label",{class:"block text-sm font-medium text-gray-700"},"Additional Notes",-1)),m(r("textarea",{"onUpdate:modelValue":l=>u(s).results[e.id].notes=l,rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Ge),[[y,u(s).results[e.id].notes]])])])}),128))]))),128)),a[5]||(a[5]=r("div",{class:"flex justify-end"},[r("button",{type:"submit",class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring focus:ring-indigo-300 disabled:opacity-25 transition"}," Submit Inspection ")],-1))],32)])}}};export{Ke as default};
