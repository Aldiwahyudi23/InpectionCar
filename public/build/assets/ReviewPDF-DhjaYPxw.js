import{_ as Q}from"./app-eLJ9d_d5.js";import{r as B,q as H,c as o,o as r,b as y,d as e,t as i,F as m,m as v,n as V}from"./vendor-Dy3A47bM.js";const X={class:"p-6 bg-white rounded-lg shadow-md"},Y={key:0,class:"mt-2 mb-6"},Z={key:1},tt={class:"header flex flex-col gap-5 mb-6 mt-6"},et={class:"flex items-center gap-5"},st=["src"],ot={key:1,class:"w-40 h-40 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-gray-400"},rt={class:"mt-8"},nt={class:"text-3xl font-bold m-0 text-gray-800"},at={key:0,class:"car-info"},it={class:"w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"},dt={class:"bg-gray-50"},lt={class:"p-2 border border-gray-300 text-gray-600"},ct={class:"p-2 border border-gray-300 text-gray-600"},ut={class:"bg-gray-50"},gt={class:"p-2 border border-gray-300 text-gray-600"},bt={class:"p-2 border border-gray-300 text-gray-600"},yt={class:"bg-gray-50"},pt={class:"p-2 border border-gray-300 text-gray-600"},mt={class:"p-2 border border-gray-300 text-gray-600"},ft={class:"bg-gray-50"},xt={class:"p-2 border border-gray-300 text-gray-600"},ht={class:"p-2 border border-gray-300 text-gray-600"},kt={class:"bg-gray-50"},_t={class:"p-2 border border-gray-300 text-gray-600"},vt={class:"bg-gray-50"},wt={class:"p-2 border border-gray-300 text-gray-600"},It={class:"bg-gray-50"},jt={class:"p-2 border border-gray-300 text-gray-600"},Ft={class:"bg-gray-50"},Dt={class:"p-2 border border-gray-300 text-gray-600"},Tt={class:"bg-gray-50"},Ct={class:"p-2 border border-gray-300 text-gray-600"},St={key:1,class:"conclusion p-4 bg-gray-50 border-l-4 border-gray-800 rounded-lg"},Lt={class:"m-0 text-gray-600"},Nt=["innerHTML"],Ot={class:"component-title bg-gray-100 px-3 py-2 border-l-4 border-gray-800 font-bold rounded-l-lg"},Pt={key:0,class:"images flex flex-wrap gap-2 mt-4"},Mt=["src"],Kt={key:1,class:"w-28 h-28 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},Rt={class:"point-name inline-block min-w-[160px] font-bold align-top text-gray-700"},Bt={class:"point-content inline-block w-[calc(100%-170px)] align-top"},Ht={key:1,class:"point-note italic text-gray-600 my-1"},Vt={key:0,class:"inspection-images flex flex-wrap gap-2 mt-4"},At=["src"],Et={key:1,class:"w-20 h-20 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},Gt={key:1,class:"textarea-note italic text-gray-600 my-2"},Ut={key:2,class:"flex flex-col items-center justify-center h-96 text-center"},$t=["href"],qt={key:3,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},zt={class:"bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm"},Jt={class:"flex justify-end space-x-4"},Wt=["disabled"],Qt={key:0},Xt={key:1},Yt={key:1,class:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 cursor-not-allowed"},Zt={__name:"ReviewPDF",props:{inspection:{type:Object,required:!0},menu_points:{type:Array,default:()=>[]},coverImage:{type:Object,default:null},encryptedIds:Object},setup(n){const f=n,w=B(!1),I=B(!1),A=H(()=>{const s={};return f.menu_points.forEach(t=>{var c,l;const a=((l=(c=t.inspection_point)==null?void 0:c.component)==null?void 0:l.name)||"Tanpa Komponen";s[a]||(s[a]=[]),s[a].push(t)}),s}),E=()=>{I.value=!0,setTimeout(()=>{window.location.href=route("inspections.download.pdf",f.encryptedIds),I.value=!1,w.value=!1},2e3)},G=H(()=>{if(f.inspection.notes)return!0;const s=f.menu_points.some(a=>j(a)||S(a)),t=f.coverImage&&f.coverImage.image_path;return s||t}),T=s=>s&&s.length>0,C=s=>`/${s}`,j=s=>{var t;return((t=s.inspection_point)==null?void 0:t.results)&&s.inspection_point.results.length>0},S=s=>{var t;return((t=s.inspection_point)==null?void 0:t.images)&&s.inspection_point.images.length>0},N=s=>j(s)&&s.inspection_point.results[0].note,U=s=>{var c,l,u;const t=s.input_type||"",a=(u=(l=(c=s.inspection_point)==null?void 0:c.results)==null?void 0:l[0])==null?void 0:u.status;return["radio","imageTOradio"].includes(t)&&a},$=s=>{const t=s.input_type||"";return["text","number","date","textarea"].includes(t)&&N(s)},q=s=>{var b,g,p,x;const t=s.input_type||"",a=s.settings||{},c=((g=(b=s.inspection_point)==null?void 0:b.results)==null?void 0:g[0])||{},u=((x=(((p=a.radios)==null?void 0:p.find(k=>k.value===c.status))||{}).settings)==null?void 0:x.show_image_upload)||!1;return(t==="image"||t==="imageTOradio"||t==="radio"&&u)&&S(s)},z=s=>{var l,u,b,g;const t=s.settings||{},a=((u=(l=s.inspection_point)==null?void 0:l.results)==null?void 0:u[0])||{};return((g=(((b=t.radios)==null?void 0:b.find(p=>p.value===a.status))||{}).settings)==null?void 0:g.show_textarea)||!1},J=s=>{if(!s)return"status-warning";const t=s.toLowerCase();return["normal","ada","baik","good","ok"].includes(t)?"status-good":["tidak normal","tidak ada","rusak","bad","not ok"].includes(t)?"status-bad":"status-warning"},W=s=>{var l,u;const t=s.input_type||"",a=((u=(l=s.inspection_point)==null?void 0:l.results)==null?void 0:u[0])||{},c=s.settings||{};if(t==="account"&&a.note){const b=a.note.replace(/[^\d.-]/g,""),g=parseFloat(b);if(isNaN(g))return a.note;const p=c.currency_symbol||"Rp";return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:2}).format(g).replace("Rp",p)}return a.note};return(s,t)=>{var a,c,l,u,b,g,p,x,k,O,P;return r(),o("div",X,[n.inspection.status==="pending_review"?(r(),o("div",Y,[e("button",{onClick:t[0]||(t[0]=F=>w.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"}," Setujui Laporan "),t[2]||(t[2]=e("p",{class:"text-sm text-gray-500 mt-2 italic"}," Catatan: Halaman ini hanya simulasi dan mungkin berbeda dengan tampilan file PDF. Silakan periksa lebih detail untuk memastikan tidak ada kesalahan. Jika sudah yakin, silakan setujui untuk proses selanjutnya. ",-1))])):y("",!0),G.value?(r(),o("div",Z,[e("div",tt,[e("div",et,[n.coverImage&&T(n.coverImage.image_path)?(r(),o("img",{key:0,src:C(n.coverImage.image_path),alt:"Foto Utama",class:"w-40 h-40 object-cover rounded-lg border border-gray-300"},null,8,st)):(r(),o("div",ot,t[3]||(t[3]=[e("span",null,"Gambar tidak tersedia",-1)]))),e("div",rt,[e("h2",nt,i(n.inspection.car_name),1)])]),n.inspection.car_id?(r(),o("div",at,[e("table",it,[e("tr",dt,[t[4]||(t[4]=e("td",{class:"p-2 border border-gray-300 font-bold w-1/3 text-gray-700"},"Nomor Polisi",-1)),e("td",lt,i(n.inspection.plate_number),1)]),e("tr",null,[t[5]||(t[5]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Merek",-1)),e("td",ct,i((c=(a=n.inspection.car)==null?void 0:a.brand)==null?void 0:c.name),1)]),e("tr",ut,[t[6]||(t[6]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Model",-1)),e("td",gt,i((u=(l=n.inspection.car)==null?void 0:l.model)==null?void 0:u.name),1)]),e("tr",null,[t[7]||(t[7]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tipe",-1)),e("td",bt,i((g=(b=n.inspection.car)==null?void 0:b.type)==null?void 0:g.name),1)]),e("tr",yt,[t[8]||(t[8]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"CC",-1)),e("td",pt,i((p=n.inspection.car)==null?void 0:p.cc),1)]),e("tr",null,[t[9]||(t[9]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Bahan Bakar",-1)),e("td",mt,i((x=n.inspection.car)==null?void 0:x.fuel_type),1)]),e("tr",ft,[t[10]||(t[10]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Transmisi",-1)),e("td",xt,i((k=n.inspection.car)==null?void 0:k.transmission),1)]),e("tr",null,[t[11]||(t[11]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Periode Model",-1)),e("td",ht,i(((O=n.inspection.car)==null?void 0:O.production_period)||"-"),1)]),e("tr",kt,[t[12]||(t[12]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tahun Pembuatan",-1)),e("td",_t,i((P=n.inspection.car)==null?void 0:P.year),1)]),e("tr",vt,[t[13]||(t[13]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Warna",-1)),e("td",wt,i(n.inspection.color),1)]),e("tr",It,[t[14]||(t[14]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"No Rangka",-1)),e("td",jt,i(n.inspection.noka),1)]),e("tr",Ft,[t[15]||(t[15]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"No Mesin",-1)),e("td",Dt,i(n.inspection.nosin),1)]),e("tr",Tt,[t[16]||(t[16]=e("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"KM",-1)),e("td",Ct,i(n.inspection.km),1)])])])):y("",!0),n.inspection.notes?(r(),o("div",St,[t[17]||(t[17]=e("h3",{class:"text-lg font-bold mb-2 text-gray-800"},"Kesimpulan Inspeksi:",-1)),e("p",Lt,[e("div",{innerHTML:n.inspection.notes||"-"},null,8,Nt)])])):y("",!0)]),t[20]||(t[20]=e("h2",{class:"text-2xl font-bold border-b-2 border-gray-800 pb-2 mb-6"},"Hasil Inspeksi",-1)),(r(!0),o(m,null,v(A.value,(F,D)=>(r(),o("div",{key:D,class:V(["section mb-6",D==="Foto Kendaraan"?"photo-component":""])},[e("div",Ot,i(D||"Tanpa Komponen"),1),D==="Foto Kendaraan"?(r(),o("div",Pt,[(r(!0),o(m,null,v(F,d=>{var _;return r(),o("div",{key:d.id},[(r(!0),o(m,null,v((_=d.inspection_point)==null?void 0:_.images,h=>(r(),o("div",{key:h.id,class:"image-container"},[T(h.image_path)?(r(),o("img",{key:0,src:C(h.image_path),alt:"Foto Kendaraan",class:"w-28 h-28 object-cover border border-gray-300 rounded-lg"},null,8,Mt)):(r(),o("div",Kt,t[18]||(t[18]=[e("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])}),128))])):(r(!0),o(m,{key:1},v(F,d=>{var _,h,M,K,R;return r(),o("div",{key:d.id,class:"point ml-4 py-3 border-b border-gray-100"},[j(d)||S(d)?(r(),o(m,{key:0},[e("span",Rt,i(((_=d.inspection_point)==null?void 0:_.name)||"-"),1),e("div",Bt,[j(d)?(r(),o(m,{key:0},[U(d)?(r(),o("span",{key:0,class:V(["status-badge",J((h=d.inspection_point)==null?void 0:h.results[0].status)])},i((M=d.inspection_point)==null?void 0:M.results[0].status),3)):y("",!0),$(d)?(r(),o("div",Ht,i(W(d)),1)):y("",!0)],64)):y("",!0)]),q(d)?(r(),o("div",Vt,[(r(!0),o(m,null,v((K=d.inspection_point)==null?void 0:K.images,L=>(r(),o("div",{key:L.id,class:"image-container"},[T(L.image_path)?(r(),o("img",{key:0,src:C(L.image_path),alt:"image",class:"w-20 h-20 object-cover border border-gray-300 rounded-lg"},null,8,At)):(r(),o("div",Et,t[19]||(t[19]=[e("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])):y("",!0),z(d)&&N(d)?(r(),o("div",Gt,i((R=d.inspection_point)==null?void 0:R.results[0].note),1)):y("",!0)],64)):y("",!0)])}),128))],2))),128))])):(r(),o("div",Ut,[t[21]||(t[21]=e("p",{class:"text-lg font-semibold text-gray-700"}," Data sudah tidak ada, karena sudah dijadikan PDF. ",-1)),e("a",{href:s.route("inspections.download.pdf",n.encryptedIds),class:"mt-4 inline-block bg-blue-600 text-white px-6 py-3 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Download PDF ",8,$t)])),w.value?(r(),o("div",qt,[e("div",zt,[t[23]||(t[23]=e("h3",{class:"text-lg font-bold mb-4"},"Konfirmasi Laporan",-1)),t[24]||(t[24]=e("p",{class:"text-gray-700 mb-6"}," Apakah Anda yakin semua data sudah sesuai? Setelah disetujui, laporan akan diproses menjadi file PDF. ",-1)),e("div",Jt,[e("button",{onClick:t[1]||(t[1]=F=>w.value=!1),class:"bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400"}," Batal "),n.inspection.file?(r(),o("button",Yt,t[22]||(t[22]=[e("span",null,"Laporan sudah di buat",-1)]))):(r(),o("button",{key:0,onClick:E,class:"bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors duration-200",disabled:I.value},[I.value?(r(),o("span",Qt,"Membuat file PDF...")):(r(),o("span",Xt,"Setujui Laporan"))],8,Wt))])])])):y("",!0)])}}},se=Q(Zt,[["__scopeId","data-v-8fa714cc"]]);export{se as default};
