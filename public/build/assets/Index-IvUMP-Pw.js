import{c as a,o as r,d as t,r as v,x as G,q as C,j as k,w as f,k as l,b as c,u as d,v as ee,F as te,m as se,t as o,S as M,f as u,n as b,z as ne,A as oe}from"./vendor-CV8_PVEu.js";import{A as re}from"./AppLayout-C3_KQ4lg.js";import{r as ae,C as j}from"./car-Dv69S49J.js";import{r as ie}from"./XMarkIcon-g01br1cz.js";import"./app-AbXrvANo.js";function de(p,m){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})])}function le(p,m){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}const ce={class:"w-full px-4 sm:px-6 lg:px-6 py-6"},ue={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2"},me={class:"p-4 flex justify-between items-start"},pe={class:"flex items-center mb-1"},ge={class:"text-sm font-semibold text-blue-700 ml-7 -mt-1"},xe={class:"px-4 py-3 bg-gray-50 border-t border-gray-100"},ye={class:"flex items-center"},be={class:"text-sm font-medium text-gray-800"},ve={key:0},fe={class:"text-gray-600"},_e={key:1},he={class:"flex items-center mt-2"},we={class:"text-sm font-bold text-gray-900"},Ie={class:"py-3 bg-white border-t border-gray-100"},Ce={class:"flex items-center justify-between"},Me={class:"text-sm font-semibold text-gray-800"},je={class:"text-xs text-gray-600"},$e=["href"],Le={key:1,class:"mb-3 p-2 bg-yellow-50 border border-yellow-200 rounded"},Be={class:"grid grid-cols-2 gap-1 text-sm"},De={key:0},Ae={key:3,class:"p-2 bg-yellow-50 border border-yellow-200 rounded"},Se={key:0,class:"px-4 py-2 bg-white border-t border-gray-100"},Te={class:"text-sm text-gray-800"},Fe={class:"p-4 flex space-x-2"},He=["onClick"],Ne=["onClick","disabled"],Pe={key:1,class:"text-center py-8"},Re={class:"text-center mt-6"},ze={key:0,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50"},Ve={class:"bg-white rounded-lg shadow-xl max-w-md w-full"},Oe={class:"p-6"},Ke={class:"flex items-start mb-4"},qe={key:0},Ee={class:"font-medium text-gray-800"},Ge={class:"text-sm text-gray-600"},Je={class:"text-gray-500"},Ue={key:1,class:"text-sm font-medium text-gray-800"},We={class:"flex items-center mt-2"},Qe={class:"text-base font-bold text-gray-900"},Xe={class:"text-gray-600 mb-6"},Ye={key:0,class:"font-semibold text-gray-800"},Ze={class:"flex justify-end space-x-3"},ke=["disabled"],et={key:0},tt={key:1},st={key:1,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50"},nt={class:"bg-white rounded-lg shadow-xl max-w-md w-full"},ot={class:"p-6"},rt={class:"flex items-center justify-between mb-4"},at={class:"flex items-start mb-4"},it={key:0},dt={class:"font-medium text-gray-800"},lt={class:"text-sm text-gray-600"},ct={class:"text-gray-500"},ut={key:1,class:"text-sm font-medium text-gray-800"},mt={class:"flex items-center mt-2"},pt={class:"text-base font-bold text-gray-900"},gt={class:"mb-6"},xt={key:0,class:"text-red-500 text-sm mt-1"},yt={class:"flex justify-end space-x-3"},bt=["disabled"],vt={key:0},ft={key:1},Mt={__name:"Index",props:{tasks:Array,encryptedIds:Object,transaction:Object},setup(p){const m=p,_=v(!1),h=v(!1),n=v(null),g=v(""),w=G({}),J=i=>{n.value=i,_.value=!0},U=i=>{n.value=i,h.value=!0},y=()=>{_.value=!1,h.value=!1,g.value=""},x=G({reason:""}),W=()=>{n.value&&(x.reason=g.value,x.post(route("inspections.cancel",{inspection:m.encryptedIds[n.value.id]}),{onSuccess:()=>{y(),g.value=""}}))},Q=()=>{n.value&&w.get(route("inspections.start",{inspection:m.encryptedIds[n.value.id]}),{onFinish:()=>{y()}})},$=C(()=>m.tasks.some(i=>i.status==="in_progress"||i.status==="revision")),I=i=>{switch(i){case"draft":return"Mulai Inspeksi";case"in_progress":return"Lanjutkan Inspeksi";case"pending_review":return"Periksa Laporan";case"revision":return"Lanjutkan Revisi";case"pending":return"Ditunda => Lanjutkan Inspeksi";default:return"Detail"}},X=i=>{switch(i){case"draft":return"Memuat Halaman Inspeksi...";case"in_progress":return"Membuka Halaman Inspeksi...";case"pending_review":return"Memuat Halaman Review...";case"revision":return"Memual Halaman Revisi...";case"pending":return"Lanjutkan Inspeksi...";default:return"Detail"}};C(()=>{var i,s;return((s=(i=m.tasks)==null?void 0:i.transaction)==null?void 0:s.status)==="paid"}),C(()=>{var i,s;return((s=(i=m.tasks)==null?void 0:i.transaction)==null?void 0:s.status)==="pending"});const Y={pending:"Menunggu Pembayaran",paid:"Sudah di bayar",failed:"Gagal",refunded:"Dikembalikan",expired:"Kadaluarsa"};return(i,s)=>(r(),k(re,null,{default:f(()=>{var L,B,D,A,S,T,F,H,N,P;return[l(d(ee),{title:"Tugas"}),t("div",ce,[s[14]||(s[14]=t("h3",{class:"text-xl md:text-3xl font-bold text-gray-900 mb-6 text-center"}," Inspeksi yang Harus Diselesaikan ",-1)),p.tasks.length>0?(r(),a("div",ue,[(r(!0),a(te,null,se(p.tasks,e=>{var R,z,V,O,K,q,E;return r(),a("div",{key:e.id,class:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition"},[t("div",me,[t("div",null,[t("div",pe,[l(d(ae),{class:"h-5 w-5 text-blue-500 mr-2"}),s[1]||(s[1]=t("span",{class:"text-sm font-medium text-gray-600"},"Jadwal",-1))]),t("p",ge,o(new Date(e.inspection_date).toLocaleDateString("id-ID",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),l(d(M),{href:i.route("inspection.log",{inspection:p.encryptedIds[e.id]}),class:"text-xs font-semibold text-indigo-600 hover:underline"},{default:f(()=>s[2]||(s[2]=[u(" Lihat Log ")])),_:2,__:[2]},1032,["href"])]),t("div",xe,[t("div",ye,[l(d(j),{class:"h-5 w-5 text-gray-500 mr-2"}),t("div",be,[e.car?(r(),a("div",ve,[u(o(`${e.car.brand.name} ${e.car.model.name} ${e.car.type.name} ${(e.car.cc/1e3).toFixed(1)} ${e.car.transmission} ${e.car.year}`)+" ",1),t("span",fe,"("+o(e.car.fuel_type)+")",1)])):(r(),a("div",_e,o(e.car_name),1))])]),t("div",he,[s[3]||(s[3]=t("span",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500 mr-2"},"NO POLISI:",-1)),t("span",we,o(e.plate_number),1)]),t("div",Ie,[e.customer?(r(),a("div",{key:0,class:b(["mb-3 p-2 rounded",{"bg-green-50 border border-green-200":e.customer,"bg-yellow-50 border border-yellow-200":!e.customer}])},[s[5]||(s[5]=t("p",{class:"text-xs font-medium text-gray-500"},"Customer",-1)),t("div",Ce,[t("div",null,[t("p",Me,o(e.customer.name),1),t("p",je,o(e.customer.phone),1)]),e.customer.phone?(r(),a("a",{key:0,href:`https://wa.me/62${e.customer.phone.replace(/^0/,"")}`,target:"_blank",class:"text-green-600 hover:text-green-800 ml-2",title:"Hubungi via WhatsApp"},s[4]||(s[4]=[t("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.864 3.488"})],-1)]),8,$e)):c("",!0)])],2)):(r(),a("div",Le,s[6]||(s[6]=[t("p",{class:"text-xs text-yellow-700"},"Data customer belum tersedia",-1)]))),e.transaction?(r(),a("div",{key:2,class:b(["p-2 rounded",{"bg-green-50 border border-green-200":(e==null?void 0:e.transaction.status)==="paid","bg-red-50 border border-red-200":!(e!=null&&e.transaction.status)==="paid","bg-yellow-50 border border-yellow-200":((R=e==null?void 0:e.transaction)==null?void 0:R.status)==="pending"}])},[s[9]||(s[9]=t("p",{class:"text-xs font-medium text-gray-500"},"Pembayaran",-1)),t("div",Be,[s[7]||(s[7]=t("span",null,"Status:",-1)),t("span",{class:b({"text-green-600 font-semibold":(e==null?void 0:e.transaction.status)==="paid","text-yellow-600 font-semibold":((z=e==null?void 0:e.transaction)==null?void 0:z.status)==="pending","text-red-600 font-semibold":!(e!=null&&e.transaction.status)==="paid"&&!((V=e==null?void 0:e.transaction)!=null&&V.status)==="pending"})},o(Y[e.transaction.status]),3),s[8]||(s[8]=t("span",null,"Nominal:",-1)),t("span",{class:b({"text-green-700":(e==null?void 0:e.transaction.status)==="paid","text-yellow-700":((O=e==null?void 0:e.transaction)==null?void 0:O.status)==="pending","text-red-700":!(e!=null&&e.transaction.status)==="paid"&&!((K=e==null?void 0:e.transaction)!=null&&K.status)==="pending"})},o(new Intl.NumberFormat("id-ID").format(e.transaction.amount)),3),e.transaction.payment_method?(r(),a("span",De,"Metode:")):c("",!0),e.transaction.payment_method?(r(),a("span",{key:1,class:b({"text-green-700":(e==null?void 0:e.transaction.status)==="paid","text-yellow-700":((q=e==null?void 0:e.transaction)==null?void 0:q.status)==="pending","text-red-700":!(e!=null&&e.transaction.status)==="paid"&&!((E=e==null?void 0:e.transaction)!=null&&E.status)==="pending"})},o(e.transaction.payment_method),3)):c("",!0)])],2)):(r(),a("div",Ae,s[10]||(s[10]=[t("p",{class:"text-xs text-yellow-700"},"Data transaksi belum tersedia",-1)])))])]),e.category?(r(),a("div",Se,[s[11]||(s[11]=t("p",{class:"text-xs font-medium text-gray-500 tracking-wide"},"Kategori Inspek",-1)),t("p",Te,o(e.category.name),1)])):c("",!0),t("div",Fe,[t("button",{onClick:Z=>U(e),class:"flex-6 px-3 py-2 bg-gray-200 text-gray-700 font-medium rounded-md text-sm hover:bg-gray-300 transition-colors"}," Batal ",8,He),t("button",{onClick:Z=>J(e),disabled:$.value&&e.status!=="in_progress"&&e.status!=="revision",class:"flex-1 inline-flex items-center justify-center px-3 py-2 bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white font-medium rounded-md text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[u(o(I(e.status))+" ",1),l(d(de),{class:"ml-2 h-4 w-4"})],8,Ne)])])}),128))])):(r(),a("div",Pe,s[12]||(s[12]=[t("p",{class:"text-gray-500"},"Tidak ada tugas inspeksi yang tersedia.",-1)]))),t("div",Re,[l(d(M),{href:i.route("inspections.history"),class:"inline-block px-4 py-2 text-sm font-medium text-indigo-600 border border-indigo-600 rounded-md hover:bg-blue-50"},{default:f(()=>s[13]||(s[13]=[u(" Lihat Inspeksi Lainnya ")])),_:1,__:[13]},8,["href"])])]),l(d(M),{href:i.route("inspections.create.new"),class:"fixed bottom-24 right-6 z-40 p-4 bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white rounded-full transition-colors duration-200 animate-bounce",title:"Buat Inspeksi Baru"},{default:f(()=>[l(d(le),{class:"h-6 w-6"})]),_:1},8,["href"]),_.value?(r(),a("div",ze,[t("div",Ve,[t("div",Oe,[s[17]||(s[17]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Konfirmasi",-1)),t("div",Ke,[l(d(j),{class:"h-8 w-8 text-blue-500 mr-3 mt-1"}),t("div",null,[(L=n.value)!=null&&L.car?(r(),a("div",qe,[t("p",Ee,o(`${n.value.car.brand.name} ${n.value.car.model.name} ${n.value.car.type.name}`),1),t("p",Ge,[u(o(n.value.car.cc)+" • "+o(n.value.car.transmission)+" • "+o(n.value.car.year)+" ",1),t("span",Je,"("+o(n.value.car.fuel_type)+")",1)])])):(r(),a("div",Ue,o((B=n.value)==null?void 0:B.car_name),1)),t("div",We,[s[15]||(s[15]=t("span",{class:"text-sm font-semibold uppercase tracking-wide text-gray-500 mr-2"},"no polisi:",-1)),t("span",Qe,o((D=n.value)==null?void 0:D.plate_number),1)])])]),t("p",Xe,[u(" Anda yakin ingin "+o(I((A=n.value)==null?void 0:A.status).toLowerCase())+" inspeksi ini ",1),(S=n.value)!=null&&S.category?(r(),a("span",Ye," berdasarkan Type Inspek: "+o(n.value.category.name),1)):c("",!0),s[16]||(s[16]=u("? "))]),t("div",Ze,[t("button",{onClick:y,type:"button",class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Batal "),t("button",{onClick:Q,type:"button",disabled:d(w).processing||$.value&&n.value.status!=="in_progress"&&n.value.status!=="revision",class:"flex-1 inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white border border-transparent rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},[d(w).processing?(r(),a("span",et,o(X((T=n.value)==null?void 0:T.status)),1)):(r(),a("span",tt,o(I((F=n.value)==null?void 0:F.status)),1))],8,ke)])])])])):c("",!0),h.value?(r(),a("div",st,[t("div",nt,[t("div",ot,[t("div",rt,[s[18]||(s[18]=t("h3",{class:"text-lg font-medium text-gray-900"},"Batalkan Inspeksi",-1)),t("button",{onClick:y,class:"text-gray-400 hover:text-gray-600"},[l(d(ie),{class:"h-6 w-6"})])]),t("div",at,[l(d(j),{class:"h-8 w-8 text-red-500 mr-3 mt-1"}),t("div",null,[(H=n.value)!=null&&H.car?(r(),a("div",it,[t("p",dt,o(`${n.value.car.brand.name} ${n.value.car.model.name} ${n.value.car.type.name}`),1),t("p",lt,[u(o(n.value.car.cc)+" • "+o(n.value.car.transmission)+" • "+o(n.value.car.year)+" ",1),t("span",ct,"("+o(n.value.car.fuel_type)+")",1)])])):(r(),a("div",ut,o((N=n.value)==null?void 0:N.car_name),1)),t("div",mt,[s[19]||(s[19]=t("span",{class:"text-sm font-semibold uppercase tracking-wide text-gray-500 mr-2"},"no polisi:",-1)),t("span",pt,o((P=n.value)==null?void 0:P.plate_number),1)])])]),t("div",gt,[s[20]||(s[20]=t("label",{for:"cancelReason",class:"block text-sm font-medium text-gray-700 mb-2"}," Alasan Pembatalan * ",-1)),ne(t("textarea",{id:"cancelReason","onUpdate:modelValue":s[0]||(s[0]=e=>g.value=e),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan alasan pembatalan inspeksi...",required:""},null,512),[[oe,g.value]]),d(x).errors.reason?(r(),a("p",xt,o(d(x).errors.reason),1)):c("",!0)]),t("div",yt,[t("button",{onClick:y,type:"button",class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Tutup "),t("button",{onClick:W,disabled:!g.value.trim()||d(x).processing,class:"px-4 py-2 bg-red-600 text-white border border-transparent rounded-md text-sm font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed"},[d(x).processing?(r(),a("span",vt,"Memproses...")):(r(),a("span",ft,"Batalkan Inspeksi"))],8,bt)])])])])):c("",!0)]}),_:1}))}};export{Mt as default};
