import{x as R,g as c,q as D,s as W,C as O,D as X,b as Y,o as l,w as ee,e as te,d as t,u as n,l as oe,f as a,i as u,t as g,v as f,y as x,F as j,k as $,j as E,E as se,A as re,n as le,p as L}from"./vendor-BDDfTp_K.js";import{l as ae}from"./lodash-5_wo_hHr.js";import{A as ne}from"./AppLayout-sa6QYZmr.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const de={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},ue={class:"space-y-6 bg-white rounded-xl shadow-md p-6"},ce={key:0,class:"mb-4 text-sm text-red-600 bg-red-100 p-3 rounded-md"},pe={class:"mb-6"},me={class:"flex items-center space-x-2"},ge={class:"mb-6"},fe={class:"relative"},be={key:0,class:"absolute right-3 top-3"},ve={key:1,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},ye={key:0},xe=["onMousedown"],he={class:"font-medium text-gray-900"},ke={key:1,class:"p-4 text-sm text-gray-500 text-center"},we={class:"mb-6"},_e=["value"],Ce={class:"mb-6 flex items-center justify-between"},Ie={class:"relative inline-flex items-center cursor-pointer"},Be={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Me={class:"mt-6 flex justify-end"},Ae=["disabled"],je={key:2,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},$e={key:0,class:"mb-4"},Le=["innerHTML"],Te={key:1},Ve={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},Se=["onClick"],Ne=["src","alt"],Ue={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},ze={class:"text-white text-xs text-center"},De={key:2,class:"text-center py-4 text-gray-500 text-sm"},Ee={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},qe=["src","alt"],Pe={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Fe={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},Ke={__name:"Create",props:{CarDetail:Array,Category:Array},setup(T){const q=T,r=R({plate_number:"",car_id:null,car_name:"",category_id:"",is_scheduled:!1,scheduled_at_date:null,scheduled_at_time:null}),h=c(""),k=c(""),w=c(""),m=c(""),v=c(!1),B=c(!1),C=c([]),b=c(null),i=c([]),I=c(!1),p=c(0),P=()=>{const o=`${h.value}${k.value}${w.value}`;r.plate_number=o},M=o=>{o==="area"?h.value=h.value.toUpperCase().replace(/[^A-Z]/g,""):o==="number"?k.value=k.value.replace(/[^0-9]/g,""):o==="suffix"&&(w.value=w.value.toUpperCase().replace(/[^A-Z]/g,"")),P()},F=D(()=>!r.plate_number.trim()||!r.category_id||!r.car_id&&!m.value.trim()?!1:r.is_scheduled?r.scheduled_at_date&&r.scheduled_at_time:!0),K=D(()=>r.is_scheduled?"Buat Jadwal":"Mulai Inspeksi"),_=o=>{var d,s,y;if(!o)return"";const e=[];return(d=o.brand)!=null&&d.name&&e.push(o.brand.name),(s=o.model)!=null&&s.name&&e.push(o.model.name),(y=o.type)!=null&&y.name&&e.push(o.type.name),o.cc&&e.push(`${o.cc}cc`),o.transmission&&e.push(o.transmission),o.fuel_type&&e.push(o.fuel_type),o.year&&e.push(o.year.toString()),o.production_period&&e.push(`(${o.production_period})`),e.join(" ")},V=ae.debounce(()=>{if(!m.value.trim()){C.value=[],v.value=!1;return}B.value=!0;const o=m.value.toLowerCase().trim();C.value=q.CarDetail.filter(e=>_(e).toLowerCase().includes(o)),v.value=!0,B.value=!1},300),H=()=>{setTimeout(()=>{v.value=!1},200)},G=async o=>{b.value=o,m.value=_(o),r.car_id=o.id,r.car_name=_(o),v.value=!1,await J(o.id)},J=async o=>{try{const e=await fetch(`/api/cars/${o}/images`);if(e.ok){const d=await e.json();i.value=Array.isArray(d)?d:[]}else i.value=[]}catch(e){console.error("Error loading car images:",e),i.value=[]}},S=o=>!o||!o.file_path?"":`/storage/${o.file_path}`,Z=o=>{p.value=o,I.value=!0,document.body.style.overflow="hidden"},A=()=>{I.value=!1,document.body.style.overflow=""},N=()=>{p.value=(p.value+1)%i.value.length},U=()=>{p.value=(p.value-1+i.value.length)%i.value.length},z=o=>{if(I.value)switch(o.key){case"Escape":A();break;case"ArrowRight":N();break;case"ArrowLeft":U();break}};W(()=>{window.addEventListener("keydown",z)}),O(()=>{window.removeEventListener("keydown",z)}),X(m,o=>{(!b.value||_(b.value)!==o)&&(r.car_id=null,r.car_name=o,b.value=null,i.value=[])});const Q=()=>{const o={plate_number:r.plate_number,category_id:r.category_id,is_scheduled:r.is_scheduled};r.is_scheduled&&(o.scheduled_at=`${r.scheduled_at_date} ${r.scheduled_at_time}`),r.car_id?o.car_id=r.car_id:o.car_name=m.value,r.post(route("inspections.store"),{preserveScroll:!0,onSuccess:e=>{if(o.is_scheduled)console.log("Inspeksi berhasil dijadwalkan.");else{const d=e.props.flash.newInspectionId;d?window.location.href=route("inspections.start",d):console.error("Tidak ada ID inspeksi baru yang dikembalikan.")}},onError:()=>{}})};return(o,e)=>(l(),Y(ne,{title:"Buat Inspeksi Baru"},{default:ee(()=>{var d;return[te(n(oe),{title:"Inspek Baru"}),t("div",de,[t("div",ue,[e[29]||(e[29]=t("div",{class:"mb-4"},[t("h3",{class:"text-xl md:text-3xl font-bold text-gray-900 mb-6 text-center"},"Buat Inspeksi Baru"),t("p",{class:"text-gray-600"},"Isi detail kendaraan dan jadwal untuk memulai inspeksi.")],-1)),n(r).errors.form_error?(l(),a("div",ce,g(n(r).errors.form_error),1)):u("",!0),t("div",pe,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nomor Plat Kendaraan ",-1)),t("div",me,[f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>h.value=s),type:"text",placeholder:"D",class:"w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",onInput:e[1]||(e[1]=s=>M("area")),maxlength:"2"},null,544),[[x,h.value]]),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>k.value=s),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:"w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",onInput:e[3]||(e[3]=s=>M("number")),maxlength:"4"},null,544),[[x,k.value]]),f(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>w.value=s),type:"text",placeholder:"ABC",class:"w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",onInput:e[5]||(e[5]=s=>M("suffix")),maxlength:"3"},null,544),[[x,w.value]])])]),t("div",ge,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nama Mobil ",-1)),t("div",fe,[f(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>m.value=s),type:"text",placeholder:"Cari atau ketik nama mobil...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",onInput:e[7]||(e[7]=(...s)=>n(V)&&n(V)(...s)),onFocus:e[8]||(e[8]=s=>v.value=!0),onBlur:H},null,544),[[x,m.value]]),B.value?(l(),a("div",be,e[15]||(e[15]=[t("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):u("",!0),v.value?(l(),a("div",ve,[C.value.length>0?(l(),a("div",ye,[(l(!0),a(j,null,$(C.value,s=>(l(),a("div",{key:s.id,class:"px-4 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:y=>G(s)},[t("div",he,g(_(s)),1)],40,xe))),128))])):(l(),a("div",ke,e[16]||(e[16]=[E(" Tidak ada data mobil yang cocok. "),t("br",null,null,-1),E(" Silakan input manual dengan format: "),t("br",null,null,-1),t("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):u("",!0)])]),t("div",we,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"category"}," Kategori Inspeksi ",-1)),f(t("select",{id:"category","onUpdate:modelValue":e[9]||(e[9]=s=>n(r).category_id=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},[e[18]||(e[18]=t("option",{value:"",disabled:""},"Pilih Kategori",-1)),(l(!0),a(j,null,$(T.Category,s=>(l(),a("option",{key:s.id,value:s.id},g(s.name),9,_e))),128))],512),[[se,n(r).category_id]])]),t("div",Ce,[e[21]||(e[21]=t("label",{for:"schedule-toggle",class:"text-sm font-medium text-gray-700"},"Jadwalkan Inspeksi?",-1)),t("label",Ie,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>n(r).is_scheduled=s),id:"schedule-toggle",class:"sr-only peer"},null,512),[[re,n(r).is_scheduled]]),e[20]||(e[20]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-700"},null,-1))])]),n(r).is_scheduled?(l(),a("div",Be,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"schedule-date"}," Tanggal ",-1)),f(t("input",{type:"date",id:"schedule-date","onUpdate:modelValue":e[11]||(e[11]=s=>n(r).scheduled_at_date=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},null,512),[[x,n(r).scheduled_at_date]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"schedule-time"}," Waktu ",-1)),f(t("input",{type:"time",id:"schedule-time","onUpdate:modelValue":e[12]||(e[12]=s=>n(r).scheduled_at_time=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},null,512),[[x,n(r).scheduled_at_time]])])])):u("",!0),t("div",Me,[t("button",{onClick:Q,disabled:!F.value||n(r).processing,class:le({"px-6 py-2 rounded-md text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed":!0,"bg-gradient-to-r from-indigo-700 to-sky-600  border border-transparent text-white hover:bg-blue-700":!n(r).is_scheduled,"bg-gradient-to-r from-green-700 to-indigo-600  border-transparent text-white hover:bg-green-700":n(r).is_scheduled})},g(K.value),11,Ae)]),n(r).car_id&&b.value?(l(),a("div",je,[b.value.description?(l(),a("div",$e,[e[24]||(e[24]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:b.value.description},null,8,Le)])):u("",!0),i.value.length>0?(l(),a("div",Te,[e[25]||(e[25]=t("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),t("div",Ve,[(l(!0),a(j,null,$(i.value,(s,y)=>(l(),a("div",{key:s.id||y,class:"relative group cursor-pointer",onClick:He=>Z(y)},[t("img",{src:S(s),alt:s.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,Ne),s.note?(l(),a("div",Ue,[t("p",ze,g(s.note),1)])):u("",!0)],8,Se))),128))])])):(l(),a("div",De," Tidak ada gambar tersedia untuk mobil ini "))])):u("",!0),I.value?(l(),a("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:A},[t("div",Ee,[t("button",{onClick:A,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},e[26]||(e[26]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),i.value.length>1?(l(),a("button",{key:0,onClick:L(U,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},e[27]||(e[27]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):u("",!0),i.value.length>1?(l(),a("button",{key:1,onClick:L(N,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},e[28]||(e[28]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):u("",!0),t("img",{src:S(i.value[p.value]),alt:"Car Image "+(p.value+1),class:"max-w-full max-h-full object-contain",onClick:e[13]||(e[13]=L(()=>{},["stop"]))},null,8,qe),i.value.length>1?(l(),a("div",Pe,g(p.value+1)+" / "+g(i.value.length),1)):u("",!0),(d=i.value[p.value])!=null&&d.note?(l(),a("div",Fe,g(i.value[p.value].note),1)):u("",!0)])])):u("",!0)])])]}),_:1}))}},Re=ie(Ke,[["__scopeId","data-v-f2de1524"]]);export{Re as default};
